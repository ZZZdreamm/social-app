/*! For license information please see main.b51c800d.js.LICENSE.txt */
!function(){var e={110:function(e,t,n){"use strict";var r=n(309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=d(n);i&&i!==p&&e(t,i,r)}var o=l(n);f&&(o=o.concat(f(n)));for(var s=u(t),v=u(n),y=0;y<o.length;++y){var m=o[y];if(!a[m]&&(!r||!r[m])&&(!v||!v[m])&&(!s||!s[m])){var g=h(n,m);try{c(t,m,g)}catch(k){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,g=n?Symbol.for("react.fundamental"):60117,k=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function _(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case a:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case c:case h:case y:case v:case u:return e;default:return t}}case i:return t}}}function w(e){return _(e)===f}t.AsyncMode=l,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=y,t.Memo=v,t.Portal=i,t.Profiler=s,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return w(e)||_(e)===l},t.isConcurrentMode=w,t.isContextConsumer=function(e){return _(e)===c},t.isContextProvider=function(e){return _(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return _(e)===h},t.isFragment=function(e){return _(e)===a},t.isLazy=function(e){return _(e)===y},t.isMemo=function(e){return _(e)===v},t.isPortal=function(e){return _(e)===i},t.isProfiler=function(e){return _(e)===s},t.isStrictMode=function(e){return _(e)===o},t.isSuspense=function(e){return _(e)===d},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===f||e===s||e===o||e===d||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===v||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===g||e.$$typeof===k||e.$$typeof===b||e.$$typeof===m)},t.typeOf=_},309:function(e,t,n){"use strict";e.exports=n(746)},758:function(e){"use strict";function t(e){this._maxSize=e,this.clear()}t.prototype.clear=function(){this._size=0,this._values=Object.create(null)},t.prototype.get=function(e){return this._values[e]},t.prototype.set=function(e,t){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=t};var n=/[^.^\]^[]+|(?=\[\]|\.\.)/g,r=/^\d+$/,i=/^\d/,a=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,o=/^\s*(['"]?)(.*?)(\1)\s*$/,s=new t(512),u=new t(512),c=new t(512);function l(e){return s.get(e)||s.set(e,f(e).map((function(e){return e.replace(o,"$2")})))}function f(e){return e.match(n)||[""]}function h(e){return"string"===typeof e&&e&&-1!==["'",'"'].indexOf(e.charAt(0))}function d(e){return!h(e)&&(function(e){return e.match(i)&&!e.match(r)}(e)||function(e){return a.test(e)}(e))}e.exports={Cache:t,split:f,normalizePath:l,setter:function(e){var t=l(e);return u.get(e)||u.set(e,(function(e,n){for(var r=0,i=t.length,a=e;r<i-1;){var o=t[r];if("__proto__"===o||"constructor"===o||"prototype"===o)return e;a=a[t[r++]]}a[t[r]]=n}))},getter:function(e,t){var n=l(e);return c.get(e)||c.set(e,(function(e){for(var r=0,i=n.length;r<i;){if(null==e&&t)return;e=e[n[r++]]}return e}))},join:function(e){return e.reduce((function(e,t){return e+(h(t)||r.test(t)?"["+t+"]":(e?".":"")+t)}),"")},forEach:function(e,t,n){!function(e,t,n){var r,i,a,o,s=e.length;for(i=0;i<s;i++)(r=e[i])&&(d(r)&&(r='"'+r+'"'),a=!(o=h(r))&&/^\d+$/.test(r),t.call(n,r,o,a,i,e))}(Array.isArray(e)?e:f(e),t,n)}}},463:function(e,t,n){"use strict";var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function k(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!f.call(p,e)||!f.call(d,e)&&(h.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var j,F=Object.assign;function M(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var u="\n"+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function V(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case w:return"Portal";case E:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function Z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function X(e,t){$(e,t);var n=Z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Z(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Z(n)}}function ae(e,t){var n=Z(t.value),r=Z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,xe=null,Se=null;function Ee(e){if(e=ki(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=_i(t),we(e.stateNode,e.type,t))}}function Ce(e){xe?Se?Se.push(e):Se=[e]:xe=e}function Ie(){if(xe){var e=xe,t=Se;if(Se=xe=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Te(e,t){return e(t)}function Ne(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Te(e,t,n)}finally{Ae=!1,(null!==xe||null!==Se)&&(Ne(),Ie())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Re=!1;if(l)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(le){Re=!1}function Le(e,t,n,r,i,a,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var je=!1,Fe=null,Me=!1,Ue=null,Be={onError:function(e){je=!0,Fe=e}};function Ve(e,t,n,r,i,a,o,s,u){je=!1,Fe=null,Le.apply(Be,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ze(e){if(ze(e)!==e)throw Error(a(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Ze(i),e;if(o===r)return Ze(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,$e=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ft(s):0!==(a&=o)&&(r=ft(a))}else 0!==(o=n&~i)?r=ft(o):0!==a&&(r=ft(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,wt,xt,St,Et,Ct=!1,It=[],Tt=null,Nt=null,At=null,Dt=new Map,Ot=new Map,Rt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function jt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=gi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Mt(e)&&n.delete(t)}function Bt(){Ct=!1,null!==Tt&&Mt(Tt)&&(Tt=null),null!==Nt&&Mt(Nt)&&(Nt=null),null!==At&&Mt(At)&&(At=null),Dt.forEach(Ut),Ot.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function zt(e){function t(t){return Vt(t,e)}if(0<It.length){Vt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Vt(Tt,e),null!==Nt&&Vt(Nt,e),null!==At&&Vt(At,e),Dt.forEach(t),Ot.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Rt.shift()}var qt=b.ReactCurrentBatchConfig,Zt=!0;function Wt(e,t,n,r){var i=kt,a=qt.transition;qt.transition=null;try{kt=1,Kt(e,t,n,r)}finally{kt=i,qt.transition=a}}function Ht(e,t,n,r){var i=kt,a=qt.transition;qt.transition=null;try{kt=4,Kt(e,t,n,r)}finally{kt=i,qt.transition=a}}function Kt(e,t,n,r){if(Zt){var i=Qt(e,t,n,r);if(null===i)Zr(e,t,r,Gt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=jt(Tt,e,t,n,r,i),!0;case"dragenter":return Nt=jt(Nt,e,t,n,r,i),!0;case"mouseover":return At=jt(At,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Dt.set(a,jt(Dt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ot.set(a,jt(Ot.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==i;){var a=ki(i);if(null!==a&&_t(a),null===(a=Qt(e,t,n,r))&&Zr(e,t,r,Gt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Zr(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=gi(e=_e(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Xt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Xt,r=n.length,i="value"in $t?$t.value:$t.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=F({},cn,{view:0,detail:0}),hn=an(fn),dn=F({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(dn),vn=an(F({},dn,{dataTransfer:0})),yn=an(F({},fn,{relatedTarget:0})),mn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(gn),bn=an(F({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function En(){return Sn}var Cn=F({},fn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=an(Cn),Tn=an(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(F({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),An=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=F({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(Dn),Rn=[9,13,27,32],Pn=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var jn=l&&"TextEvent"in window&&!Ln,Fn=l&&(!Pn||Ln&&8<Ln&&11>=Ln),Mn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Hr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Gn(e){Mr(e,0)}function Qn(e){if(K(bi(e)))return e}function Yn(e,t){if("change"===e)return t}var $n=!1;if(l){var Xn;if(l){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Xn=Jn}else Xn=!1;$n=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Kn=Hn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Wn(t,Kn,e,_e(e)),De(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ar(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!f.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,yr=null,mr=null,gr=null,kr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==yr||yr!==G(r)||("selectionStart"in(r=yr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&ur(gr,r)||(gr=r,0<(r=Hr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},xr={},Sr={};function Er(e){if(xr[e])return xr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return xr[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Cr=Er("animationend"),Ir=Er("animationiteration"),Tr=Er("animationstart"),Nr=Er("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Ar.set(e,t),u(t,[e])}for(var Rr=0;Rr<Dr.length;Rr++){var Pr=Dr[Rr];Or(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Or(Cr,"onAnimationEnd"),Or(Ir,"onAnimationIteration"),Or(Tr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,u,c){if(Ve.apply(this,arguments),je){if(!je)throw Error(a(198));var l=Fe;je=!1,Fe=null,Me||(Me=!0,Ue=l)}}(r,t,void 0,e),e.currentTarget=null}function Mr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;Fr(i,s,c),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;Fr(i,s,c),a=u}}}if(Me)throw e=Ue,Me=!1,Ue=null,e}function Ur(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Vr]){e[Vr]=!0,o.forEach((function(t){"selectionchange"!==t&&(jr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Br("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Yt(t)){case 1:var i=Wt;break;case 4:i=Ht;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Zr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=gi(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}De((function(){var r=a,i=_e(n),o=[];e:{var s=Ar.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=In;break;case"focusin":c="focus",u=yn;break;case"focusout":c="blur",u=yn;break;case"beforeblur":case"afterblur":u=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Nn;break;case Cr:case Ir:case Tr:u=mn;break;case Nr:u=An;break;case"scroll":u=hn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Tn}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==h&&(null!=(v=Oe(p,h))&&l.push(Wr(p,v,d)))),f)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,i),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!gi(c)&&!c[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?gi(c):null)&&(c!==(f=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Tn,v="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==u?s:bi(u),d=null==c?s:bi(c),(s=new l(v,p+"leave",u,n,i)).target=f,s.relatedTarget=d,v=null,gi(i)===r&&((l=new l(h,p+"enter",c,n,i)).target=d,l.relatedTarget=f,v=l),f=v,u&&c)e:{for(h=c,p=0,d=l=u;d;d=Kr(d))p++;for(d=0,v=h;v;v=Kr(v))d++;for(;0<p-d;)l=Kr(l),p--;for(;0<d-p;)h=Kr(h),d--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=Kr(l),h=Kr(h)}l=null}else l=null;null!==u&&Gr(o,s,u,l,!1),null!==c&&null!==f&&Gr(o,f,c,l,!0)}if("select"===(u=(s=r?bi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var y=Yn;else if(Zn(s))if($n)y=or;else{y=ir;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(y=ar);switch(y&&(y=y(e,r))?Wn(o,y,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?bi(r):window,e){case"focusin":(Zn(m)||"true"===m.contentEditable)&&(yr=m,mr=r,gr=null);break;case"focusout":gr=mr=yr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,br(o,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(o,n,i)}var g;if(Pn)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else zn?Bn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Fn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==k?"onCompositionEnd"===k&&zn&&(g=en()):(Xt="value"in($t=i)?$t.value:$t.textContent,zn=!0)),0<(m=Hr(r,k)).length&&(k=new bn(k,e,null,n,i),o.push({event:k,listeners:m}),g?k.data=g:null!==(g=Vn(n))&&(k.data=g))),(g=jn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,Mn);case"textInput":return(e=t.data)===Mn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Pn&&Bn(e,t)?(e=en(),Jt=Xt=$t=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Mr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Oe(e,n))&&r.unshift(Wr(e,a,i)),null!=(a=Oe(e,t))&&r.push(Wr(e,a,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(u=Oe(n,a))&&o.unshift(Wr(n,u,s)):i||null!=(u=Oe(n,a))&&o.push(Wr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(a(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fi=Math.random().toString(36).slice(2),hi="__reactFiber$"+fi,di="__reactProps$"+fi,pi="__reactContainer$"+fi,vi="__reactEvents$"+fi,yi="__reactListeners$"+fi,mi="__reactHandles$"+fi;function gi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[hi])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _i(e){return e[di]||null}var wi=[],xi=-1;function Si(e){return{current:e}}function Ei(e){0>xi||(e.current=wi[xi],wi[xi]=null,xi--)}function Ci(e,t){xi++,wi[xi]=e.current,e.current=t}var Ii={},Ti=Si(Ii),Ni=Si(!1),Ai=Ii;function Di(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Oi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){Ei(Ni),Ei(Ti)}function Pi(e,t,n){if(Ti.current!==Ii)throw Error(a(168));Ci(Ti,t),Ci(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return F({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Ai=Ti.current,Ci(Ti,e),Ci(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Li(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ni),Ei(Ti),Ci(Ti,e)):Ei(Ni),Ci(Ni,n)}var Mi=null,Ui=!1,Bi=!1;function Vi(e){null===Mi?Mi=[e]:Mi.push(e)}function zi(){if(!Bi&&null!==Mi){Bi=!0;var e=0,t=kt;try{var n=Mi;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Mi=null,Ui=!1}catch(i){throw null!==Mi&&(Mi=Mi.slice(e+1)),Ke(Je,zi),i}finally{kt=t,Bi=!1}}return null}var qi=[],Zi=0,Wi=null,Hi=0,Ki=[],Gi=0,Qi=null,Yi=1,$i="";function Xi(e,t){qi[Zi++]=Hi,qi[Zi++]=Wi,Wi=e,Hi=t}function Ji(e,t,n){Ki[Gi++]=Yi,Ki[Gi++]=$i,Ki[Gi++]=Qi,Qi=e;var r=Yi;e=$i;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,$i=a+e}else Yi=1<<a|n<<i|r,$i=e}function ea(e){null!==e.return&&(Xi(e,1),Ji(e,1,0))}function ta(e){for(;e===Wi;)Wi=qi[--Zi],qi[Zi]=null,Hi=qi[--Zi],qi[Zi]=null;for(;e===Qi;)Qi=Ki[--Gi],Ki[Gi]=null,$i=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function ua(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!sa(e,t)){if(ua(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&sa(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(ua(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function fa(e){if(e!==na)return!1;if(!ia)return la(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(ua(e))throw ha(),Error(a(418));for(;t;)oa(e,t),t=ci(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=ci(e.nextSibling)}function da(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var va=b.ReactCurrentBatchConfig;function ya(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=Si(null),ga=null,ka=null,ba=null;function _a(){ba=ka=ga=null}function wa(e){var t=ma.current;Ei(ma),e._currentValue=t}function xa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Sa(e,t){ga=e,ba=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ea(e){var t=e._currentValue;if(ba!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===ga)throw Error(a(308));ka=e,ga.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Ca=null;function Ia(e){null===Ca?Ca=[e]:Ca.push(e)}function Ta(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ia(t)):(n.next=i.next,i.next=n),t.interleaved=n,Na(e,r)}function Na(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Aa=!1;function Da(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ra(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Na(e,n)}return null===(i=r.interleaved)?(t.next=t,Ia(r)):(t.next=i.next,i.next=t),r.interleaved=t,Na(e,n)}function La(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function ja(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fa(e,t,n,r){var i=e.updateQueue;Aa=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?a=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==a){var f=i.baseState;for(o=0,l=c=u=null,s=a;;){var h=s.lane,d=s.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(d,f,h):p)||void 0===h)break e;f=F({},f,h);break e;case 2:Aa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else d={eventTime:d,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=f):l=l.next=d,o|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===l&&(u=f),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Fu|=o,e.lanes=o,e.memoizedState=f}}function Ma(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Ua=(new r.Component).refs;function Ba(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Va={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Ra(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Pa(e,a,i))&&(rc(t,e,i,r),La(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Ra(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Pa(e,a,i))&&(rc(t,e,i,r),La(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Ra(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Pa(e,i,r))&&(rc(t,e,r,n),La(t,e,r))}};function za(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,a))}function qa(e,t,n){var r=!1,i=Ii,a=t.contextType;return"object"===typeof a&&null!==a?a=Ea(a):(i=Oi(t)?Ai:Ti.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Di(e,i):Ii),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Va,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Za(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Va.enqueueReplaceState(t,t.state,null)}function Wa(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Ua,Da(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ea(a):(a=Oi(t)?Ai:Ti.current,i.context=Di(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Ba(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Va.enqueueReplaceState(i,i.state,null),Fa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ha(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Ua&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ga(e){return(0,e._init)(e._payload)}function Qa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===x?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===O&&Ga(a)===t.type)?((r=i(t,n.props)).ref=Ha(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=Ha(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function f(e,t,n,r,a){return null===t||7!==t.tag?((t=jc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=Ha(e,null,t),n.return=e,n;case w:return(t=Uc(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=jc(t,e.mode,n,null)).return=e,t;Ka(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case w:return n.key===i?l(e,t,n,r):null;case O:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:f(e,t,n,r,null);Ka(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case O:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return f(t,e=e.get(n)||null,r,i,null);Ka(t,r)}return null}function v(i,a,s,u){for(var c=null,l=null,f=a,v=a=0,y=null;null!==f&&v<s.length;v++){f.index>v?(y=f,f=null):y=f.sibling;var m=d(i,f,s[v],u);if(null===m){null===f&&(f=y);break}e&&f&&null===m.alternate&&t(i,f),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m,f=y}if(v===s.length)return n(i,f),ia&&Xi(i,v),c;if(null===f){for(;v<s.length;v++)null!==(f=h(i,s[v],u))&&(a=o(f,a,v),null===l?c=f:l.sibling=f,l=f);return ia&&Xi(i,v),c}for(f=r(i,f);v<s.length;v++)null!==(y=p(f,i,v,s[v],u))&&(e&&null!==y.alternate&&f.delete(null===y.key?v:y.key),a=o(y,a,v),null===l?c=y:l.sibling=y,l=y);return e&&f.forEach((function(e){return t(i,e)})),ia&&Xi(i,v),c}function y(i,s,u,c){var l=L(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var f=l=null,v=s,y=s=0,m=null,g=u.next();null!==v&&!g.done;y++,g=u.next()){v.index>y?(m=v,v=null):m=v.sibling;var k=d(i,v,g.value,c);if(null===k){null===v&&(v=m);break}e&&v&&null===k.alternate&&t(i,v),s=o(k,s,y),null===f?l=k:f.sibling=k,f=k,v=m}if(g.done)return n(i,v),ia&&Xi(i,y),l;if(null===v){for(;!g.done;y++,g=u.next())null!==(g=h(i,g.value,c))&&(s=o(g,s,y),null===f?l=g:f.sibling=g,f=g);return ia&&Xi(i,y),l}for(v=r(i,v);!g.done;y++,g=u.next())null!==(g=p(v,i,y,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?y:g.key),s=o(g,s,y),null===f?l=g:f.sibling=g,f=g);return e&&v.forEach((function(e){return t(i,e)})),ia&&Xi(i,y),l}return function e(r,a,o,u){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,l=a;null!==l;){if(l.key===c){if((c=o.type)===x){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Ga(c)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=Ha(r,l,o),a.return=r,r=a;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===x?((a=jc(o.props.children,r.mode,u,o.key)).return=r,r=a):((u=Lc(o.type,o.key,o.props,null,r.mode,u)).ref=Ha(r,a,o),u.return=r,r=u)}return s(r);case w:e:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Uc(o,r.mode,u)).return=r,r=a}return s(r);case O:return e(r,a,(l=o._init)(o._payload),u)}if(te(o))return v(r,a,o,u);if(L(o))return y(r,a,o,u);Ka(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Mc(o,r.mode,u)).return=r,r=a),s(r)):n(r,a)}}var Ya=Qa(!0),$a=Qa(!1),Xa={},Ja=Si(Xa),eo=Si(Xa),to=Si(Xa);function no(e){if(e===Xa)throw Error(a(174));return e}function ro(e,t){switch(Ci(to,t),Ci(eo,e),Ci(Ja,Xa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Ja),Ci(Ja,t)}function io(){Ei(Ja),Ei(eo),Ei(to)}function ao(e){no(to.current);var t=no(Ja.current),n=ue(t,e.type);t!==n&&(Ci(eo,e),Ci(Ja,n))}function oo(e){eo.current===e&&(Ei(Ja),Ei(eo))}var so=Si(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=b.ReactCurrentDispatcher,ho=b.ReactCurrentBatchConfig,po=0,vo=null,yo=null,mo=null,go=!1,ko=!1,bo=0,_o=0;function wo(){throw Error(a(321))}function xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function So(e,t,n,r,i,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?ss:us,e=n(r,i),ko){o=0;do{if(ko=!1,bo=0,25<=o)throw Error(a(301));o+=1,mo=yo=null,t.updateQueue=null,fo.current=cs,e=n(r,i)}while(ko)}if(fo.current=os,t=null!==yo&&null!==yo.next,po=0,mo=yo=vo=null,go=!1,t)throw Error(a(300));return e}function Eo(){var e=0!==bo;return bo=0,e}function Co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function Io(){if(null===yo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=yo.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,yo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(yo=e).memoizedState,baseState:yo.baseState,baseQueue:yo.baseQueue,queue:yo.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function To(e,t){return"function"===typeof t?t(e):t}function No(e){var t=Io(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=yo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var u=s=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=h,s=r):c=c.next=h,vo.lanes|=f,Fu|=f}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,vo.lanes|=o,Fu|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ao(e){var t=Io(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(bs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Do(){}function Oo(e,t){var n=vo,r=Io(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,bs=!0),r=r.queue,Zo(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,Uo(9,Po.bind(null,n,r,i,t),void 0,null),null===Au)throw Error(a(349));0!==(30&po)||Ro(n,t,i)}return i}function Ro(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Po(e,t,n,r){t.value=n,t.getSnapshot=r,jo(t)&&Fo(e)}function Lo(e,t,n){return n((function(){jo(t)&&Fo(e)}))}function jo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Fo(e){var t=Na(e,1);null!==t&&rc(t,e,1,-1)}function Mo(e){var t=Co();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function Uo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bo(){return Io().memoizedState}function Vo(e,t,n,r){var i=Co();vo.flags|=e,i.memoizedState=Uo(1|t,n,void 0,void 0===r?null:r)}function zo(e,t,n,r){var i=Io();r=void 0===r?null:r;var a=void 0;if(null!==yo){var o=yo.memoizedState;if(a=o.destroy,null!==r&&xo(r,o.deps))return void(i.memoizedState=Uo(t,n,a,r))}vo.flags|=e,i.memoizedState=Uo(1|t,n,a,r)}function qo(e,t){return Vo(8390656,8,e,t)}function Zo(e,t){return zo(2048,8,e,t)}function Wo(e,t){return zo(4,2,e,t)}function Ho(e,t){return zo(4,4,e,t)}function Ko(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Go(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4,4,Ko.bind(null,t,e),n)}function Qo(){}function Yo(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Fu|=n,e.baseState=!0),t)}function Jo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{kt=n,ho.transition=r}}function es(){return Io().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=Ta(e,t,n,r))){rc(n,e,r,tc()),as(n,t,r)}}function ns(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(i.next=i,Ia(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ta(e,t,i,r))&&(rc(n,e,r,i=tc()),as(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function is(e,t){ko=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function as(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var os={readContext:Ea,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},ss={readContext:Ea,useCallback:function(e,t){return Co().memoizedState=[e,void 0===t?null:t],e},useContext:Ea,useEffect:qo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4194308,4,Ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var n=Co();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Co();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Co().memoizedState=e},useState:Mo,useDebugValue:Qo,useDeferredValue:function(e){return Co().memoizedState=e},useTransition:function(){var e=Mo(!1),t=e[0];return e=Jo.bind(null,e[1]),Co().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,i=Co();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Au)throw Error(a(349));0!==(30&po)||Ro(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,qo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,Uo(9,Po.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Co(),t=Au.identifierPrefix;if(ia){var n=$i;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=bo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=_o++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ea,useCallback:Yo,useContext:Ea,useEffect:Zo,useImperativeHandle:Go,useInsertionEffect:Wo,useLayoutEffect:Ho,useMemo:$o,useReducer:No,useRef:Bo,useState:function(){return No(To)},useDebugValue:Qo,useDeferredValue:function(e){return Xo(Io(),yo.memoizedState,e)},useTransition:function(){return[No(To)[0],Io().memoizedState]},useMutableSource:Do,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ea,useCallback:Yo,useContext:Ea,useEffect:Zo,useImperativeHandle:Go,useInsertionEffect:Wo,useLayoutEffect:Ho,useMemo:$o,useReducer:Ao,useRef:Bo,useState:function(){return Ao(To)},useDebugValue:Qo,useDeferredValue:function(e){var t=Io();return null===yo?t.memoizedState=e:Xo(t,yo.memoizedState,e)},useTransition:function(){return[Ao(To)[0],Io().memoizedState]},useMutableSource:Do,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function fs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Ra(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wu||(Wu=!0,Hu=r),hs(0,t)},n}function vs(e,t,n){(n=Ra(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===Ku?Ku=new Set([this]):Ku.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ys(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ra(-1,1)).tag=2,Pa(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ks=b.ReactCurrentOwner,bs=!1;function _s(e,t,n,r){t.child=null===e?$a(t,null,n,r):Ya(t,e.child,n,r)}function ws(e,t,n,r,i){n=n.render;var a=t.ref;return Sa(t,i),r=So(e,t,n,r,a,i),n=Eo(),null===e||bs?(ia&&n&&ea(t),t.flags|=1,_s(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function xs(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Rc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ss(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Ws(e,t,i)}return t.flags|=1,(e=Pc(a,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ur(a,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Ws(e,t,i);0!==(131072&e.flags)&&(bs=!0)}}return Is(e,t,n,r,i)}function Es(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Pu,Ru),Ru|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Pu,Ru),Ru|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ci(Pu,Ru),Ru|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ci(Pu,Ru),Ru|=r;return _s(e,t,i,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,n,r,i){var a=Oi(n)?Ai:Ti.current;return a=Di(t,a),Sa(t,i),n=So(e,t,n,r,a,i),r=Eo(),null===e||bs?(ia&&r&&ea(t),t.flags|=1,_s(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function Ts(e,t,n,r,i){if(Oi(n)){var a=!0;ji(t)}else a=!1;if(Sa(t,i),null===t.stateNode)Zs(e,t),qa(t,n,r),Wa(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ea(c):c=Di(t,c=Oi(n)?Ai:Ti.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Za(t,o,r,c),Aa=!1;var h=t.memoizedState;o.state=h,Fa(t,r,o,i),u=t.memoizedState,s!==r||h!==u||Ni.current||Aa?("function"===typeof l&&(Ba(t,n,l,r),u=t.memoizedState),(s=Aa||za(t,n,s,r,h,u,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Oa(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ya(t.type,s),o.props=c,f=t.pendingProps,h=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ea(u):u=Di(t,u=Oi(n)?Ai:Ti.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==f||h!==u)&&Za(t,o,r,u),Aa=!1,h=t.memoizedState,o.state=h,Fa(t,r,o,i);var p=t.memoizedState;s!==f||h!==p||Ni.current||Aa?("function"===typeof d&&(Ba(t,n,d,r),p=t.memoizedState),(c=Aa||za(t,n,c,r,h,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ns(e,t,n,r,a,i)}function Ns(e,t,n,r,i,a){Cs(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Ws(e,t,a);r=t.stateNode,ks.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,s,a)):_s(e,t,s,a),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Pi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pi(0,t.context,!1),ro(e,t.containerInfo)}function Ds(e,t,n,r,i){return da(),pa(i),t.flags|=256,_s(e,t,n,r),t.child}var Os,Rs,Ps,Ls,js={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ms(e,t,n){var r,i=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(so,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Fc(u,i,0,null),e=jc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=js,e):Us(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,r=fs(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(o=jc(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ya(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=js,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Bs(e,t,s,r=fs(o=Error(a(419)),r,void 0))}if(u=0!==(s&e.childLanes),bs||u){if(null!==(r=Au)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Na(e,i),rc(r,e,i,-1))}return yc(),Bs(e,t,s,r=fs(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Ki[Gi++]=Yi,Ki[Gi++]=$i,Ki[Gi++]=Qi,Yi=e.id,$i=e.overflow,Qi=t),t=Us(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,o,n);if(s){s=i.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Pc(r,s):(s=jc(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Fs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=js,i}return e=(s=e.child).sibling,i=Pc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Us(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,n,r){return null!==r&&pa(r),Ya(t,e.child,null,n),(e=Us(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xa(e.return,t,n)}function zs(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function qs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(_s(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,n,t);else if(19===e.tag)Vs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(so,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zs(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===uo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zs(t,!0,n,null,a);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ks(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gs(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ks(t),null;case 1:case 17:return Oi(t.type)&&Ri(),Ks(t),null;case 3:return r=t.stateNode,io(),Ei(Ni),Ei(Ti),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Rs(e,t),Ks(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ks(t),null}if(e=no(Ja.current),fa(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hi]=t,r[di]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ie(r,o),Ur("invalid",r)}for(var u in ge(n,o),i=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Ur("scroll",r)}switch(n){case"input":H(r),J(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[hi]=t,e[di]=r,Os(e,t,!1,!1),t.stateNode=e;e:{switch(u=ke(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(o in ge(n,i),c=i)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ye(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Ur("scroll",e):null!=l&&k(e,o,l,u))}switch(n){case"input":H(e),J(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ks(t),null;case 6:if(e&&null!=t.stateNode)Ls(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=no(to.current),no(Ja.current),fa(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ks(t),null;case 13:if(Ei(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),da(),t.flags|=98560,o=!1;else if(o=fa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[hi]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ks(t),o=!1}else null!==aa&&(sc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Lu&&(Lu=3):yc())),null!==t.updateQueue&&(t.flags|=4),Ks(t),null);case 4:return io(),Rs(e,t),null===e&&zr(t.stateNode.containerInfo),Ks(t),null;case 10:return wa(t.type._context),Ks(t),null;case 19:if(Ei(so),null===(o=t.memoizedState))return Ks(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Hs(o,!1);else{if(0!==Lu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Hs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>qu&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ia)return Ks(t),null}else 2*$e()-o.renderingStartTime>qu&&1073741824!==n&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=so.current,Ci(so,r?1&n|2:1&n),t):(Ks(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ru)&&(Ks(t),6&t.subtreeFlags&&(t.flags|=8192)):Ks(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qs(e,t){switch(ta(t),t.tag){case 1:return Oi(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Ei(Ni),Ei(Ti),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ei(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(so),null;case 4:return io(),null;case 10:return wa(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Os=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Rs=function(){},Ps=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Ja.current);var a,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(l in ge(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var u=i[l];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Ur("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,$s=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Js=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tu(t,n,a)}i=i.next}while(i!==r)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function au(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ou(e){var t=e.alternate;null!==t&&(e.alternate=null,ou(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[di],delete t[vi],delete t[yi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var fu=null,hu=!1;function du(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:$s||eu(n,t);case 6:var r=fu,i=hu;fu=null,du(e,t,n),hu=i,null!==(fu=r)&&(hu?(e=fu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fu.removeChild(n.stateNode));break;case 18:null!==fu&&(hu?(e=fu,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),zt(e)):ui(fu,n.stateNode));break;case 4:r=fu,i=hu,fu=n.stateNode.containerInfo,hu=!0,du(e,t,n),fu=r,hu=i;break;case 0:case 11:case 14:case 15:if(!$s&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&tu(n,t,o),i=i.next}while(i!==r)}du(e,t,n);break;case 1:if(!$s&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Ec(n,t,s)}du(e,t,n);break;case 21:du(e,t,n);break;case 22:1&n.mode?($s=(r=$s)||null!==n.memoizedState,du(e,t,n),$s=r):du(e,t,n);break;default:du(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xs),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:fu=u.stateNode,hu=!1;break e;case 3:case 4:fu=u.stateNode.containerInfo,hu=!0;break e}u=u.return}if(null===fu)throw Error(a(160));pu(o,s,i),fu=null,hu=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Ec(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yu(t,e),gu(e),4&r){try{ru(3,e,e.return),iu(3,e)}catch(y){Ec(e,e.return,y)}try{ru(5,e,e.return)}catch(y){Ec(e,e.return,y)}}break;case 1:yu(t,e),gu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(yu(t,e),gu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(y){Ec(e,e.return,y)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&$(i,o),ke(u,s);var l=ke(u,o);for(s=0;s<c.length;s+=2){var f=c[s],h=c[s+1];"style"===f?ye(i,h):"dangerouslySetInnerHTML"===f?fe(i,h):"children"===f?he(i,h):k(i,f,h,l)}switch(u){case"input":X(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[di]=o}catch(y){Ec(e,e.return,y)}}break;case 6:if(yu(t,e),gu(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(y){Ec(e,e.return,y)}}break;case 3:if(yu(t,e),gu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(y){Ec(e,e.return,y)}break;case 4:default:yu(t,e),gu(e);break;case 13:yu(t,e),gu(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(zu=$e())),4&r&&vu(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?($s=(l=$s)||f,yu(t,e),$s=l):yu(t,e),gu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for(Js=e,f=e.child;null!==f;){for(h=Js=f;null!==Js;){switch(p=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:ru(4,d,d.return);break;case 1:eu(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(y){Ec(r,n,y)}}break;case 5:eu(d,d.return);break;case 22:if(null!==d.memoizedState){wu(h);continue}}null!==p?(p.return=d,Js=p):wu(h)}f=f.sibling}e:for(f=null,h=e;;){if(5===h.tag){if(null===f){f=h;try{i=h.stateNode,l?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(y){Ec(e,e.return,y)}}}else if(6===h.tag){if(null===f)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(y){Ec(e,e.return,y)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yu(t,e),gu(e),4&r&&vu(e);case 21:}}function gu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),lu(e,uu(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cu(e,uu(e),o);break;default:throw Error(a(161))}}catch(s){Ec(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ku(e,t,n){Js=e,bu(e,t,n)}function bu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ys;if(!o){var s=i.alternate,u=null!==s&&null!==s.memoizedState||$s;s=Ys;var c=$s;if(Ys=o,($s=u)&&!c)for(Js=i;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?xu(i):null!==u?(u.return=o,Js=u):xu(i);for(;null!==a;)Js=a,bu(a,t,n),a=a.sibling;Js=i,Ys=s,$s=c}_u(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Js=a):_u(e)}}function _u(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$s||iu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$s)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ya(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ma(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ma(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var h=f.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(a(163))}$s||512&t.flags&&au(t)}catch(d){Ec(t,t.return,d)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function wu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function xu(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(u){Ec(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Ec(t,i,u)}}var a=t.return;try{au(t)}catch(u){Ec(t,a,u)}break;case 5:var o=t.return;try{au(t)}catch(u){Ec(t,o,u)}}}catch(u){Ec(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Su,Eu=Math.ceil,Cu=b.ReactCurrentDispatcher,Iu=b.ReactCurrentOwner,Tu=b.ReactCurrentBatchConfig,Nu=0,Au=null,Du=null,Ou=0,Ru=0,Pu=Si(0),Lu=0,ju=null,Fu=0,Mu=0,Uu=0,Bu=null,Vu=null,zu=0,qu=1/0,Zu=null,Wu=!1,Hu=null,Ku=null,Gu=!1,Qu=null,Yu=0,$u=0,Xu=null,Ju=-1,ec=0;function tc(){return 0!==(6&Nu)?$e():-1!==Ju?Ju:Ju=$e()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nu)&&0!==Ou?Ou&-Ou:null!==va.transition?(0===ec&&(ec=vt()),ec):0!==(e=kt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<$u)throw $u=0,Xu=null,Error(a(185));mt(e,n,r),0!==(2&Nu)&&e===Au||(e===Au&&(0===(2&Nu)&&(Mu|=n),4===Lu&&uc(e,Ou)),ic(e,r),1===n&&0===Nu&&0===(1&t.mode)&&(qu=$e()+500,Ui&&zi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,u=i[o];-1===u?0!==(s&n)&&0===(s&r)||(i[o]=dt(s,t)):u<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ht(e,e===Au?Ou:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Ui=!0,Vi(e)}(cc.bind(null,e)):Vi(cc.bind(null,e)),oi((function(){0===(6&Nu)&&zi()})),n=null;else{switch(bt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ac(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ju=-1,ec=0,0!==(6&Nu))throw Error(a(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=ht(e,e===Au?Ou:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var i=Nu;Nu|=2;var o=vc();for(Au===e&&Ou===t||(Zu=null,qu=$e()+500,dc(e,t));;)try{kc();break}catch(u){pc(e,u)}_a(),Cu.current=o,Nu=i,null!==Du?t=0:(Au=null,Ou=0,t=Lu)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=oc(e,i))),1===t)throw n=ju,dc(e,0),uc(e,r),ic(e,$e()),n;if(6===t)uc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=ju,dc(e,0),uc(e,r),ic(e,$e()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Vu,Zu);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=zu+500-$e())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wc.bind(null,e,Vu,Zu),t);break}wc(e,Vu,Zu);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Eu(r/1960))-r)){e.timeoutHandle=ri(wc.bind(null,e,Vu,Zu),r);break}wc(e,Vu,Zu);break;default:throw Error(a(329))}}}return ic(e,$e()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=Bu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Vu,Vu=n,null!==t&&sc(t)),e}function sc(e){null===Vu?Vu=e:Vu.push.apply(Vu,e)}function uc(e,t){for(t&=~Uu,t&=~Mu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Nu))throw Error(a(327));xc();var t=ht(e,0);if(0===(1&t))return ic(e,$e()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=ju,dc(e,0),uc(e,t),ic(e,$e()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Vu,Zu),ic(e,$e()),null}function lc(e,t){var n=Nu;Nu|=1;try{return e(t)}finally{0===(Nu=n)&&(qu=$e()+500,Ui&&zi())}}function fc(e){null!==Qu&&0===Qu.tag&&0===(6&Nu)&&xc();var t=Nu;Nu|=1;var n=Tu.transition,r=kt;try{if(Tu.transition=null,kt=1,e)return e()}finally{kt=r,Tu.transition=n,0===(6&(Nu=t))&&zi()}}function hc(){Ru=Pu.current,Ei(Pu)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Du)for(n=Du.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ri();break;case 3:io(),Ei(Ni),Ei(Ti),lo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Ei(so);break;case 10:wa(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Au=e,Du=e=Pc(e.current,null),Ou=Ru=t,Lu=0,ju=null,Uu=Mu=Fu=0,Vu=Bu=null,null!==Ca){for(t=0;t<Ca.length;t++)if(null!==(r=(n=Ca[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ca=null}return e}function pc(e,t){for(;;){var n=Du;try{if(_a(),fo.current=os,go){for(var r=vo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}go=!1}if(po=0,mo=yo=vo=null,ko=!1,bo=0,Iu.current=null,null===n||null===n.return){Lu=1,ju=t,Du=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ou,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=u,h=f.tag;if(0===(1&f.mode)&&(0===h||11===h||15===h)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,gs(p,s,u,0,t),1&p.mode&&ys(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break e}if(0===(1&t)){ys(o,l,t),yc();break e}c=Error(a(426))}else if(ia&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),gs(m,s,u,0,t),pa(ls(c,u));break e}}o=c=ls(c,u),4!==Lu&&(Lu=2),null===Bu?Bu=[o]:Bu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,ja(o,ps(0,c,t));break e;case 1:u=c;var g=o.type,k=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Ku||!Ku.has(k)))){o.flags|=65536,t&=-t,o.lanes|=t,ja(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}_c(n)}catch(b){t=b,Du===n&&null!==n&&(Du=n=n.return);continue}break}}function vc(){var e=Cu.current;return Cu.current=os,null===e?os:e}function yc(){0!==Lu&&3!==Lu&&2!==Lu||(Lu=4),null===Au||0===(268435455&Fu)&&0===(268435455&Mu)||uc(Au,Ou)}function mc(e,t){var n=Nu;Nu|=2;var r=vc();for(Au===e&&Ou===t||(Zu=null,dc(e,t));;)try{gc();break}catch(i){pc(e,i)}if(_a(),Nu=n,Cu.current=r,null!==Du)throw Error(a(261));return Au=null,Ou=0,Lu}function gc(){for(;null!==Du;)bc(Du)}function kc(){for(;null!==Du&&!Qe();)bc(Du)}function bc(e){var t=Su(e.alternate,e,Ru);e.memoizedProps=e.pendingProps,null===t?_c(e):Du=t,Iu.current=null}function _c(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gs(n,t,Ru)))return void(Du=n)}else{if(null!==(n=Qs(n,t)))return n.flags&=32767,void(Du=n);if(null===e)return Lu=6,void(Du=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Du=t);Du=t=e}while(null!==t);0===Lu&&(Lu=5)}function wc(e,t,n){var r=kt,i=Tu.transition;try{Tu.transition=null,kt=1,function(e,t,n,r){do{xc()}while(null!==Qu);if(0!==(6&Nu))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Au&&(Du=Au=null,Ou=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gu||(Gu=!0,Ac(tt,(function(){return xc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tu.transition,Tu.transition=null;var s=kt;kt=1;var u=Nu;Nu|=4,Iu.current=null,function(e,t){if(ei=Zt,dr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(_){n=null;break e}var s=0,u=-1,c=-1,l=0,f=0,h=e,d=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(u=s+i),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)d=h,h=p;for(;;){if(h===e)break t;if(d===n&&++l===i&&(u=s),d===o&&++f===r&&(c=s),null!==(p=h.nextSibling))break;d=(h=d).parentNode}h=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Zt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var y=v.memoizedProps,m=v.memoizedState,g=t.stateNode,k=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:ya(t.type,y),m);g.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(_){Ec(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=nu,nu=!1}(e,n),mu(n,e),pr(ti),Zt=!!ei,ti=ei=null,e.current=n,ku(n,e,i),Ye(),Nu=u,kt=s,Tu.transition=o}else e.current=n;if(Gu&&(Gu=!1,Qu=e,Yu=i),o=e.pendingLanes,0===o&&(Ku=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wu)throw Wu=!1,e=Hu,Hu=null,e;0!==(1&Yu)&&0!==e.tag&&xc(),o=e.pendingLanes,0!==(1&o)?e===Xu?$u++:($u=0,Xu=e):$u=0,zi()}(e,t,n,r)}finally{Tu.transition=i,kt=r}return null}function xc(){if(null!==Qu){var e=bt(Yu),t=Tu.transition,n=kt;try{if(Tu.transition=null,kt=16>e?16:e,null===Qu)var r=!1;else{if(e=Qu,Qu=null,Yu=0,0!==(6&Nu))throw Error(a(331));var i=Nu;for(Nu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var f=Js;switch(f.tag){case 0:case 11:case 15:ru(8,f,o)}var h=f.child;if(null!==h)h.return=f,Js=h;else for(;null!==Js;){var d=(f=Js).sibling,p=f.return;if(ou(f),f===l){Js=null;break}if(null!==d){d.return=p,Js=d;break}Js=p}}}var v=o.alternate;if(null!==v){var y=v.child;if(null!==y){v.child=null;do{var m=y.sibling;y.sibling=null,y=m}while(null!==y)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:ru(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Js=g;break e}Js=o.return}}var k=e.current;for(Js=k;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=k;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(w){Ec(u,u.return,w)}if(u===s){Js=null;break e}var _=u.sibling;if(null!==_){_.return=u.return,Js=_;break e}Js=u.return}}if(Nu=i,zi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(w){}r=!0}return r}finally{kt=n,Tu.transition=t}}return!1}function Sc(e,t,n){e=Pa(e,t=ps(0,t=ls(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),ic(e,t))}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ku||!Ku.has(r))){t=Pa(t,e=vs(t,e=ls(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),ic(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Au===e&&(Ou&n)===n&&(4===Lu||3===Lu&&(130023424&Ou)===Ou&&500>$e()-zu?dc(e,0):Uu|=n),ic(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Na(e,t))&&(mt(e,t,n),ic(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ic(e,n)}function Ac(e,t){return Ke(e,t)}function Dc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,r){return new Dc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Rc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case x:return jc(n.children,i,o,t);case S:s=8,i|=8;break;case E:return(e=Oc(12,n,t,2|i)).elementType=E,e.lanes=o,e;case N:return(e=Oc(13,n,t,i)).elementType=N,e.lanes=o,e;case A:return(e=Oc(19,n,t,i)).elementType=A,e.lanes=o,e;case R:return Fc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case I:s=9;break e;case T:s=11;break e;case D:s=14;break e;case O:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Oc(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function jc(e,t,n,r){return(e=Oc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Oc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,a,o,s,u){return e=new Bc(e,t,n,s,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Oc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Da(a),e}function zc(e){if(!e)return Ii;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Oi(n))return Li(e,n,t)}return t}function qc(e,t,n,r,i,a,o,s,u){return(e=Vc(n,r,!0,e,0,a,0,s,u)).context=zc(null),n=e.current,(a=Ra(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Pa(n,a,i),e.current.lanes=i,mt(e,i,r),ic(e,r),e}function Zc(e,t,n,r){var i=t.current,a=tc(),o=nc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ra(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Pa(i,t,o))&&(rc(e,i,o,a),La(e,i,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Su=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:As(t),da();break;case 5:ao(t);break;case 1:Oi(t.type)&&ji(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ms(e,t,n):(Ci(so,1&so.current),null!==(e=Ws(e,t,n))?e.sibling:null);Ci(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return Ws(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,ia&&0!==(1048576&t.flags)&&Ji(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Zs(e,t),e=t.pendingProps;var i=Di(t,Ti.current);Sa(t,n),i=So(null,t,r,e,i,n);var o=Eo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oi(r)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Da(t),i.updater=Va,t.stateNode=i,i._reactInternals=t,Wa(t,r,e,n),t=Ns(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),_s(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Zs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===D)return 14}return 2}(r),e=ya(r,e),i){case 0:t=Is(null,t,r,e,n);break e;case 1:t=Ts(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=xs(null,t,r,ya(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Is(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ts(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 3:e:{if(As(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Oa(e,t),Fa(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ds(e,t,r,n,i=ls(Error(a(423)),t));break e}if(r!==i){t=Ds(e,t,r,n,i=ls(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=$a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===i){t=Ws(e,t,n);break e}_s(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&ca(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Cs(e,t),_s(e,t,s,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Ms(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ya(t,null,r,n):_s(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ws(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 7:return _s(e,t,t.pendingProps,n),t.child;case 8:case 12:return _s(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ci(ma,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ni.current){t=Ws(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Ra(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),xa(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),xa(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}_s(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Sa(t,n),r=r(i=Ea(i)),t.flags|=1,_s(e,t,r,n),t.child;case 14:return i=ya(r=t.type,t.pendingProps),xs(e,t,r,i=ya(r.type,i),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ya(r,i),Zs(e,t),t.tag=1,Oi(r)?(e=!0,ji(t)):e=!1,Sa(t,n),qa(t,r,i),Wa(t,r,i,n),Ns(null,t,r,!0,e,n);case 19:return qs(e,t,n);case 22:return Es(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function el(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=Wc(o);s.call(e)}}Zc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Wc(o);a.call(e)}}var o=qc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[pi]=o.current,zr(8===e.nodeType?e.parentNode:e),fc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Wc(u);s.call(e)}}var u=Vc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=u,e[pi]=u.current,zr(8===e.nodeType?e.parentNode:e),fc((function(){Zc(t,u,n,r)})),u}(n,t,e,i,r);return Wc(o)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Zc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fc((function(){Zc(null,e,null,null)})),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ft(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(gt(t,1|n),ic(t,$e()),0===(6&Nu)&&(qu=$e()+500,zi()))}break;case 13:fc((function(){var t=Na(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Kc(e,1)}},wt=function(e){if(13===e.tag){var t=Na(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},xt=function(e){if(13===e.tag){var t=nc(e),n=Na(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},St=function(){return kt},Et=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},we=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(a(90));K(r),X(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=lc,Ne=fc;var tl={usingClientEntryPoint:!1,Events:[ki,bi,_i,Ce,Ie,lc]},nl={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(rl),at=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(a(299));var n=!1,r="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return fc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(a(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,i,0,o,s),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(a(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(a(40));return!!e._reactRootContainer&&(fc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},77:function(e){"use strict";var t=Array.isArray,n=Object.keys,r=Object.prototype.hasOwnProperty,i="undefined"!==typeof Element;function a(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){var s,u,c,l=t(e),f=t(o);if(l&&f){if((u=e.length)!=o.length)return!1;for(s=u;0!==s--;)if(!a(e[s],o[s]))return!1;return!0}if(l!=f)return!1;var h=e instanceof Date,d=o instanceof Date;if(h!=d)return!1;if(h&&d)return e.getTime()==o.getTime();var p=e instanceof RegExp,v=o instanceof RegExp;if(p!=v)return!1;if(p&&v)return e.toString()==o.toString();var y=n(e);if((u=y.length)!==n(o).length)return!1;for(s=u;0!==s--;)if(!r.call(o,y[s]))return!1;if(i&&e instanceof Element&&o instanceof Element)return e===o;for(s=u;0!==s--;)if(("_owner"!==(c=y[s])||!e.$$typeof)&&!a(e[c],o[c]))return!1;return!0}return e!==e&&o!==o}e.exports=function(e,t){try{return a(e,t)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||-2146828260===n.number)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}}},372:function(e,t){"use strict";var n=60103,r=60106,i=60107,a=60108,o=60114,s=60109,u=60110,c=60112,l=60113,f=60120,h=60115,d=60116,p=60121,v=60122,y=60117,m=60129,g=60131;if("function"===typeof Symbol&&Symbol.for){var k=Symbol.for;n=k("react.element"),r=k("react.portal"),i=k("react.fragment"),a=k("react.strict_mode"),o=k("react.profiler"),s=k("react.provider"),u=k("react.context"),c=k("react.forward_ref"),l=k("react.suspense"),f=k("react.suspense_list"),h=k("react.memo"),d=k("react.lazy"),p=k("react.block"),v=k("react.server.block"),y=k("react.fundamental"),m=k("react.debug_trace_mode"),g=k("react.legacy_hidden")}function b(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case a:case l:case f:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case h:case s:return e;default:return t}}case r:return t}}}t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===o||e===m||e===a||e===l||e===f||e===g||"object"===typeof e&&null!==e&&(e.$$typeof===d||e.$$typeof===h||e.$$typeof===s||e.$$typeof===u||e.$$typeof===c||e.$$typeof===y||e.$$typeof===p||e[0]===v)},t.typeOf=b},441:function(e,t,n){"use strict";e.exports=n(372)},374:function(e,t,n){"use strict";var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function g(){}function k(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var b=k.prototype=new g;b.constructor=k,v(b,m.prototype),b.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,x={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!S.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:x.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===a?"."+T(u,0):a,_(o)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(u=0,a=""===a?".":a+":",_(e))for(var c=0;c<e.length;c++){var l=a+T(s=e[c],c);u+=N(s,t,i,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=N(s=s.value,t,i,l=a+T(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function A(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},R={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:R,ReactCurrentOwner:x};t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=k,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=x.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>a(u,n))c<i&&0>a(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<i&&0>a(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],f=1,h=null,d=3,p=!1,v=!1,y=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function _(e){if(y=!1,b(e),!v)if(null!==r(c))v=!0,R(w);else{var t=r(l);null!==t&&P(_,t.startTime-e)}}function w(e,n){v=!1,y&&(y=!1,g(C),C=-1),p=!0;var a=d;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var u=!0;else{var f=r(l);null!==f&&P(_,f.startTime-n),u=!1}return u}finally{h=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,S=!1,E=null,C=-1,I=5,T=-1;function N(){return!(t.unstable_now()-T<I)}function A(){if(null!==E){var e=t.unstable_now();T=e;var n=!0;try{n=E(!0,e)}finally{n?x():(S=!1,E=null)}}else S=!1}if("function"===typeof k)x=function(){k(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,O=D.port2;D.port1.onmessage=A,x=function(){O.postMessage(null)}}else x=function(){m(A,0)};function R(e){E=e,S||(S=!0,x())}function P(e,n){C=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,R(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(l,e),null===r(c)&&e===r(l)&&(y?(g(C),C=-1):y=!0,P(_,a-o))):(e.sortIndex=s,n(c,e),v||p||(v=!0,R(w))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},613:function(e){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),u=0;u<a.length;u++){var c=a[u];if(!s(c))return!1;var l=e[c],f=t[c];if(!1===(i=n?n.call(r,l,f,c):void 0)||void 0===i&&l!==f)return!1}return!0}},564:function(e){var t=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,n=function(e){return e.match(t)||[]},r=function(e){return e[0].toUpperCase()+e.slice(1)},i=function(e,t){return n(e).join(t).toLowerCase()},a=function(e){return n(e).reduce((function(e,t){return"".concat(e).concat(e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase())}),"")};e.exports={words:n,upperFirst:r,camelCase:a,pascalCase:function(e){return r(a(e))},snakeCase:function(e){return i(e,"_")},kebabCase:function(e){return i(e,"-")},sentenceCase:function(e){return r(i(e," "))},titleCase:function(e){return n(e).map(r).join(" ")}}},514:function(e){function t(e,t){var n=e.length,r=new Array(n),i={},a=n,o=function(e){for(var t=new Map,n=0,r=e.length;n<r;n++){var i=e[n];t.has(i[0])||t.set(i[0],new Set),t.has(i[1])||t.set(i[1],new Set),t.get(i[0]).add(i[1])}return t}(t),s=function(e){for(var t=new Map,n=0,r=e.length;n<r;n++)t.set(e[n],n);return t}(e);for(t.forEach((function(e){if(!s.has(e[0])||!s.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));a--;)i[a]||u(e[a],a,new Set);return r;function u(e,t,a){if(a.has(e)){var c;try{c=", node was:"+JSON.stringify(e)}catch(h){c=""}throw new Error("Cyclic dependency"+c)}if(!s.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!i[t]){i[t]=!0;var l=o.get(e)||new Set;if(t=(l=Array.from(l)).length){a.add(e);do{var f=l[--t];u(f,s.get(f),a)}while(t);a.delete(e)}r[--n]=e}}}e.exports=function(e){return t(function(e){for(var t=new Set,n=0,r=e.length;n<r;n++){var i=e[n];t.add(i[0]),t.add(i[1])}return Array.from(t)}(e),e)},e.exports.array=t},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},861:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return i}})},942:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(142);function i(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},413:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},165:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(2);function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(A){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new I(r||[]);return a(o,"_invoke",{value:x(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(A){return{type:"throw",arg:A}}}e.wrap=f;var d={};function p(){}function v(){}function y(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,k=g&&g(g(T([])));k&&k!==t&&n.call(k,s)&&(m=k);var b=y.prototype=p.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(a,o,s,u){var c=h(e[a],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==(0,r.Z)(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,s,u)}),(function(e){i("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return i("throw",e,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:N}}function N(){return{value:void 0,done:!0}}return v.prototype=y,a(b,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:v,configurable:!0}),v.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},_(w.prototype),l(w.prototype,u,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new w(f(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(b),l(b,c,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}},439:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(878);var i=n(181),a=n(267);function o(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(e,t)||(0,i.Z)(e,t)||(0,a.Z)()}},142:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(2);function i(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},2:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);function i(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(a,o),a}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+"."+{787:"c45b6682",890:"d9b68c18"}[e]+".chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="social-app:";n.l=function(r,i,a,o){if(e[r])e[r].push(i);else{var s,u;if(void 0!==a)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+a){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var h=function(t,n){s.onerror=s.onload=null,clearTimeout(d);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/social-app/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,a,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)u(n)}for(t&&t(r);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunksocial_app=self.webpackChunksocial_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),n.nc=void 0,function(){"use strict";var e={};n.r(e),n.d(e,{FirebaseError:function(){return Lr},SDK_VERSION:function(){return Xi},_DEFAULT_ENTRY_NAME:function(){return Ui},_addComponent:function(){return qi},_addOrOverwriteComponent:function(){return Zi},_apps:function(){return Vi},_clearComponents:function(){return Gi},_components:function(){return zi},_getProvider:function(){return Hi},_registerComponent:function(){return Wi},_removeServiceInstance:function(){return Ki},deleteApp:function(){return na},getApp:function(){return ea},getApps:function(){return ta},initializeApp:function(){return Ji},onLog:function(){return aa},registerVersion:function(){return ia},setLogLevel:function(){return oa}});var t={};n.r(t),n.d(t,{Decoder:function(){return YU},Encoder:function(){return GU},PacketType:function(){return WU},protocol:function(){return KU}});var r=n(791),i=n.t(r,2),a=n(250),o=n(165),s=n(861),u=n(439),c=n(441),l=n(613),f=n.n(l);var h=function(e){function t(e,r,u,c,h){for(var d,p,v,y,b,w=0,x=0,S=0,E=0,C=0,O=0,P=v=d=0,j=0,F=0,M=0,U=0,B=u.length,V=B-1,z="",q="",Z="",W="";j<B;){if(p=u.charCodeAt(j),j===V&&0!==x+E+S+w&&(0!==x&&(p=47===x?10:47),E=S=w=0,B++,V++),0===x+E+S+w){if(j===V&&(0<F&&(z=z.replace(f,"")),0<z.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:z+=u.charAt(j)}p=59}switch(p){case 123:for(d=(z=z.trim()).charCodeAt(0),v=1,U=++j;j<B;){switch(p=u.charCodeAt(j)){case 123:v++;break;case 125:v--;break;case 47:switch(p=u.charCodeAt(j+1)){case 42:case 47:e:{for(P=j+1;P<V;++P)switch(u.charCodeAt(P)){case 47:if(42===p&&42===u.charCodeAt(P-1)&&j+2!==P){j=P+1;break e}break;case 10:if(47===p){j=P+1;break e}}j=P}}break;case 91:p++;case 40:p++;case 34:case 39:for(;j++<V&&u.charCodeAt(j)!==p;);}if(0===v)break;j++}if(v=u.substring(U,j),0===d&&(d=(z=z.replace(l,"").trim()).charCodeAt(0)),64===d){switch(0<F&&(z=z.replace(f,"")),p=z.charCodeAt(1)){case 100:case 109:case 115:case 45:F=r;break;default:F=D}if(U=(v=t(r,F,v,p,h+1)).length,0<R&&(b=s(3,v,F=n(D,z,M),r,T,I,U,p,h,c),z=F.join(""),void 0!==b&&0===(U=(v=b.trim()).length)&&(p=0,v="")),0<U)switch(p){case 115:z=z.replace(_,o);case 100:case 109:case 45:v=z+"{"+v+"}";break;case 107:v=(z=z.replace(m,"$1 $2"))+"{"+v+"}",v=1===A||2===A&&a("@"+v,3)?"@-webkit-"+v+"@"+v:"@"+v;break;default:v=z+v,112===c&&(q+=v,v="")}else v=""}else v=t(r,n(r,z,M),v,c,h+1);Z+=v,v=M=F=P=d=0,z="",p=u.charCodeAt(++j);break;case 125:case 59:if(1<(U=(z=(0<F?z.replace(f,""):z).trim()).length))switch(0===P&&(d=z.charCodeAt(0),45===d||96<d&&123>d)&&(U=(z=z.replace(" ",":")).length),0<R&&void 0!==(b=s(1,z,r,e,T,I,q.length,c,h,c))&&0===(U=(z=b.trim()).length)&&(z="\0\0"),d=z.charCodeAt(0),p=z.charCodeAt(1),d){case 0:break;case 64:if(105===p||99===p){W+=z+u.charAt(j);break}default:58!==z.charCodeAt(U-1)&&(q+=i(z,d,p,z.charCodeAt(2)))}M=F=P=d=0,z="",p=u.charCodeAt(++j)}}switch(p){case 13:case 10:47===x?x=0:0===1+d&&107!==c&&0<z.length&&(F=1,z+="\0"),0<R*L&&s(0,z,r,e,T,I,q.length,c,h,c),I=1,T++;break;case 59:case 125:if(0===x+E+S+w){I++;break}default:switch(I++,y=u.charAt(j),p){case 9:case 32:if(0===E+w+x)switch(C){case 44:case 58:case 9:case 32:y="";break;default:32!==p&&(y=" ")}break;case 0:y="\\0";break;case 12:y="\\f";break;case 11:y="\\v";break;case 38:0===E+x+w&&(F=M=1,y="\f"+y);break;case 108:if(0===E+x+w+N&&0<P)switch(j-P){case 2:112===C&&58===u.charCodeAt(j-3)&&(N=C);case 8:111===O&&(N=O)}break;case 58:0===E+x+w&&(P=j);break;case 44:0===x+S+E+w&&(F=1,y+="\r");break;case 34:case 39:0===x&&(E=E===p?0:0===E?p:E);break;case 91:0===E+x+S&&w++;break;case 93:0===E+x+S&&w--;break;case 41:0===E+x+w&&S--;break;case 40:if(0===E+x+w){if(0===d)if(2*C+3*O===533);else d=1;S++}break;case 64:0===x+S+E+w+P+v&&(v=1);break;case 42:case 47:if(!(0<E+w+S))switch(x){case 0:switch(2*p+3*u.charCodeAt(j+1)){case 235:x=47;break;case 220:U=j,x=42}break;case 42:47===p&&42===C&&U+2!==j&&(33===u.charCodeAt(U+2)&&(q+=u.substring(U,j+1)),y="",x=0)}}0===x&&(z+=y)}O=C,C=p,j++}if(0<(U=q.length)){if(F=r,0<R&&(void 0!==(b=s(2,q,F,e,T,I,U,c,h,c))&&0===(q=b).length))return W+q+Z;if(q=F.join(",")+"{"+q+"}",0!==A*N){switch(2!==A||a(q,2)||(N=0),N){case 111:q=q.replace(k,":-moz-$1")+q;break;case 112:q=q.replace(g,"::-webkit-input-$1")+q.replace(g,"::-moz-$1")+q.replace(g,":-ms-input-$1")+q}N=0}}return W+q+Z}function n(e,t,n){var i=t.trim().split(v);t=i;var a=i.length,o=e.length;switch(o){case 0:case 1:var s=0;for(e=0===o?"":e[0]+" ";s<a;++s)t[s]=r(e,t[s],n).trim();break;default:var u=s=0;for(t=[];s<a;++s)for(var c=0;c<o;++c)t[u++]=r(e[c]+" ",i[s],n).trim()}return t}function r(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(y,"$1"+e.trim());case 58:return e.trim()+t.replace(y,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(y,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function i(e,t,n,r){var o=e+";",s=2*t+3*n+4*r;if(944===s){e=o.indexOf(":",9)+1;var u=o.substring(e,o.length-1).trim();return u=o.substring(0,e).trim()+u+";",1===A||2===A&&a(u,1)?"-webkit-"+u+u:u}if(0===A||2===A&&!a(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(C,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(u=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+u+o;case 1005:return d.test(o)?o.replace(h,":-webkit-")+o.replace(h,":-moz-")+o:o;case 1e3:switch(t=(u=o.substring(13).trim()).indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(t)){case 226:u=o.replace(b,"tb");break;case 232:u=o.replace(b,"tb-rl");break;case 220:u=o.replace(b,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+u+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,s=(u=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(111>u.charCodeAt(8))break;case 115:o=o.replace(u,"-webkit-"+u)+";"+o;break;case 207:case 102:o=o.replace(u,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(u,"-webkit-"+u)+";"+o.replace(u,"-ms-"+u+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return u=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+u+"-ms-flex-"+u+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(x,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(x,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===E.test(e))return 115===(u=e.substring(e.indexOf(":")+1)).charCodeAt(0)?i(e.replace("stretch","fill-available"),t,n,r).replace(":fill-available",":stretch"):o.replace(u,"-webkit-"+u)+o.replace(u,"-moz-"+u.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===n+r&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+o}return o}function a(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),P(2!==t?r:r.replace(S,"$1"),n,t)}function o(e,t){var n=i(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(w," or ($1)").substring(4):"("+t+")"}function s(e,t,n,r,i,a,o,s,u,l){for(var f,h=0,d=t;h<R;++h)switch(f=O[h].call(c,e,d,n,r,i,a,o,s,u,l)){case void 0:case!1:case!0:case null:break;default:d=f}if(d!==t)return d}function u(e){return void 0!==(e=e.prefix)&&(P=null,e?"function"!==typeof e?A=1:(A=2,P=e):A=0),u}function c(e,n){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<R){var i=s(-1,n,r,r,T,I,0,0,0,0);void 0!==i&&"string"===typeof i&&(n=i)}var a=t(D,r,n,0,0);return 0<R&&(void 0!==(i=s(-2,a,r,r,T,I,a.length,0,0,0))&&(a=i)),"",N=0,I=T=1,a}var l=/^\0+/g,f=/[\0\r\f]/g,h=/: */g,d=/zoo|gra/,p=/([,: ])(transform)/g,v=/,\r+?/g,y=/([\t\r\n ])*\f?&/g,m=/@(k\w+)\s*(\S*)\s*/,g=/::(place)/g,k=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,_=/\(\s*(.*)\s*\)/g,w=/([\s\S]*?);/g,x=/-self|flex-/g,S=/[^]*?(:[rp][el]a[\w-]+)[^]*/,E=/stretch|:\s*\w+\-(?:conte|avail)/,C=/([^-])(image-set\()/,I=1,T=1,N=0,A=1,D=[],O=[],R=0,P=null,L=0;return c.use=function e(t){switch(t){case void 0:case null:R=O.length=0;break;default:if("function"===typeof t)O[R++]=t;else if("object"===typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else L=0|!!t}return e},c.set=u,void 0!==e&&u(e),c},d={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function p(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var v=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,y=p((function(e){return v.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),m=n(110),g=n.n(m);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=function(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n},_=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,c.typeOf)(e)},w=Object.freeze([]),x=Object.freeze({});function S(e){return"function"==typeof e}function E(e){return e.displayName||e.name||"Component"}function C(e){return e&&"string"==typeof e.styledComponentId}var I="undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_ATTR)||"data-styled",T="undefined"!=typeof window&&"HTMLElement"in window,N=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&(void 0!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY:void 0!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&("false"!=={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY)));function A(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var D=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,i=r;e>=i;)(i<<=1)<0&&A(16,""+e);this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var a=r;a<i;a++)this.groupSizes[a]=0}for(var o=this.indexOfGroup(e+1),s=0,u=t.length;s<u;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var i=n;i<r;i++)this.tag.deleteRule(n)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n,a=r;a<i;a++)t+=this.tag.getRule(a)+"/*!sc*/\n";return t},e}(),O=new Map,R=new Map,P=1,L=function(e){if(O.has(e))return O.get(e);for(;R.has(P);)P++;var t=P++;return O.set(e,t),R.set(t,e),t},j=function(e){return R.get(e)},F=function(e,t){t>=P&&(P=t+1),O.set(e,t),R.set(t,e)},M="style["+I+'][data-styled-version="5.3.11"]',U=new RegExp("^"+I+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),B=function(e,t,n){for(var r,i=n.split(","),a=0,o=i.length;a<o;a++)(r=i[a])&&e.registerName(t,r)},V=function(e,t){for(var n=(t.textContent||"").split("/*!sc*/\n"),r=[],i=0,a=n.length;i<a;i++){var o=n[i].trim();if(o){var s=o.match(U);if(s){var u=0|parseInt(s[1],10),c=s[2];0!==u&&(F(c,u),B(e,c,s[3]),e.getTag().insertRules(u,r)),r.length=0}else r.push(o)}}},z=function(){return n.nc},q=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(e){for(var t=e.childNodes,n=t.length;n>=0;n--){var r=t[n];if(r&&1===r.nodeType&&r.hasAttribute(I))return r}}(n),a=void 0!==i?i.nextSibling:null;r.setAttribute(I,"active"),r.setAttribute("data-styled-version","5.3.11");var o=z();return o&&r.setAttribute("nonce",o),n.insertBefore(r,a),r},Z=function(){function e(e){var t=this.element=q(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var i=t[n];if(i.ownerNode===e)return i}A(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),W=function(){function e(e){var t=this.element=q(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t),r=this.nodes[e];return this.element.insertBefore(n,r||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),H=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),K=T,G={isServer:!T,useCSSOMInjection:!N},Q=function(){function e(e,t,n){void 0===e&&(e=x),void 0===t&&(t={}),this.options=k({},G,{},e),this.gs=t,this.names=new Map(n),this.server=!!e.isServer,!this.server&&T&&K&&(K=!1,function(e){for(var t=document.querySelectorAll(M),n=0,r=t.length;n<r;n++){var i=t[n];i&&"active"!==i.getAttribute(I)&&(V(e,i),i.parentNode&&i.parentNode.removeChild(i))}}(this))}e.registerId=function(e){return L(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(k({},this.options,{},t),this.gs,n&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(t=this.options).isServer,r=t.useCSSOMInjection,i=t.target,e=n?new H(i):r?new Z(i):new W(i),new D(e)));var e,t,n,r,i},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(L(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},t.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(L(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(L(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),n=t.length,r="",i=0;i<n;i++){var a=j(i);if(void 0!==a){var o=e.names.get(a),s=t.getGroup(i);if(o&&s&&o.size){var u=I+".g"+i+'[id="'+a+'"]',c="";void 0!==o&&o.forEach((function(e){e.length>0&&(c+=e+",")})),r+=""+s+u+'{content:"'+c+'"}/*!sc*/\n'}}}return r}(this)},e}(),Y=/(a)(d)/gi,$=function(e){return String.fromCharCode(e+(e>25?39:97))};function X(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=$(t%52)+n;return($(t%52)+n).replace(Y,"$1-$2")}var J=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},ee=function(e){return J(5381,e)};function te(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(S(n)&&!C(n))return!1}return!0}var ne=ee("5.3.11"),re=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&te(e),this.componentId=t,this.baseHash=J(ne,t),this.baseStyle=n,Q.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.componentId,i=[];if(this.baseStyle&&i.push(this.baseStyle.generateAndInjectStyles(e,t,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(r,this.staticRulesId))i.push(this.staticRulesId);else{var a=_e(this.rules,e,t,n).join(""),o=X(J(this.baseHash,a)>>>0);if(!t.hasNameForId(r,o)){var s=n(a,"."+o,void 0,r);t.insertRules(r,o,s)}i.push(o),this.staticRulesId=o}else{for(var u=this.rules.length,c=J(this.baseHash,n.hash),l="",f=0;f<u;f++){var h=this.rules[f];if("string"==typeof h)l+=h;else if(h){var d=_e(h,e,t,n),p=Array.isArray(d)?d.join(""):d;c=J(c,p+f),l+=p}}if(l){var v=X(c>>>0);if(!t.hasNameForId(r,v)){var y=n(l,"."+v,void 0,r);t.insertRules(r,v,y)}i.push(v)}}return i.join(" ")},e}(),ie=/^\s*\/\/.*$/gm,ae=[":","[",".","#"];function oe(e){var t,n,r,i,a=void 0===e?x:e,o=a.options,s=void 0===o?x:o,u=a.plugins,c=void 0===u?w:u,l=new h(s),f=[],d=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(n,r,i,a,o,s,u,c,l,f){switch(n){case 1:if(0===l&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===c)return r+"/*|*/";break;case 3:switch(c){case 102:case 112:return e(i[0]+r),"";default:return r+(0===f?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(t)}}}((function(e){f.push(e)})),p=function(e,r,a){return 0===r&&-1!==ae.indexOf(a[n.length])||a.match(i)?e:"."+t};function v(e,a,o,s){void 0===s&&(s="&");var u=e.replace(ie,""),c=a&&o?o+" "+a+" { "+u+" }":u;return t=s,n=a,r=new RegExp("\\"+n+"\\b","g"),i=new RegExp("(\\"+n+"\\b){2,}"),l(o||!a?"":a,c)}return l.use([].concat(c,[function(e,t,i){2===e&&i.length&&i[0].lastIndexOf(n)>0&&(i[0]=i[0].replace(r,p))},d,function(e){if(-2===e){var t=f;return f=[],t}}])),v.hash=c.length?c.reduce((function(e,t){return t.name||A(15),J(e,t.name)}),5381).toString():"",v}var se=r.createContext(),ue=(se.Consumer,r.createContext()),ce=(ue.Consumer,new Q),le=oe();function fe(){return(0,r.useContext)(se)||ce}function he(){return(0,r.useContext)(ue)||le}function de(e){var t=(0,r.useState)(e.stylisPlugins),n=t[0],i=t[1],a=fe(),o=(0,r.useMemo)((function(){var t=a;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target]),s=(0,r.useMemo)((function(){return oe({options:{prefix:!e.disableVendorPrefixes},plugins:n})}),[e.disableVendorPrefixes,n]);return(0,r.useEffect)((function(){f()(n,e.stylisPlugins)||i(e.stylisPlugins)}),[e.stylisPlugins]),r.createElement(se.Provider,{value:o},r.createElement(ue.Provider,{value:s},e.children))}var pe=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=le);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.toString=function(){return A(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=le),this.name+e.hash},e}(),ve=/([A-Z])/,ye=/([A-Z])/g,me=/^ms-/,ge=function(e){return"-"+e.toLowerCase()};function ke(e){return ve.test(e)?e.replace(ye,ge).replace(me,"-ms-"):e}var be=function(e){return null==e||!1===e||""===e};function _e(e,t,n,r){if(Array.isArray(e)){for(var i,a=[],o=0,s=e.length;o<s;o+=1)""!==(i=_e(e[o],t,n,r))&&(Array.isArray(i)?a.push.apply(a,i):a.push(i));return a}return be(e)?"":C(e)?"."+e.styledComponentId:S(e)?"function"!=typeof(u=e)||u.prototype&&u.prototype.isReactComponent||!t?e:_e(e(t),t,n,r):e instanceof pe?n?(e.inject(n,r),e.getName(r)):e:_(e)?function e(t,n){var r,i,a=[];for(var o in t)t.hasOwnProperty(o)&&!be(t[o])&&(Array.isArray(t[o])&&t[o].isCss||S(t[o])?a.push(ke(o)+":",t[o],";"):_(t[o])?a.push.apply(a,e(t[o],o)):a.push(ke(o)+": "+(r=o,(null==(i=t[o])||"boolean"==typeof i||""===i?"":"number"!=typeof i||0===i||r in d||r.startsWith("--")?String(i).trim():i+"px")+";")));return n?[n+" {"].concat(a,["}"]):a}(e):e.toString();var u}var we=function(e){return Array.isArray(e)&&(e.isCss=!0),e};function xe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return S(e)||_(e)?we(_e(b(w,[e].concat(n)))):0===n.length&&1===e.length&&"string"==typeof e[0]?e:we(_e(b(e,n)))}new Set;var Se=function(e,t,n){return void 0===n&&(n=x),e.theme!==n.theme&&e.theme||t||n.theme},Ee=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ce=/(^-|-$)/g;function Ie(e){return e.replace(Ee,"-").replace(Ce,"")}var Te=function(e){return X(ee(e)>>>0)};function Ne(e){return"string"==typeof e&&!0}var Ae=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},De=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function Oe(e,t,n){var r=e[n];Ae(t)&&Ae(r)?Re(r,t):e[n]=t}function Re(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];if(Ae(o))for(var s in o)De(s)&&Oe(e,o[s],s)}return e}var Pe=r.createContext();Pe.Consumer;var Le={};function je(e,t,n){var i=C(e),a=!Ne(e),o=t.attrs,s=void 0===o?w:o,u=t.componentId,c=void 0===u?function(e,t){var n="string"!=typeof e?"sc":Ie(e);Le[n]=(Le[n]||0)+1;var r=n+"-"+Te("5.3.11"+n+Le[n]);return t?t+"-"+r:r}(t.displayName,t.parentComponentId):u,l=t.displayName,f=void 0===l?function(e){return Ne(e)?"styled."+e:"Styled("+E(e)+")"}(e):l,h=t.displayName&&t.componentId?Ie(t.displayName)+"-"+t.componentId:t.componentId||c,d=i&&e.attrs?Array.prototype.concat(e.attrs,s).filter(Boolean):s,p=t.shouldForwardProp;i&&e.shouldForwardProp&&(p=t.shouldForwardProp?function(n,r,i){return e.shouldForwardProp(n,r,i)&&t.shouldForwardProp(n,r,i)}:e.shouldForwardProp);var v,m=new re(n,h,i?e.componentStyle:void 0),b=m.isStatic&&0===s.length,_=function(e,t){return function(e,t,n,i){var a=e.attrs,o=e.componentStyle,s=e.defaultProps,u=e.foldedComponentIds,c=e.shouldForwardProp,l=e.styledComponentId,f=e.target,h=function(e,t,n){void 0===e&&(e=x);var r=k({},t,{theme:e}),i={};return n.forEach((function(e){var t,n,a,o=e;for(t in S(o)&&(o=o(r)),o)r[t]=i[t]="className"===t?(n=i[t],a=o[t],n&&a?n+" "+a:n||a):o[t]})),[r,i]}(Se(t,(0,r.useContext)(Pe),s)||x,t,a),d=h[0],p=h[1],v=function(e,t,n,r){var i=fe(),a=he();return t?e.generateAndInjectStyles(x,i,a):e.generateAndInjectStyles(n,i,a)}(o,i,d),m=n,g=p.$as||t.$as||p.as||t.as||f,b=Ne(g),_=p!==t?k({},t,{},p):t,w={};for(var E in _)"$"!==E[0]&&"as"!==E&&("forwardedAs"===E?w.as=_[E]:(c?c(E,y,g):!b||y(E))&&(w[E]=_[E]));return t.style&&p.style!==t.style&&(w.style=k({},t.style,{},p.style)),w.className=Array.prototype.concat(u,l,v!==l?v:null,t.className,p.className).filter(Boolean).join(" "),w.ref=m,(0,r.createElement)(g,w)}(v,e,t,b)};return _.displayName=f,(v=r.forwardRef(_)).attrs=d,v.componentStyle=m,v.displayName=f,v.shouldForwardProp=p,v.foldedComponentIds=i?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):w,v.styledComponentId=h,v.target=i?e.target:e,v.withComponent=function(e){var r=t.componentId,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(t,["componentId"]),a=r&&r+"-"+(Ne(e)?e:Ie(E(e)));return je(e,k({},i,{attrs:d,componentId:a}),n)},Object.defineProperty(v,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=i?Re({},e.defaultProps,t):t}}),Object.defineProperty(v,"toString",{value:function(){return"."+v.styledComponentId}}),a&&g()(v,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),v}var Fe=function(e){return function e(t,n,r){if(void 0===r&&(r=x),!(0,c.isValidElementType)(n))return A(1,String(n));var i=function(){return t(n,r,xe.apply(void 0,arguments))};return i.withConfig=function(i){return e(t,n,k({},r,{},i))},i.attrs=function(i){return e(t,n,k({},r,{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},i}(je,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(e){Fe[e]=Fe(e)}));!function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=te(e),Q.registerId(this.componentId+1)}var t=e.prototype;t.createStyles=function(e,t,n,r){var i=r(_e(this.rules,t,n,r).join(""),""),a=this.componentId+e;n.insertRules(a,a,i)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,n,r){e>2&&Q.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)}}();!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var n=z();return"<style "+[n&&'nonce="'+n+'"',I+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?A(2):e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)return A(2);var n=((t={})[I]="",t["data-styled-version"]="5.3.11",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),i=z();return i&&(n.nonce=i),[r.createElement("style",k({},n,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new Q({isServer:!0}),this.sealed=!1}var t=e.prototype;t.collectStyles=function(e){return this.sealed?A(2):r.createElement(de,{sheet:this.instance},e)},t.interleaveWithNodeStream=function(e){return A(3)}}();var Me=Fe,Ue=n(164),Be=Me.div.withConfig({displayName:"baseStyles__BaseModalBackground"})(["display:flex;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:30;background-color:rgba(0,0,0,0.5);align-items:center;justify-content:center;"]);function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(){}function Ze(){}Ze.resetWarningCache=qe;var We,He,Ke=(We=function(e){e.exports=function(){function e(e,t,n,r,i,a){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==a){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Ze,resetWarningCache:qe};return n.PropTypes=n,n}()},We(He={exports:{}}),He.exports),Ge=Ke,Qe=r.createContext({}),Ye=Qe.Provider,$e=Qe.Consumer;function Xe(e){var t=e.backgroundComponent,n=e.children,i=(0,r.useRef)(null),a=ze((0,r.useState)(null),2),o=a[0],s=a[1],u=ze((0,r.useState)(Be),2),c=u[0],l=u[1];return(0,r.useEffect)((function(){t&&l(t)}),[l,t]),(0,r.useEffect)((function(){s(i.current)}),[s,i]),r.createElement(Ye,{value:{modalNode:o,BackgroundComponent:c}},n,r.createElement("div",{ref:i}))}function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Je.apply(this,arguments)}Xe.propTypes={backgroundComponent:Ge.oneOfType([Ge.element,Ge.object])};var et=["WrapperComponent","children","onBackgroundClick","onEscapeKeydown","allowScroll","beforeOpen","afterOpen","beforeClose","afterClose","backgroundProps","isOpen"];function tt(e){var t,n=e.WrapperComponent,i=e.children,a=e.onBackgroundClick,o=e.onEscapeKeydown,s=e.allowScroll,u=e.beforeOpen,c=e.afterOpen,l=e.beforeClose,f=e.afterClose,h=e.backgroundProps,d=e.isOpen,p=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,et),v=(0,r.useRef)(null),y=(0,r.useRef)(null),m=(0,r.useRef)(!1),g=ze((0,r.useState)(!1),2),k=g[0],b=g[1];function _(e){v.current===e.target&&a&&a(e)}return(0,r.useEffect)((function(){function e(e){b(e),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e&&e.apply(void 0,n)}(e?c:f)}k===d||m.current||function(t){if(t){var n=t();"function"==typeof(null==n?void 0:n.then)?(m.current=!0,n.then((function(){e(d),m.current=!1}))):e(d)}else e(d)}(d?u:l)}),[m,k,d,u,l,f,c]),(0,r.useEffect)((function(){function e(e){"Escape"===e.key&&o&&o(e)}return k&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[k,o]),(0,r.useEffect)((function(){return k&&!s&&(y.current=document.body.style.overflow,document.body.style.overflow="hidden"),function(){s||(document.body.style.overflow=y.current||"")}}),[k,s]),t=n?r.createElement(n,p,i):i,r.createElement($e,null,(function(e){var n=e.modalNode,i=e.BackgroundComponent;return n&&i&&k?Ue.createPortal(r.createElement(i,Je({},h,{onClick:_,ref:v}),t),n):null}))}tt.styled=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t?Me.div.withConfig({displayName:"Modal__wrap"}).apply(void 0,t):Me.div.withConfig({displayName:"Modal__wrap"})();return function(e){return r.createElement(tt,Je({WrapperComponent:i},e))}},tt.defaultProps={backgroundProps:{}},tt.propTypes={WrapperComponent:Ge.oneOfType([Ge.element,Ge.object]),onBackgroundClick:Ge.func,onEscapeKeydown:Ge.func,allowScroll:Ge.bool,beforeOpen:Ge.func,afterOpen:Ge.func,beforeClose:Ge.func,afterClose:Ge.func,backgroundProps:Ge.object,isOpen:Ge.bool};var nt=r.createContext({claims:[],update:function(){}}),rt="token";function it(e){console.log(e),localStorage.setItem(rt,e)}function at(){var e=localStorage.getItem(rt);if(!e||"null"===e)return[];var t=JSON.parse(atob(e.split(".")[1])),n=[];for(var r in t)n.push({name:r,value:t[r]});return n}var ot=n(184);function st(){return(0,ot.jsx)("div",{className:"landing-page",style:{height:"100%"},children:(0,ot.jsx)("h2",{children:"You have lost your internet connection. Try to reconnect"})})}var ut=n(907);function ct(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var lt=n(181);function ft(e){return function(e){if(Array.isArray(e))return(0,ut.Z)(e)}(e)||ct(e)||(0,lt.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var dt=n(142);function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(0,dt.Z)(r.key),r)}}function vt(e,t,n){return t&&pt(e.prototype,t),n&&pt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yt(e,t){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yt(e,t)}function mt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t)}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(e)}function kt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var bt=n(2);function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e){var t=kt();return function(){var n,r=gt(e);if(t){var i=gt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===(0,bt.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _t(e)}(this,n)}}function xt(e,t,n){return xt=kt()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&yt(i,n.prototype),i},xt.apply(null,arguments)}function St(e){var t="function"===typeof Map?new Map:void 0;return St=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return xt(e,arguments,gt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),yt(n,e)},St(e)}var Et,Ct=n(878),It=n(267);function Tt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,lt.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Nt(){return Nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nt.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(Et||(Et={}));var At,Dt="popstate";function Ot(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function Rt(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function Pt(e,t){return{usr:e.state,key:e.key,idx:t}}function Lt(e,t,n,r){return void 0===n&&(n=null),Nt({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?Ft(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function jt(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,o=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function Ft(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Mt(e,t,n,r){void 0===r&&(r={});var i=r,a=i.window,o=void 0===a?document.defaultView:a,s=i.v5Compat,u=void 0!==s&&s,c=o.history,l=Et.Pop,f=null,h=d();function d(){return(c.state||{idx:null}).idx}function p(){l=Et.Pop;var e=d(),t=null==e?null:e-h;h=e,f&&f({action:l,location:y.location,delta:t})}function v(e){var t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:jt(e);return Ot(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==h&&(h=0,c.replaceState(Nt({},c.state,{idx:h}),""));var y={get action(){return l},get location(){return e(o,c)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(Dt,p),f=e,function(){o.removeEventListener(Dt,p),f=null}},createHref:function(e){return t(o,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=Et.Push;var r=Lt(y.location,e,t);n&&n(r,e);var i=Pt(r,h=d()+1),a=y.createHref(r);try{c.pushState(i,"",a)}catch(Qa){if(Qa instanceof DOMException&&"DataCloneError"===Qa.name)throw Qa;o.location.assign(a)}u&&f&&f({action:l,location:y.location,delta:1})},replace:function(e,t){l=Et.Replace;var r=Lt(y.location,e,t);n&&n(r,e);var i=Pt(r,h=d()),a=y.createHref(r);c.replaceState(i,"",a),u&&f&&f({action:l,location:y.location,delta:0})},go:function(e){return c.go(e)}};return y}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(At||(At={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function Ut(e,t,n){void 0===n&&(n="/");var r=Jt(("string"===typeof t?Ft(t):t).pathname||"/",n);if(null==r)return null;var i=Bt(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,o=0;null==a&&o<i.length;++o)a=Yt(i[o],Xt(r));return a}function Bt(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var i=function(e,i,a){var o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(Ot(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var s=rn([r,o.relativePath]),u=n.concat(o);e.children&&e.children.length>0&&(Ot(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),Bt(e.children,t,u,s)),(null!=e.path||e.index)&&t.push({path:s,score:Qt(s,e.index),routesMeta:u})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,a=Tt(Vt(e.path));try{for(a.s();!(r=a.n()).done;){var o=r.value;i(e,t,o)}}catch(s){a.e(s)}finally{a.f()}}else i(e,t)})),t}function Vt(e){var t=e.split("/");if(0===t.length)return[];var n,r=(n=t,(0,Ct.Z)(n)||ct(n)||(0,lt.Z)(n)||(0,It.Z)()),i=r[0],a=r.slice(1),o=i.endsWith("?"),s=i.replace(/\?$/,"");if(0===a.length)return o?[s,""]:[s];var u=Vt(a.join("/")),c=[];return c.push.apply(c,ft(u.map((function(e){return""===e?s:[s,e].join("/")})))),o&&c.push.apply(c,ft(u)),c.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}var zt=/^:\w+$/,qt=3,Zt=2,Wt=1,Ht=10,Kt=-2,Gt=function(e){return"*"===e};function Qt(e,t){var n=e.split("/"),r=n.length;return n.some(Gt)&&(r+=Kt),t&&(r+=Zt),n.filter((function(e){return!Gt(e)})).reduce((function(e,t){return e+(zt.test(t)?qt:""===t?Wt:Ht)}),r)}function Yt(e,t){for(var n=e.routesMeta,r={},i="/",a=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,c="/"===i?t:t.slice(i.length)||"/",l=$t({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var f=s.route;a.push({params:r,pathname:rn([i,l.pathname]),pathnameBase:an(rn([i,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(i=rn([i,l.pathnameBase]))}return a}function $t(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);Rt("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");var a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),r=(0,u.Z)(n,2),i=r[0],a=r[1],o=t.match(i);if(!o)return null;var s=o[0],c=s.replace(/(.)\/+$/,"$1"),l=o.slice(1),f=a.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";c=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(Qa){return Rt(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+Qa+")."),e}}(l[n]||"",t),e}),{});return{params:f,pathname:s,pathnameBase:c,pattern:e}}function Xt(e){try{return decodeURI(e)}catch(Qa){return Rt(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+Qa+")."),e}}function Jt(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function en(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function tn(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function nn(e,t,n,r){var i;void 0===r&&(r=!1),"string"===typeof e?i=Ft(e):(Ot(!(i=Nt({},e)).pathname||!i.pathname.includes("?"),en("?","pathname","search",i)),Ot(!i.pathname||!i.pathname.includes("#"),en("#","pathname","hash",i)),Ot(!i.search||!i.search.includes("#"),en("#","search","hash",i)));var a,o=""===e||""===i.pathname,s=o?"/":i.pathname;if(r||null==s)a=n;else{var u=t.length-1;if(s.startsWith("..")){for(var c=s.split("/");".."===c[0];)c.shift(),u-=1;i.pathname=c.join("/")}a=u>=0?t[u]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?Ft(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:on(a),hash:sn(s)}}(i,a),f=s&&"/"!==s&&s.endsWith("/"),h=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!h||(l.pathname+="/"),l}var rn=function(e){return e.join("/").replace(/\/\/+/g,"/")},an=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},on=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},sn=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},un=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n)}(St(Error));function cn(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var ln=["post","put","patch","delete"],fn=(new Set(ln),["get"].concat(ln));new Set(fn),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function hn(){return hn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hn.apply(this,arguments)}var dn=r.createContext(null);var pn=r.createContext(null);var vn=r.createContext(null);var yn=r.createContext(null);var mn=r.createContext(null);var gn=r.createContext({outlet:null,matches:[],isDataRoute:!1});var kn=r.createContext(null);function bn(){return null!=r.useContext(mn)}function _n(){return bn()||Ot(!1),r.useContext(mn).location}function wn(e){r.useContext(yn).static||r.useLayoutEffect(e)}function xn(){return r.useContext(gn).isDataRoute?function(){var e=Pn(Tn.UseNavigateStable).router,t=jn(Nn.UseNavigateStable),n=r.useRef(!1);wn((function(){n.current=!0}));var i=r.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,hn({fromRouteId:t},i)))}),[e,t]);return i}():function(){bn()||Ot(!1);var e=r.useContext(dn),t=r.useContext(yn),n=t.basename,i=t.navigator,a=r.useContext(gn).matches,o=_n().pathname,s=JSON.stringify(tn(a).map((function(e){return e.pathnameBase}))),u=r.useRef(!1);wn((function(){u.current=!0}));var c=r.useCallback((function(t,r){if(void 0===r&&(r={}),u.current)if("number"!==typeof t){var a=nn(t,JSON.parse(s),o,"path"===r.relative);null==e&&"/"!==n&&(a.pathname="/"===a.pathname?n:rn([n,a.pathname])),(r.replace?i.replace:i.push)(a,r.state,r)}else i.go(t)}),[n,i,s,o,e]);return c}()}var Sn=r.createContext(null);function En(){var e=r.useContext(gn).matches,t=e[e.length-1];return t?t.params:{}}function Cn(e,t,n){bn()||Ot(!1);var i,a=r.useContext(yn).navigator,o=r.useContext(gn).matches,s=o[o.length-1],u=s?s.params:{},c=(s&&s.pathname,s?s.pathnameBase:"/"),l=(s&&s.route,_n());if(t){var f,h="string"===typeof t?Ft(t):t;"/"===c||(null==(f=h.pathname)?void 0:f.startsWith(c))||Ot(!1),i=h}else i=l;var d=i.pathname||"/",p=Ut(e,{pathname:"/"===c?d:d.slice(c.length)||"/"});var v=Rn(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},u,e.params),pathname:rn([c,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:rn([c,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),o,n);return t&&v?r.createElement(mn.Provider,{value:{location:hn({pathname:"/",search:"",hash:"",state:null,key:"default"},i),navigationType:Et.Pop}},v):v}function In(){var e=function(){var e,t=r.useContext(kn),n=Ln(Nn.UseRouteError),i=jn(Nn.UseRouteError);if(t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=cn(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:a},n):null,null)}var Tn,Nn,An=r.createElement(In,null),Dn=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},r}return vt(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?r.createElement(gn.Provider,{value:this.props.routeContext},r.createElement(kn.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}}]),n}(r.Component);function On(e){var t=e.routeContext,n=e.match,i=e.children,a=r.useContext(dn);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(gn.Provider,{value:t},i)}function Rn(e,t,n){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),null==e){var a;if(null==(a=n)||!a.errors)return null;e=n.matches}var o=e,s=null==(i=n)?void 0:i.errors;if(null!=s){var u=o.findIndex((function(e){return e.route.id&&(null==s?void 0:s[e.route.id])}));u>=0||Ot(!1),o=o.slice(0,Math.min(o.length,u+1))}return o.reduceRight((function(e,i,a){var u=i.route.id?null==s?void 0:s[i.route.id]:null,c=null;n&&(c=i.route.errorElement||An);var l=t.concat(o.slice(0,a+1)),f=function(){var t;return t=u?c:i.route.Component?r.createElement(i.route.Component,null):i.route.element?i.route.element:e,r.createElement(On,{match:i,routeContext:{outlet:e,matches:l,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?r.createElement(Dn,{location:n.location,revalidation:n.revalidation,component:c,error:u,children:f(),routeContext:{outlet:null,matches:l,isDataRoute:!0}}):f()}),null)}function Pn(e){var t=r.useContext(dn);return t||Ot(!1),t}function Ln(e){var t=r.useContext(pn);return t||Ot(!1),t}function jn(e){var t=function(e){var t=r.useContext(gn);return t||Ot(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||Ot(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"}(Tn||(Tn={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"}(Nn||(Nn={}));var Fn;function Mn(e){var t=e.to,n=e.replace,i=e.state,a=e.relative;bn()||Ot(!1);var o=r.useContext(gn).matches,s=_n().pathname,u=xn(),c=nn(t,tn(o).map((function(e){return e.pathnameBase})),s,"path"===a),l=JSON.stringify(c);return r.useEffect((function(){return u(JSON.parse(l),{replace:n,state:i,relative:a})}),[u,l,a,n,i]),null}function Un(e){return function(e){var t=r.useContext(gn).outlet;return t?r.createElement(Sn.Provider,{value:e},t):t}(e.context)}function Bn(e){Ot(!1)}function Vn(e){var t=e.basename,n=void 0===t?"/":t,i=e.children,a=void 0===i?null:i,o=e.location,s=e.navigationType,u=void 0===s?Et.Pop:s,c=e.navigator,l=e.static,f=void 0!==l&&l;bn()&&Ot(!1);var h=n.replace(/^\/*/,"/"),d=r.useMemo((function(){return{basename:h,navigator:c,static:f}}),[h,c,f]);"string"===typeof o&&(o=Ft(o));var p=o,v=p.pathname,y=void 0===v?"/":v,m=p.search,g=void 0===m?"":m,k=p.hash,b=void 0===k?"":k,_=p.state,w=void 0===_?null:_,x=p.key,S=void 0===x?"default":x,E=r.useMemo((function(){var e=Jt(y,h);return null==e?null:{location:{pathname:e,search:g,hash:b,state:w,key:S},navigationType:u}}),[h,y,g,b,w,S,u]);return null==E?null:r.createElement(yn.Provider,{value:d},r.createElement(mn.Provider,{children:a,value:E}))}function zn(e){var t=e.children,n=e.location;return function(e,t){return Cn(e,t)}(Zn(t),n)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(Fn||(Fn={}));var qn=new Promise((function(){}));r.Component;function Zn(e,t){void 0===t&&(t=[]);var n=[];return r.Children.forEach(e,(function(e,i){if(r.isValidElement(e)){var a=[].concat(ft(t),[i]);if(e.type!==r.Fragment){e.type!==Bn&&Ot(!1),e.props.index&&e.props.children&&Ot(!1);var o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Zn(e.props.children,a)),n.push(o)}else n.push.apply(n,Zn(e.props.children,a))}})),n}var Wn="startTransition";function Hn(e){var t,n=e.basename,a=e.children,o=e.window,s=r.useRef();null==s.current&&(s.current=(void 0===(t={window:o,v5Compat:!0})&&(t={}),Mt((function(e,t){var n=Ft(e.location.hash.substr(1)),r=n.pathname,i=void 0===r?"/":r,a=n.search,o=void 0===a?"":a,s=n.hash;return Lt("",{pathname:i,search:o,hash:void 0===s?"":s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){var n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){var i=e.location.href,a=i.indexOf("#");r=-1===a?i:i.slice(0,a)}return r+"#"+("string"===typeof t?t:jt(t))}),(function(e,t){Rt("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),t)));var c=s.current,l=r.useState({action:c.action,location:c.location}),f=(0,u.Z)(l,2),h=f[0],d=f[1],p=r.useCallback((function(e){Wn in i?i[Wn]((function(){return d(e)})):d(e)}),[d]);return r.useLayoutEffect((function(){return c.listen(p)}),[c,p]),r.createElement(Vn,{basename:n,children:a,location:h.location,navigationType:h.action,navigator:c})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Kn,Gn;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Kn||(Kn={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Gn||(Gn={}));function Qn(e){var t=e.isAuthenticated;return(0,ot.jsx)(ot.Fragment,{children:t?(0,ot.jsx)(Un,{}):(0,ot.jsx)(Mn,{to:"/"})})}function Yn(e){var t=(0,r.useState)(!1),n=(0,u.Z)(t,2),i=n[0],a=n[1],o=(0,r.useContext)(nt).claims;return(0,r.useEffect)((function(){if(e.role){var t=o.findIndex((function(t){return"role"===t.name&&t.value===e.role}));a(t>-1)}else a(o.length>0)}),[o,e.role]),(0,ot.jsx)(ot.Fragment,{children:i?e.isAuthorized:e.notAuthorized})}var $n,Xn=r.createContext({myProfile:{Id:"",Email:""},updateProfile:function(){}}),Jn=r.createContext({myFriends:[],updateFriends:function(){}}),er=r.createContext({myFriendRequests:[],updateFriendRequests:function(){}}),tr=r.createContext({mySentRequests:[],updateSentFriendRequests:function(){}}),nr=r.createContext({openedChats:[],updateOpenedChats:function(){}}),rr="".concat("/social-app");function ir(e){var t=e.friend,n=(0,r.useContext)(nr),i=n.openedChats,a=n.updateOpenedChats;return(0,ot.jsxs)("li",{onClick:function(){if(!i.includes(t)){var e=[t].concat(ft(i));a(e)}},children:[(0,ot.jsx)("img",{src:t.ProfileImage||"".concat(rr,"/noProfile.jpg")}),(0,ot.jsx)("span",{className:"medium-font",children:t.Email})]})}function ar(){var e=(0,r.useContext)(Jn).myFriends;return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsxs)("div",{className:"bar bar-right",children:[(0,ot.jsx)("h5",{children:"Friends"}),(0,ot.jsx)("ul",{children:e&&e.map((function(e){return(0,ot.jsx)(ir,{friend:e},e.Id)}))})]})})}function or(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var sr=tt.styled($n||($n=or(["\n  width: 30rem;\n  height: 40rem;\n  display: flex;\n  align-items: center;\n  background-color: #ffffff;\n  flex-direction: column;\n  border-radius: 1rem;\n  box-shadow: 0 12px 28px 0 rgba(0, 0, 0, 0.6), 0 2px 4px 0 rgba(0, 0, 0, 0.4), inset 0 0 0 1px rgba(255, 255, 255, 0.5);\n"])));function ur(e){var t=e.isOpen,n=e.toggleModal,r=e.children,i=e.submitButtonText,a=e.onSubmit,o=e.disableSubmit;return(0,ot.jsxs)(sr,{isOpen:t,onBackgroundClick:n,onEscapeKeydown:n,children:[r,(0,ot.jsxs)("div",{children:[(0,ot.jsx)("button",{disabled:o,onClick:function(){n(),a()},children:i}),(0,ot.jsx)("button",{onClick:n,children:"Close"})]})]})}var cr="https://cacarrot-server.herokuapp.com/social";var lr=function(e,t){var n=new Request("".concat(cr,"/").concat(t),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST","Access-Control-Allow-Headers":"Content-Type"},mode:"cors",body:JSON.stringify(e)});return fetch(n).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.error("Error:",e)}))},fr=function(e,t){var n=new Request("".concat(cr,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"PUT","Access-Control-Allow-Headers":"Content-Type"},mode:"cors",body:JSON.stringify(e)});return fetch(n).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.error("Error:",e)}))},hr=n(942),dr=!1,pr=!1,vr="${JSCORE_VERSION}",yr=function(e,t){if(!e)throw mr(t)},mr=function(e){return new Error("Firebase Database ("+vr+") INTERNAL ASSERT FAILED: "+e)},gr=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},kr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=a>>2,f=(3&a)<<4|s>>4,h=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(h=64)),r.push(n[l],n[f],n[h],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(gr(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw new br;var c=a<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},br=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return vt(n)}(St(Error)),_r=function(e){var t=gr(e);return kr.encodeByteArray(t,!0)},wr=function(e){return _r(e).replace(/\./g,"")},xr=function(e){try{return kr.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Sr(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Sr(e[n],t[n]));return e}var Er=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},Cr=function(){try{return Er()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&xr(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},Ir=function(){var e;return null===(e=Cr())||void 0===e?void 0:e.config},Tr=function(){function e(){var t=this;ht(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return vt(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function Nr(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[wr(JSON.stringify({alg:"none",type:"JWT"})),wr(JSON.stringify(a)),""].join(".")}function Ar(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Dr(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ar())}function Or(){var e,t=null===(e=Cr())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function Rr(){return!0===dr||!0===pr}function Pr(){try{return"object"===typeof indexedDB}catch(e){return!1}}var Lr=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(_t(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(_t(a),jr.prototype.create),a}return vt(n)}(St(Error)),jr=function(){function e(t,n,r){ht(this,e),this.service=t,this.serviceName=n,this.errors=r}return vt(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(Fr,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new Lr(n,a,t)}}]),e}();var Fr=/\{\$([^}]+)}/g;function Mr(e){return JSON.parse(e)}function Ur(e){return JSON.stringify(e)}var Br=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=Mr(xr(a[0])||""),n=Mr(xr(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function Vr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function zr(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function qr(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Zr(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Wr(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(Hr(s)&&Hr(u)){if(!Wr(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function Hr(e){return null!==e&&"object"===typeof e}var Kr=function(){function e(){ht(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return vt(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],f=this.chain_[2],h=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(s=h^l&(f^h),u=1518500249):(s=l^f^h,u=1859775393):p<60?(s=l&f|h&(l|f),u=2400959708):(s=l^f^h,u=3395469782);var v=(c<<5|c>>>27)+s+d+u+n[p]&4294967295;d=h,h=f,f=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}();function Gr(e,t){var n=new Qr(e,t);return n.subscribe.bind(n)}var Qr=function(){function e(t,n){var r=this;ht(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return vt(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=Tt(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Yr),void 0===r.error&&(r.error=Yr),void 0===r.complete&&(r.complete=Yr);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function Yr(){}var $r=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Xr(e,t){return"".concat(e," failed: ").concat(t," argument ")}function Jr(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(Xr(e,t)+"must be a valid function.")}function ei(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(Xr(e,t)+"must be a valid context object.")}var ti=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function ni(e){return e&&e._delegate?e._delegate:e}var ri=function(){function e(t,n,r){ht(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return vt(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),ii="[DEFAULT]",ai=function(){function e(t,n){ht(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return vt(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Tr;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ii})}catch(c){}var t,n=Tt(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=(0,u.Z)(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ii;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(ft(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),ft(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ii;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ii;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Tt(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=(0,u.Z)(i.value,2),c=s[0],l=s[1];r===this.normalizeInstanceIdentifier(c)&&l.resolve(a)}}catch(f){o.e(f)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(FT){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===ii?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(FT){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ii;return this.component?this.component.multipleInstances?e:ii:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var oi,si,ui=function(){function e(t){ht(this,e),this.name=t,this.providers=new Map}return vt(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new ai(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),ci=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(si||(si={}));var li={debug:si.DEBUG,verbose:si.VERBOSE,info:si.INFO,warn:si.WARN,error:si.ERROR,silent:si.SILENT},fi=si.INFO,hi=(oi={},(0,hr.Z)(oi,si.DEBUG,"log"),(0,hr.Z)(oi,si.VERBOSE,"log"),(0,hr.Z)(oi,si.INFO,"info"),(0,hr.Z)(oi,si.WARN,"warn"),(0,hr.Z)(oi,si.ERROR,"error"),oi),di=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=hi[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},pi=function(){function e(t){ht(this,e),this.name=t,this._logLevel=fi,this._logHandler=di,this._userLogHandler=null,ci.push(this)}return vt(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in si))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?li[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,si.DEBUG].concat(t)),this._logHandler.apply(this,[this,si.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,si.VERBOSE].concat(t)),this._logHandler.apply(this,[this,si.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,si.INFO].concat(t)),this._logHandler.apply(this,[this,si.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,si.WARN].concat(t)),this._logHandler.apply(this,[this,si.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,si.ERROR].concat(t)),this._logHandler.apply(this,[this,si.ERROR].concat(t))}}]),e}();var vi,yi,mi=n(413),gi=function(e,t){return t.some((function(t){return e instanceof t}))};var ki=new WeakMap,bi=new WeakMap,_i=new WeakMap,wi=new WeakMap,xi=new WeakMap;var Si={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return bi.get(e);if("objectStoreNames"===t)return e.objectStoreNames||_i.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ii(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Ei(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yi||(yi=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Ti(this),n),Ii(ki.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ii(e.apply(Ti(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Ti(this),t].concat(r));return _i.set(a,t.sort?t.sort():[t]),Ii(a)}}function Ci(e){return"function"===typeof e?Ei(e):(e instanceof IDBTransaction&&function(e){if(!bi.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));bi.set(e,t)}}(e),gi(e,vi||(vi=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Si):e)}function Ii(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Ii(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&ki.set(t,e)})).catch((function(){})),xi.set(t,e),t}(e);if(wi.has(e))return wi.get(e);var t=Ci(e);return t!==e&&(wi.set(e,t),xi.set(t,e)),t}var Ti=function(e){return xi.get(e)};var Ni,Ai,Di=["get","getKey","getAll","getAllKeys","count"],Oi=["put","add","delete","clear"],Ri=new Map;function Pi(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(Ri.get(t))return Ri.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Oi.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Di.includes(n))){var a=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var a,s,u,c,l,f,h=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=this.transaction(t,i?"readwrite":"readonly"),u=s.store,c=h.length,l=new Array(c>1?c-1:0),f=1;f<c;f++)l[f-1]=h[f];return r&&(u=u.index(l.shift())),e.next=6,Promise.all([(a=u)[n].apply(a,l),i&&s.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return Ri.set(t,a),a}}}Si=function(e){return(0,mi.Z)((0,mi.Z)({},e),{},{get:function(t,n,r){return Pi(t,n)||e.get(t,n,r)},has:function(t,n){return!!Pi(t,n)||e.has(t,n)}})}(Si);var Li=function(){function e(t){ht(this,e),this.container=t}return vt(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var ji="@firebase/app",Fi="0.9.12",Mi=new pi("@firebase/app"),Ui="[DEFAULT]",Bi=(Ni={},(0,hr.Z)(Ni,ji,"fire-core"),(0,hr.Z)(Ni,"@firebase/app-compat","fire-core-compat"),(0,hr.Z)(Ni,"@firebase/analytics","fire-analytics"),(0,hr.Z)(Ni,"@firebase/analytics-compat","fire-analytics-compat"),(0,hr.Z)(Ni,"@firebase/app-check","fire-app-check"),(0,hr.Z)(Ni,"@firebase/app-check-compat","fire-app-check-compat"),(0,hr.Z)(Ni,"@firebase/auth","fire-auth"),(0,hr.Z)(Ni,"@firebase/auth-compat","fire-auth-compat"),(0,hr.Z)(Ni,"@firebase/database","fire-rtdb"),(0,hr.Z)(Ni,"@firebase/database-compat","fire-rtdb-compat"),(0,hr.Z)(Ni,"@firebase/functions","fire-fn"),(0,hr.Z)(Ni,"@firebase/functions-compat","fire-fn-compat"),(0,hr.Z)(Ni,"@firebase/installations","fire-iid"),(0,hr.Z)(Ni,"@firebase/installations-compat","fire-iid-compat"),(0,hr.Z)(Ni,"@firebase/messaging","fire-fcm"),(0,hr.Z)(Ni,"@firebase/messaging-compat","fire-fcm-compat"),(0,hr.Z)(Ni,"@firebase/performance","fire-perf"),(0,hr.Z)(Ni,"@firebase/performance-compat","fire-perf-compat"),(0,hr.Z)(Ni,"@firebase/remote-config","fire-rc"),(0,hr.Z)(Ni,"@firebase/remote-config-compat","fire-rc-compat"),(0,hr.Z)(Ni,"@firebase/storage","fire-gcs"),(0,hr.Z)(Ni,"@firebase/storage-compat","fire-gcs-compat"),(0,hr.Z)(Ni,"@firebase/firestore","fire-fst"),(0,hr.Z)(Ni,"@firebase/firestore-compat","fire-fst-compat"),(0,hr.Z)(Ni,"fire-js","fire-js"),(0,hr.Z)(Ni,"firebase","fire-js-all"),Ni),Vi=new Map,zi=new Map;function qi(e,t){try{e.container.addComponent(t)}catch(n){Mi.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Zi(e,t){e.container.addOrOverwriteComponent(t)}function Wi(e){var t=e.name;if(zi.has(t))return Mi.debug("There were multiple attempts to register component ".concat(t,".")),!1;zi.set(t,e);var n,r=Tt(Vi.values());try{for(r.s();!(n=r.n()).done;){qi(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function Hi(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ki(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ui;Hi(e,t).clearInstance(n)}function Gi(){zi.clear()}var Qi=(Ai={},(0,hr.Z)(Ai,"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),(0,hr.Z)(Ai,"bad-app-name","Illegal App name: '{$appName}"),(0,hr.Z)(Ai,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),(0,hr.Z)(Ai,"app-deleted","Firebase App named '{$appName}' already deleted"),(0,hr.Z)(Ai,"no-options","Need to provide options, when not being deployed to hosting via source."),(0,hr.Z)(Ai,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),(0,hr.Z)(Ai,"invalid-log-argument","First argument to `onLog` must be null or a function."),(0,hr.Z)(Ai,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),(0,hr.Z)(Ai,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),(0,hr.Z)(Ai,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),(0,hr.Z)(Ai,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),Ai),Yi=new jr("app","Firebase",Qi),$i=function(){function e(t,n,r){var i=this;ht(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ri("app",(function(){return i}),"PUBLIC"))}return vt(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Yi.create("app-deleted",{appName:this._name})}}]),e}(),Xi="9.22.2";function Ji(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:Ui,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw Yi.create("bad-app-name",{appName:String(i)});if(n||(n=Ir()),!n)throw Yi.create("no-options");var a=Vi.get(i);if(a){if(Wr(n,a.options)&&Wr(r,a.config))return a;throw Yi.create("duplicate-app",{appName:i})}var o,s=new ui(i),u=Tt(zi.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s.addComponent(c)}}catch(f){u.e(f)}finally{u.f()}var l=new $i(n,r,s);return Vi.set(i,l),l}function ea(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ui,t=Vi.get(e);if(!t&&e===Ui&&Ir())return Ji();if(!t)throw Yi.create("no-app",{appName:e});return t}function ta(){return Array.from(Vi.values())}function na(e){return ra.apply(this,arguments)}function ra(){return(ra=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!Vi.has(n)){e.next=6;break}return Vi.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ia(e,t,n){var r,i=null!==(r=Bi[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Mi.warn(s.join(" "))}Wi(new ri("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function aa(e,t){if(null!==e&&"function"!==typeof e)throw Yi.create("invalid-log-argument");!function(e,t){var n,r=Tt(ci);try{var i=function(){var r=n.value,i=null;t&&t.level&&(i=li[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var s=a.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==i&&void 0!==i?i:t.logLevel)&&e({level:si[n].toLowerCase(),message:s,args:a,type:t.name})}};for(r.s();!(n=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}(e,t)}function oa(e){var t;t=e,ci.forEach((function(e){e.setLogLevel(t)}))}var sa="firebase-heartbeat-database",ua=1,ca="firebase-heartbeat-store",la=null;function fa(){return la||(la=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Ii(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(Ii(s.result),e.oldVersion,e.newVersion,Ii(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(e){return a(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}(sa,ua,{upgrade:function(e,t){if(0===t)e.createObjectStore(ca)}}).catch((function(e){throw Yi.create("idb-open",{originalErrorMessage:e.message})}))),la}function ha(e){return da.apply(this,arguments)}function da(){return da=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fa();case 3:return n=e.sent,e.next=6,n.transaction(ca).objectStore(ca).get(ya(t));case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof Lr?Mi.warn(e.t0.message):(i=Yi.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Mi.warn(i.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),da.apply(this,arguments)}function pa(e,t){return va.apply(this,arguments)}function va(){return va=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fa();case 3:return r=e.sent,i=r.transaction(ca,"readwrite"),a=i.objectStore(ca),e.next=8,a.put(n,ya(t));case 8:return e.next=10,i.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Lr?Mi.warn(e.t0.message):(s=Yi.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Mi.warn(s.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),va.apply(this,arguments)}function ya(e){return"".concat(e.name,"!").concat(e.options.appId)}var ma=function(){function e(t){var n=this;ht(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new wa(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return vt(e,[{key:"triggerHeartbeat",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=ga(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=ga(),n=ka(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=wr(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function ga(){return(new Date).toISOString().substring(0,10)}function ka(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=Tt(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),xa(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),xa(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){if("break"===o())break}}catch(s){a.e(s)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var ba,_a,wa=function(){function e(t){ht(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return vt(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Pr()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(Qa){t(Qa)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,ha(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",pa(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",pa(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(ft(r.heartbeats),ft(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function xa(e){return wr(JSON.stringify({version:2,heartbeats:e})).length}ba="",Wi(new ri("platform-logger",(function(e){return new Li(e)}),"PRIVATE")),Wi(new ri("heartbeat",(function(e){return new ma(e)}),"PRIVATE")),ia(ji,Fi,ba),ia(ji,Fi,"esm2017"),ia("fire-js","");var Sa=function(){function e(t,n){var r=this;ht(this,e),this._delegate=t,this.firebase=n,qi(t,new ri("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return vt(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),na(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ui;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ui;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){qi(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){Zi(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),Ea=(_a={},(0,hr.Z)(_a,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),(0,hr.Z)(_a,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),_a),Ca=new jr("app-compat","Firebase",Ea);var Ia=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var i=Ji(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(Vr(n,i.name))return n[i.name];var a=new t(i,r);return n[i.name]=a,a},app:i,registerVersion:ia,setLogLevel:oa,onLog:aa,apps:null,SDK_VERSION:Xi,INTERNAL:{registerComponent:function(e){var n=e.name,a=n.replace("-compat","");if(Wi(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw Ca.create("invalid-app-argument",{appName:n});return e[a]()};void 0!==e.serviceProps&&Sr(o,e.serviceProps),r[a]=o,t.prototype[a]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!Vr(n,e=e||Ui))throw Ca.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),i.App=t,r}(Sa);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){Sr(n,e)},createSubscribe:Gr,ErrorFactory:jr,deepExtend:Sr}),n}(),Ta=new pi("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){Ta.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Na=self.firebase.SDK_VERSION;Na&&Na.indexOf("LITE")>=0&&Ta.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Aa=Ia;!function(e){ia("@firebase/app-compat","0.2.12",e)}();Aa.registerVersion("firebase","9.22.2","app-compat");var Da="@firebase/database",Oa="0.14.4",Ra="";function Pa(e){Ra=e}var La=function(){function e(t){ht(this,e),this.domStorage_=t,this.prefix_="firebase:"}return vt(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ur(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Mr(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),ja=function(){function e(){ht(this,e),this.cache_={},this.isInMemoryStorage=!0}return vt(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return Vr(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),Fa=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new La(t)}}catch(n){}return new ja},Ma=Fa("localStorage"),Ua=Fa("sessionStorage"),Ba=new pi("@firebase/database"),Va=function(){var e=1;return function(){return e++}}(),za=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,yr(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Kr;n.update(t);var r=n.digest();return kr.encodeByteArray(r)},qa=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?Ur(r):r,t+=" "}return t},Za=null,Wa=!0,Ha=function(e,t){yr(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Ba.logLevel=si.VERBOSE,Za=Ba.log.bind(Ba),t&&Ua.set("logging_enabled",!0)):"function"===typeof e?Za=e:(Za=null,Ua.remove("logging_enabled"))},Ka=function(){if(!0===Wa&&(Wa=!1,null===Za&&!0===Ua.get("logging_enabled")&&Ha(!0)),Za){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=qa.apply(null,t);Za(r)}},Ga=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ka.apply(void 0,[e].concat(n))}},Qa=function(){var e="FIREBASE INTERNAL ERROR: "+qa.apply(void 0,arguments);Ba.error(e)},Ya=function(){var e="FIREBASE FATAL ERROR: ".concat(qa.apply(void 0,arguments));throw Ba.error(e),new Error(e)},$a=function(){var e="FIREBASE WARNING: "+qa.apply(void 0,arguments);Ba.warn(e)},Xa=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ja="[MIN_NAME]",eo="[MAX_NAME]",to=function(e,t){if(e===t)return 0;if(e===Ja||t===eo)return-1;if(t===Ja||e===eo)return 1;var n=co(e),r=co(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},no=function(e,t){return e===t?0:e<t?-1:1},ro=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ur(t))},io=function e(t){if("object"!==typeof t||null===t)return Ur(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=Ur(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},ao=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function oo(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var so=function(e){yr(!Xa(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var uo=new RegExp("^-?(0*)\\d{1,10}$"),co=function(e){if(uo.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},lo=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw $a("Exception was thrown by user callback.",e),t}),Math.floor(0))}},fo=function(e,t){var n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n},ho=function(){function e(t,n){var r=this;ht(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return vt(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){$a('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),po=function(){function e(t,n,r){var i=this;ht(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return i.auth_=e}))}return vt(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(Ka("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$a(e)}}]),e}(),vo=function(){function e(t){ht(this,e),this.accessToken=t}return vt(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();vo.OWNER="owner";var yo="5",mo=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,go="ac",ko="websocket",bo="long_polling",_o=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];ht(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=u,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ma.get("host:"+t)||this._host}return vt(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ma.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function wo(e,t,n){var r;if(yr("string"===typeof t,"typeof type must == string"),yr("object"===typeof n,"typeof params must == object"),t===ko)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==bo)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return oo(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var xo=function(){function e(){ht(this,e),this.counters_={}}return vt(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Vr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return function(e){return Sr(void 0,e)}(this.counters_)}}]),e}(),So={},Eo={};function Co(e){var t=e.toString();return So[t]||(So[t]=new xo),So[t]}var Io=function(){function e(t){ht(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return vt(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&lo((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),To="start",No=function(){function e(t,n,r,i,a,o,s){var u=this;ht(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ga(t),this.stats_=Co(n),this.urlFn=function(e){return u.appCheckToken&&(e[go]=u.appCheckToken),wo(n,bo,e)}}return vt(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Io(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Rr()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Ao((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===To)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var e={};e[To]="t",e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=yo,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e[go]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&mo.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=Ur(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=_r(t),r=ao(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!Rr()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=Ur(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!Rr()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),Ao=function(){function e(t,n,r,i){if(ht(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Rr())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=Va(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11))a='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){Ka("frame writing exception"),s.stack&&Ka(s.stack),Ka(s)}}}return vt(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;Rr()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){Ka("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ka("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),Do=null;"undefined"!==typeof MozWebSocket?Do=MozWebSocket:"undefined"!==typeof WebSocket&&(Do=WebSocket);var Oo=function(){function e(t,n,r,i,a,o,s){ht(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ga(this.connId),this.stats_=Co(n),this.connURL=e.connectionURL_(n,o,s,i,r),this.nodeAdmin=n.nodeAdmin}return vt(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ma.set("previous_websocket_failure",!0);try{var r;if(Rr()){var i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(yo,"/").concat(Ra,"/").concat(process.platform,"/").concat(i),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new Do(this.connURL,[],r)}catch(u){this.log_("Error instantiating WebSocket.");var s=u.message||u.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){Ma.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Mr(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(yr(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=Ur(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=ao(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=yo,!Rr()&&"undefined"!==typeof location&&location.hostname&&mo.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a[go]=r),i&&(a.p=i),wo(e,ko,a)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==Do&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return Ma.isInMemoryStorage||!0===Ma.get("previous_websocket_failure")}}]),e}();Oo.responsesRequiredToBeHealthy=2,Oo.healthyTimeout=3e4;var Ro=function(){function e(t){ht(this,e),this.initTransports_(t)}return vt(e,[{key:"initTransports_",value:function(t){var n=Oo&&Oo.isAvailable(),r=n&&!Oo.previouslyFailed();if(t.webSocketOnly&&(n||$a("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Oo];else{var i,a=this.transports_=[],o=Tt(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var s=i.value;s&&s.isAvailable()&&a.push(s)}}catch(u){o.e(u)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[No,Oo]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();Ro.globalTransportInitialized_=!1;var Po=function(){function e(t,n,r,i,a,o,s,u,c,l){ht(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ga("c:"+this.id+":"),this.transportManager_=new Ro(n),this.log_("Connection created"),this.start_()}return vt(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=fo((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=ro("t",e),n=ro("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=ro("t",e),n=ro("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=ro("t",e);if("d"in e){var n=e.d;if("h"===t){var r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Qa("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Qa("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),yo!==n&&$a("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),fo((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fo((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ma.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),Lo=function(){function e(){ht(this,e)}return vt(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),jo=function(){function e(t){ht(this,e),this.allowedEvents_=t,this.listeners_={},yr(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return vt(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=ft(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){yr(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),Fo=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Dr()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return vt(n,[{key:"getInitialEvent",value:function(e){return yr("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(jo),Mo=32,Uo=768,Bo=function(){function e(t,n){if(ht(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return vt(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function Vo(){return new Bo("")}function zo(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function qo(e){return e.pieces_.length-e.pieceNum_}function Zo(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new Bo(e.pieces_,t)}function Wo(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Ho(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function Ko(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Bo(t,0)}function Go(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Bo)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new Bo(n,0)}function Qo(e){return e.pieceNum_>=e.pieces_.length}function Yo(e,t){var n=zo(e),r=zo(t);if(null===n)return t;if(n===r)return Yo(Zo(e),Zo(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function $o(e,t){for(var n=Ho(e,0),r=Ho(t,0),i=0;i<n.length&&i<r.length;i++){var a=to(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function Xo(e,t){if(qo(e)!==qo(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Jo(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(qo(e)>qo(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var es=vt((function e(t,n){ht(this,e),this.errorPrefix_=n,this.parts_=Ho(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=ti(this.parts_[r]);ts(this)}));function ts(e){if(e.byteLength_>Uo)throw new Error(e.errorPrefix_+"has a key path longer than "+Uo+" bytes ("+e.byteLength_+").");if(e.parts_.length>Mo)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mo+") or object contains a cycle "+ns(e))}function ns(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var rs=function(e){mt(n,e);var t=wt(n);function n(){var e,r,i;return ht(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(i="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(i="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return vt(n,[{key:"getInitialEvent",value:function(e){return yr("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(jo),is=1e3,as=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a,o,s,u,c){var l;if(ht(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=Ga("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=is,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!Rr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return rs.getInstance().on("visible",l.onVisible_,_t(l)),-1===e.host.indexOf("fblocal")&&Fo.getInstance().on("online",l.onOnline_,_t(l)),l}return vt(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Ur(i)),yr(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new Tr,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),yr(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),yr(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=Br(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=Br(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),yr(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+Ur(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Qa("Unrecognized action received from server: "+Ur(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;yr(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=is,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=is,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=is),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,r,i,a,s,c,l,f,h,d,p,v,y,m,g=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,c=!1,l=null,f=function(){l?l.close():(c=!0,i())},h=function(e){yr(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)},this.realtime_={close:f,sendRequest:h},d=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);case 19:p=e.sent,v=(0,u.Z)(p,2),y=v[0],m=v[1],c?Ka("getToken() completed but was canceled"):(Ka("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=m&&m.token,l=new Po(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,(function(e){$a(e+" ("+g.repoInfo_.toString()+")"),g.interrupt("server_kill")}),s)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),c||(this.repoInfo_.nodeAdmin&&$a(e.t0),f());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){Ka("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){Ka("Resuming connection for reason: "+e),delete this.interruptReasons_[e],qr(this.interruptReasons_)&&(this.reconnectDelay_=is,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return io(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new Bo(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){Ka("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){Ka("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=Tt(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=Tt(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={},t="js";Rr()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Ra.replace(/\./g,"-")]=1,Dr()?e["framework.cordova"]=1:"object"===typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=Fo.getInstance().currentlyOnline();return qr(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&Vr(e,"w")){var n=zr(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();$a("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),n}(Lo);as.nextPersistentConnectionId_=0,as.nextConnectionId_=0;var os,ss=function(){function e(t,n){ht(this,e),this.name=t,this.node=n}return vt(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),us=function(){function e(){ht(this,e)}return vt(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new ss(Ja,e),r=new ss(Ja,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return ss.MIN}}]),e}(),cs=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"compare",value:function(e,t){return to(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw mr("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return ss.MIN}},{key:"maxPost",value:function(){return new ss(eo,os)}},{key:"makePost",value:function(e,t){return yr("string"===typeof e,"KeyIndex indexValue must always be a string."),new ss(e,os)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return os},set:function(e){os=e}}]),n}(us),ls=new cs,fs=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;ht(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return vt(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),hs=function(){function e(t,n,r,i,a){ht(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:vs.EMPTY_NODE,this.right=null!=a?a:vs.EMPTY_NODE}return vt(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return vs.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return vs.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();hs.RED=!0,hs.BLACK=!1;var ds,ps=function(){function e(){ht(this,e)}return vt(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new hs(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),vs=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;ht(this,e),this.comparator_=t,this.root_=n}return vt(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,hs.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,hs.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new fs(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new fs(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new fs(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new fs(this.root_,null,this.comparator_,!0,e)}}]),e}();function ys(e,t){return to(e.name,t.name)}function ms(e,t){return to(e,t)}vs.EMPTY_NODE=new ps;var gs,ks,bs,_s=function(e){return"number"===typeof e?"number:"+so(e):"string:"+e},ws=function(e){if(e.isLeafNode()){var t=e.val();yr("string"===typeof t||"number"===typeof t||"object"===typeof t&&Vr(t,".sv"),"Priority must be a string or number.")}else yr(e===ds||e.isEmpty(),"priority of unexpected type.");yr(e===ds||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},xs=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;ht(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,yr(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ws(this.priorityNode_)}return vt(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return Qo(t)?this:".priority"===zo(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=zo(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(yr(".priority"!==r||1===qo(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(Zo(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+_s(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?so(this.value_):this.value_,this.lazyHash_=za(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(yr(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return yr(i>=0,"Unknown leaf type: "+n),yr(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return gs},set:function(e){gs=e}}]),e}();xs.VALUE_TYPE_ORDER=["object","boolean","number","string"];var Ss,Es,Cs=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?to(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return ss.MIN}},{key:"maxPost",value:function(){return new ss(eo,new xs("[PRIORITY-POST]",bs))}},{key:"makePost",value:function(e,t){var n=ks(e);return new ss(t,new xs("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(us),Is=new Cs,Ts=Math.log(2),Ns=function(){function e(t){ht(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/Ts,10)),this.current_=this.count-1;var r,i=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&i}return vt(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),As=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,s=i-r;if(0===s)return null;if(1===s)return a=e[r],o=n?n(a):a,new hs(o,a.node,hs.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return a=e[u],o=n?n(a):a,new hs(o,a.node,hs.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],f=n?n(l):l;u(new hs(f,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),f=Math.pow(2,t.count-(c+1));l?s(f,hs.BLACK):(s(f,hs.BLACK),s(f,hs.RED))}return a}(new Ns(e.length));return new vs(r||t,a)},Ds={},Os=function(){function e(t,n){ht(this,e),this.indexes_=t,this.indexSet_=n}return vt(e,[{key:"get",value:function(e){var t=zr(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof vs?t:null}},{key:"hasIndex",value:function(e){return Vr(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){yr(t!==ls,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(ss.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?As(i,t.getCompare()):Ds;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(Zr(this.indexes_,(function(e,i){var a=zr(r.indexSet_,i);if(yr(a,"Missing index implementation for "+i),e===Ds){if(a.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(ss.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),As(o,a.getCompare())}return Ds}var c=n.get(t.name),l=e;return c&&(l=l.remove(new ss(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(Zr(this.indexes_,(function(e){if(e===Ds)return e;var r=n.get(t.name);return r?e.remove(new ss(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return yr(Ds&&Is,"ChildrenNode.ts has not been loaded"),Ss=Ss||new e({".priority":Ds},{".priority":Is})}}]),e}(),Rs=function(){function e(t,n,r){ht(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&ws(this.priorityNode_),this.children_.isEmpty()&&yr(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return vt(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||Es}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Es:t}},{key:"getChild",value:function(e){var t=zo(e);return null===t?this:this.getImmediateChild(t).getChild(Zo(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(yr(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new ss(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?Es:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=zo(e);if(null===n)return t;yr(".priority"!==zo(e)||1===qo(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Zo(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Is,(function(o,s){n[o]=s.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!t&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+_s(this.getPriority().val())+":"),this.forEachChild(Is,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":za(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new ss(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new ss(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new ss(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,ss.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,ss.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ps?-1:0}},{key:"withIndex",value:function(t){if(t===ls||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===ls||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Is),r=t.getIterator(Is),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===ls?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return Es||(Es=new e(new vs(ms),null,Os.Default))}}]),e}();Rs.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var Ps=new(function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.call(this,new vs(ms),Rs.EMPTY_NODE,Os.Default)}return vt(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return Rs.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(Rs));Object.defineProperties(ss,{MIN:{value:new ss(Ja,Rs.EMPTY_NODE)},MAX:{value:new ss(eo,Ps)}}),cs.__EMPTY_NODE=Rs.EMPTY_NODE,xs.__childrenNodeConstructor=Rs,ds=Ps,function(e){bs=e}(Ps);var Ls=!0;function js(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return Rs.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),yr(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e)return new xs(e,js(t));if(e instanceof Array||!Ls){var n=Rs.EMPTY_NODE;return oo(e,(function(t,r){if(Vr(e,t)&&"."!==t.substring(0,1)){var i=js(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(js(t))}var r=[],i=!1;if(oo(e,(function(e,t){if("."!==e.substring(0,1)){var n=js(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new ss(e,n)))}})),0===r.length)return Rs.EMPTY_NODE;var a=As(r,ys,(function(e){return e.name}),ms);if(i){var o=As(r,Is.getCompare());return new Rs(a,js(t),new Os({".priority":o},{".priority":Is}))}return new Rs(a,js(t),Os.Default)}!function(e){ks=e}(js);var Fs=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).indexPath_=e,yr(!Qo(e)&&".priority"!==zo(e),"Can't create PathIndex with empty path or .priority key"),r}return vt(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?to(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=js(e),r=Rs.EMPTY_NODE.updateChild(this.indexPath_,n);return new ss(t,r)}},{key:"maxPost",value:function(){var e=Rs.EMPTY_NODE.updateChild(this.indexPath_,Ps);return new ss(eo,e)}},{key:"toString",value:function(){return Ho(this.indexPath_,0).join("/")}}]),n}(us),Ms=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?to(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return ss.MIN}},{key:"maxPost",value:function(){return ss.MAX}},{key:"makePost",value:function(e,t){var n=js(e);return new ss(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(us),Us=new Ms;function Bs(e){return{type:"value",snapshotNode:e}}function Vs(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function zs(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function qs(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var Zs=function(){function e(t){ht(this,e),this.index_=t}return vt(e,[{key:"updateChild",value:function(e,t,n,r,i,a){yr(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(zs(t,o)):yr(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Vs(t,n)):a.trackChildChange(qs(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Is,(function(e,r){t.hasChild(e)||n.trackChildChange(zs(e,r))})),t.isLeafNode()||t.forEachChild(Is,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(qs(t,r,i))}else n.trackChildChange(Vs(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?Rs.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),Ws=function(){function e(t){ht(this,e),this.indexedFilter_=new Zs(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return vt(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){var t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}},{key:"updateChild",value:function(e,t,n,r,i,a){return this.matches(new ss(t,n))||(n=Rs.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,a)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=Rs.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Rs.EMPTY_NODE);var i=this;return t.forEachChild(Is,(function(e,t){i.matches(new ss(e,t))||(r=r.updateImmediateChild(e,Rs.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),Hs=function(){function e(t){var n=this;ht(this,e),this.withinDirectionalStart=function(e){return n.reverse_?n.withinEndPost(e):n.withinStartPost(e)},this.withinDirectionalEnd=function(e){return n.reverse_?n.withinStartPost(e):n.withinEndPost(e)},this.withinStartPost=function(e){var t=n.index_.compare(n.rangedFilter_.getStartPost(),e);return n.startIsInclusive_?t<=0:t<0},this.withinEndPost=function(e){var t=n.index_.compare(e,n.rangedFilter_.getEndPost());return n.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Ws(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return vt(e,[{key:"updateChild",value:function(e,t,n,r,i,a){return this.rangedFilter_.matches(new ss(t,n))||(n=Rs.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,a):this.fullLimitUpdateChild_(e,t,n,i,a)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Rs.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=Rs.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(this.withinDirectionalStart(o)){if(!this.withinDirectionalEnd(o))break;r=r.updateImmediateChild(o.name,o.node),a++}}}else{var s;r=(r=t.withIndex(this.index_)).updatePriority(Rs.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);for(var u=0;s.hasNext();){var c=s.getNext();u<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?u++:r=r.updateImmediateChild(c.name,Rs.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var s=e;yr(s.numChildren()===this.limit_,"");var u=new ss(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var f=s.getImmediateChild(t),h=r.getChildAfterChild(this.index_,c,this.reverse_);null!=h&&(h.name===t||s.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);var d=null==h?1:a(h,u);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(qs(t,n,f)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(zs(t,f));var p=s.updateImmediateChild(t,Rs.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=i&&i.trackChildChange(Vs(h.name,h.node)),p.updateImmediateChild(h.name,h.node)):p}return n.isEmpty()?e:l&&a(c,u)>=0?(null!=i&&(i.trackChildChange(zs(c.name,c.node)),i.trackChildChange(Vs(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,Rs.EMPTY_NODE)):e}}]),e}(),Ks=function(){function e(){ht(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Is}return vt(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return yr(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return yr(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ja}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return yr(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return yr(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:eo}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return yr(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Is}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function Gs(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Qs(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ys(e,t){var n=e.copy();return n.index_=t,n}function $s(e){var t,n={};if(e.isDefault())return n;if(e.index_===Is?t="$priority":e.index_===Us?t="$value":e.index_===ls?t="$key":(yr(e.index_ instanceof Fs,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Ur(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=Ur(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+Ur(e.indexStartName_))}if(e.endSet_){var i=e.endBeforeSet_?"endBefore":"endAt";n[i]=Ur(e.indexEndValue_),e.endNameSet_&&(n[i]+=","+Ur(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function Xs(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Is&&(t.i=e.index_.toString()),t}var Js=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a){var o;return ht(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=Ga("p:rest:"),o.listens_={},o}return vt(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=$s(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),zr(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=$s(e._queryParams),r=e._path.toString(),i=new Tr;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=(0,u.Z)(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var c=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+function(e){for(var t=[],n=function(){var e=(0,u.Z)(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}(n);t.log_("Sending REST request for "+c);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(r&&4===l.readyState){t.log_("REST Response for "+c+" received. status:",l.status,"response:",l.responseText);var e=null;if(l.status>=200&&l.status<300){try{e=Mr(l.responseText)}catch(n){$a("Failed to parse JSON response for "+c+": "+l.responseText)}r(null,e)}else 401!==l.status&&404!==l.status&&$a("Got unsuccessful REST response for "+c+" Status: "+l.status),r(l.status);r=null}},l.open("GET",c,!0),l.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(yr(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(Lo),eu=function(){function e(){ht(this,e),this.rootNode_=Rs.EMPTY_NODE}return vt(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function tu(){return{value:null,children:new Map}}function nu(e,t,n){if(Qo(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=zo(t);e.children.has(r)||e.children.set(r,tu()),nu(e.children.get(r),t=Zo(t),n)}}function ru(e,t){if(Qo(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Is,(function(t,n){nu(e,new Bo(t),n)})),ru(e,t)}if(e.children.size>0){var r=zo(t);if(t=Zo(t),e.children.has(r))ru(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function iu(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){iu(r,new Bo(t.toString()+"/"+e),n)}))}var au,ou=function(){function e(t){ht(this,e),this.collection_=t,this.last_=null}return vt(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&oo(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),su=function(){function e(t,n){ht(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new ou(t);var r=1e4+2e4*Math.random();fo(this.reportStats_.bind(this),Math.floor(r))}return vt(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;oo(t,(function(t,i){i>0&&Vr(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),fo(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function uu(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(au||(au={}));var cu,lu=function(){function e(t,n,r){ht(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=au.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return vt(e,[{key:"operationForChild",value:function(t){if(Qo(this.path)){if(null!=this.affectedTree.value)return yr(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Bo(t));return new e(Vo(),n,this.revert)}return yr(zo(this.path)===t,"operationForChild called for unrelated child."),new e(Zo(this.path),this.affectedTree,this.revert)}}]),e}(),fu=function(){function e(t,n){ht(this,e),this.source=t,this.path=n,this.type=au.LISTEN_COMPLETE}return vt(e,[{key:"operationForChild",value:function(t){return Qo(this.path)?new e(this.source,Vo()):new e(this.source,Zo(this.path))}}]),e}(),hu=function(){function e(t,n,r){ht(this,e),this.source=t,this.path=n,this.snap=r,this.type=au.OVERWRITE}return vt(e,[{key:"operationForChild",value:function(t){return Qo(this.path)?new e(this.source,Vo(),this.snap.getImmediateChild(t)):new e(this.source,Zo(this.path),this.snap)}}]),e}(),du=function(){function e(t,n,r){ht(this,e),this.source=t,this.path=n,this.children=r,this.type=au.MERGE}return vt(e,[{key:"operationForChild",value:function(t){if(Qo(this.path)){var n=this.children.subtree(new Bo(t));return n.isEmpty()?null:n.value?new hu(this.source,Vo(),n.value):new e(this.source,Vo(),n)}return yr(zo(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,Zo(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),pu=function(){function e(t,n,r){ht(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return vt(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(Qo(e))return this.isFullyInitialized()&&!this.filtered_;var t=zo(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),vu=vt((function e(t){ht(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()}));function yu(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw mr("Should only compare child_ events.");var r=new ss(t.childName,t.snapshotNode),i=new ss(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function mu(e,t){return{eventCache:e,serverCache:t}}function gu(e,t,n,r){return mu(new pu(t,n,r),e.serverCache)}function ku(e,t,n,r){return mu(e.eventCache,new pu(t,n,r))}function bu(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function _u(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var wu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(cu||(cu=new vs(no)),cu);ht(this,e),this.value=t,this.children=n}return vt(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:Vo(),value:this.value};if(Qo(e))return null;var n=zo(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Zo(e),t);return null!=i?{path:Go(new Bo(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(Qo(t))return this;var n=zo(t),r=this.children.get(n);return null!==r?r.subtree(Zo(t)):new e(null)}},{key:"set",value:function(t,n){if(Qo(t))return new e(n,this.children);var r=zo(t),i=(this.children.get(r)||new e(null)).set(Zo(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(Qo(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=zo(t),r=this.children.get(n);if(r){var i,a=r.remove(Zo(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(Qo(e))return this.value;var t=zo(e),n=this.children.get(t);return n?n.get(Zo(e)):null}},{key:"setTree",value:function(t,n){if(Qo(t))return n;var r,i=zo(t),a=(this.children.get(i)||new e(null)).setTree(Zo(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(Vo(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Go(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,Vo(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Qo(e))return null;var i=zo(e),a=this.children.get(i);return a?a.findOnPath_(Zo(e),Go(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,Vo(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(Qo(t))return this;this.value&&r(n,this.value);var i=zo(t),a=this.children.get(i);return a?a.foreachOnPath_(Zo(t),Go(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(Vo(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Go(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return oo(t,(function(e,t){n=n.set(new Bo(e),t)})),n}}]),e}(),xu=function(){function e(t){ht(this,e),this.writeTree_=t}return vt(e,null,[{key:"empty",value:function(){return new e(new wu(null))}}]),e}();function Su(e,t,n){if(Qo(t))return new xu(new wu(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=Yo(i,t);return a=a.updateChild(o,n),new xu(e.writeTree_.set(i,a))}var s=new wu(n),u=e.writeTree_.setTree(t,s);return new xu(u)}function Eu(e,t,n){var r=e;return oo(n,(function(e,n){r=Su(r,Go(t,e),n)})),r}function Cu(e,t){if(Qo(t))return xu.empty();var n=e.writeTree_.setTree(t,new wu(null));return new xu(n)}function Iu(e,t){return null!=Tu(e,t)}function Tu(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Yo(n.path,t)):null}function Nu(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Is,(function(e,n){t.push(new ss(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new ss(e,n.value))})),t}function Au(e,t){if(Qo(t))return e;var n=Tu(e,t);return new xu(null!=n?new wu(n):e.writeTree_.subtree(t))}function Du(e){return e.writeTree_.isEmpty()}function Ou(e,t){return Ru(Vo(),e.writeTree_,t)}function Ru(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(yr(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ru(Go(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Go(e,".priority"),r)),n}function Pu(e,t){return Ku(t,e)}function Lu(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));yr(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&ju(s,r.path)?i=!1:Jo(r.path,s.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=Mu(e.allWrites,Fu,Vo()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Cu(e.visibleWrites,r.path):oo(r.children,(function(t){e.visibleWrites=Cu(e.visibleWrites,Go(r.path,t))}));return!0}return!1}function ju(e,t){if(e.snap)return Jo(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Jo(Go(e.path,n),t))return!0;return!1}function Fu(e){return e.visible}function Mu(e,t,n){for(var r=xu.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)Jo(n,o)?r=Su(r,s=Yo(n,o),a.snap):Jo(o,n)&&(s=Yo(o,n),r=Su(r,Vo(),a.snap.getChild(s)));else{if(!a.children)throw mr("WriteRecord should have .snap or .children");if(Jo(n,o))r=Eu(r,s=Yo(n,o),a.children);else if(Jo(o,n))if(Qo(s=Yo(o,n)))r=Eu(r,Vo(),a.children);else{var u=zr(a.children,zo(s));if(u){var c=u.getChild(Zo(s));r=Su(r,Vo(),c)}}}}}return r}function Uu(e,t,n,r,i){if(r||i){var a=Au(e.visibleWrites,t);if(!i&&Du(a))return n;if(i||null!=n||Iu(a,Vo())){return Ou(Mu(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Jo(e.path,t)||Jo(t,e.path))}),t),n||Rs.EMPTY_NODE)}return null}var o=Tu(e.visibleWrites,t);if(null!=o)return o;var s=Au(e.visibleWrites,t);return Du(s)?n:null!=n||Iu(s,Vo())?Ou(s,n||Rs.EMPTY_NODE):null}function Bu(e,t,n,r){return Uu(e.writeTree,e.treePath,t,n,r)}function Vu(e,t){return function(e,t,n){var r=Rs.EMPTY_NODE,i=Tu(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Is,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=Au(e.visibleWrites,t);return n.forEachChild(Is,(function(e,t){var n=Ou(Au(a,new Bo(e)),t);r=r.updateImmediateChild(e,n)})),Nu(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Nu(Au(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function zu(e,t,n,r){return function(e,t,n,r,i){yr(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Go(t,n);if(Iu(e.visibleWrites,a))return null;var o=Au(e.visibleWrites,a);return Du(o)?i.getChild(n):Ou(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function qu(e,t){return function(e,t){return Tu(e.visibleWrites,t)}(e.writeTree,Go(e.treePath,t))}function Zu(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=Au(e.visibleWrites,t),c=Tu(u,Vo());if(null!=c)s=c;else{if(null==n)return[];s=Ou(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],f=o.getCompare(),h=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=h.getNext();d&&l.length<i;)0!==f(d,r)&&l.push(d),d=h.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function Wu(e,t,n){return function(e,t,n,r){var i=Go(t,n),a=Tu(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?Ou(Au(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Hu(e,t){return Ku(Go(e.treePath,t),e.writeTree)}function Ku(e,t){return{treePath:e,writeTree:t}}var Gu=function(){function e(){ht(this,e),this.changeMap=new Map}return vt(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;yr("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),yr(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,qs(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,zs(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Vs(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw mr("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,qs(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),Qu=new(function(){function e(){ht(this,e)}return vt(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),Yu=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;ht(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return vt(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new pu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Wu(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:_u(this.viewCache_),i=Zu(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();function $u(e,t,n,r,i){var a,o,s=new Gu;if(n.type===au.OVERWRITE){var u=n;u.source.fromUser?a=ec(e,t,u.path,u.snap,r,i,s):(yr(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!Qo(u.path),a=Ju(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===au.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach((function(r,u){var c=Go(n,r);tc(t,zo(c))&&(s=ec(e,s,c,u,i,a,o))})),r.foreach((function(r,u){var c=Go(n,r);tc(t,zo(c))||(s=ec(e,s,c,u,i,a,o))})),s}(e,t,c.path,c.children,r,i,s):(yr(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=rc(e,t,c.path,c.children,r,i,o,s))}else if(n.type===au.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=qu(r,n))return t;var s,u=new Yu(r,t,i),c=t.eventCache.getNode();if(Qo(n)||".priority"===zo(n)){var l;if(t.serverCache.isFullyInitialized())l=Bu(r,_u(t));else{var f=t.serverCache.getNode();yr(f instanceof Rs,"serverChildren would be complete if leaf node"),l=Vu(r,f)}s=e.filter.updateFullNode(c,l,a)}else{var h=zo(n),d=Wu(r,h,t.serverCache);null==d&&t.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),(s=null!=d?e.filter.updateChild(c,h,d,Zo(n),u,a):t.eventCache.getNode().hasChild(h)?e.filter.updateChild(c,h,Rs.EMPTY_NODE,Zo(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Bu(r,_u(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a))}return o=t.serverCache.isFullyInitialized()||null!=qu(r,Vo()),gu(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=qu(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(Qo(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Ju(e,t,n,u.getNode().getChild(n),i,a,s,o);if(Qo(n)){var c=new wu(null);return u.getNode().forEachChild(ls,(function(e,t){c=c.set(new Bo(e),t)})),rc(e,t,n,c,i,a,s,o)}return t}var l=new wu(null);return r.foreach((function(e,t){var r=Go(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),rc(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==au.LISTEN_COMPLETE)throw mr("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=ku(t,a.getNode(),a.isFullyInitialized()||Qo(n),a.isFiltered());return Xu(e,o,n,r,Qu,i)}(e,t,n.path,r,s)}var f=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=bu(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(Bs(bu(t)))}}(t,a,f),{viewCache:a,changes:f}}function Xu(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=qu(r,n))return t;if(Qo(n))if(yr(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=_u(t),l=Vu(r,c instanceof Rs?c:Rs.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var f=Bu(r,_u(t));o=e.filter.updateFullNode(t.eventCache.getNode(),f,a)}else{var h=zo(n);if(".priority"===h){yr(1===qo(n),"Can't have a priority with additional path components");var d=u.getNode(),p=zu(r,n,d,s=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):u.getNode()}else{var v,y=Zo(n);if(u.isCompleteForChild(h)){s=t.serverCache.getNode();var m=zu(r,n,u.getNode(),s);v=null!=m?u.getNode().getImmediateChild(h).updateChild(y,m):u.getNode().getImmediateChild(h)}else v=Wu(r,h,t.serverCache);o=null!=v?e.filter.updateChild(u.getNode(),h,v,y,i,a):u.getNode()}}return gu(t,o,u.isFullyInitialized()||Qo(n),e.filter.filtersNodes())}function Ju(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(Qo(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{var h=zo(n);if(!c.isCompleteForPath(n)&&qo(n)>1)return t;var d=Zo(n),p=c.getNode().getImmediateChild(h).updateChild(d,r);u=".priority"===h?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),h,p,d,Qu,null)}var v=ku(t,u,c.isFullyInitialized()||Qo(n),l.filtersNodes());return Xu(e,v,n,i,new Yu(i,v,a),s)}function ec(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new Yu(i,t,a);if(Qo(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=gu(t,u,!0,e.filter.filtersNodes());else{var f=zo(n);if(".priority"===f)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=gu(t,u,c.isFullyInitialized(),c.isFiltered());else{var h,d=Zo(n),p=c.getNode().getImmediateChild(f);if(Qo(d))h=r;else{var v=l.getCompleteChild(f);h=null!=v?".priority"===Wo(d)&&v.getChild(Ko(d)).isEmpty()?v:v.updateChild(d,r):Rs.EMPTY_NODE}if(p.equals(h))s=t;else s=gu(t,e.filter.updateChild(c.getNode(),f,h,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function tc(e,t){return e.eventCache.isCompleteForChild(t)}function nc(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function rc(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=Qo(n)?r:new wu(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=nc(0,t.serverCache.getNode().getImmediateChild(n),r);c=Ju(e,c,new Bo(n),u,i,a,o,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!u){var f=nc(0,t.serverCache.getNode().getImmediateChild(n),r);c=Ju(e,c,new Bo(n),f,i,a,o,s)}})),c}var ic,ac=function(){function e(t,n){ht(this,e),this.query_=t,this.eventRegistrations_=[];var r,i=this.query_._queryParams,a=new Zs(i.getIndex()),o=(r=i).loadsAllData()?new Zs(r.getIndex()):r.hasLimit()?new Hs(r):new Ws(r);this.processor_=function(e){return{filter:e}}(o);var s=n.serverCache,u=n.eventCache,c=a.updateFullNode(Rs.EMPTY_NODE,s.getNode(),null),l=o.updateFullNode(Rs.EMPTY_NODE,u.getNode(),null),f=new pu(c,s.isFullyInitialized(),a.filtersNodes()),h=new pu(l,u.isFullyInitialized(),o.filtersNodes());this.viewCache_=mu(h,f),this.eventGenerator_=new vu(this.query_)}return vt(e,[{key:"query",get:function(){return this.query_}}]),e}();function oc(e,t){var n=_u(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Qo(t)&&!n.getImmediateChild(zo(t)).isEmpty())?n.getChild(t):null}function sc(e){return 0===e.eventRegistrations_.length}function uc(e,t,n){var r=[];if(n){yr(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],o=0;o<e.eventRegistrations_.length;++o){var s=e.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(o+1));break}}else a.push(s)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function cc(e,t,n,r){t.type===au.MERGE&&null!==t.source.queryId&&(yr(_u(e.viewCache_),"We should always have a full cache before handling merges"),yr(bu(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,s=$u(e.processor_,o,t,n,r);return i=e.processor_,a=s.viewCache,yr(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),yr(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),yr(s.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,lc(e,s.changes,s.viewCache.eventCache.getNode(),null)}function lc(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),yu(e,i,"child_removed",t,r,n),yu(e,i,"child_added",t,r,n),yu(e,i,"child_moved",a,r,n),yu(e,i,"child_changed",t,r,n),yu(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var fc,hc=vt((function e(){ht(this,e),this.views=new Map}));function dc(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return yr(null!=a,"SyncTree gave us an op for an invalid query."),cc(a,t,n,r)}var o,s=[],u=Tt(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(cc(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function pc(e,t,n,r,i){var a=t._queryIdentifier,o=e.views.get(a);if(!o){var s=Bu(n,i?r:null),u=!1;s?u=!0:r instanceof Rs?(s=Vu(n,r),u=!1):(s=Rs.EMPTY_NODE,u=!1);var c=mu(new pu(s,u,!1),new pu(r,i,!1));return new ac(t,c)}return o}function vc(e,t,n,r,i,a){var o=pc(e,t,r,i,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Is,(function(e,t){r.push(Vs(e,t))})),n.isFullyInitialized()&&r.push(Bs(n.getNode())),lc(e,r,n.getNode(),t)}(o,n)}function yc(e,t,n,r){var i=t._queryIdentifier,a=[],o=[],s=_c(e);if("default"===i){var c,l=Tt(e.views.entries());try{for(l.s();!(c=l.n()).done;){var f=(0,u.Z)(c.value,2),h=f[0],d=f[1];o=o.concat(uc(d,n,r)),sc(d)&&(e.views.delete(h),d.query._queryParams.loadsAllData()||a.push(d.query))}}catch(v){l.e(v)}finally{l.f()}}else{var p=e.views.get(i);p&&(o=o.concat(uc(p,n,r)),sc(p)&&(e.views.delete(i),p.query._queryParams.loadsAllData()||a.push(p.query)))}return s&&!_c(e)&&a.push(new(yr(ic,"Reference.ts has not been loaded"),ic)(t._repo,t._path)),{removed:a,events:o}}function mc(e){var t,n=[],r=Tt(e.views.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.query._queryParams.loadsAllData()||n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}function gc(e,t){var n,r=null,i=Tt(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||oc(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}function kc(e,t){if(t._queryParams.loadsAllData())return wc(e);var n=t._queryIdentifier;return e.views.get(n)}function bc(e,t){return null!=kc(e,t)}function _c(e){return null!=wc(e)}function wc(e){var t,n=Tt(e.views.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.query._queryParams.loadsAllData())return r}}catch(i){n.e(i)}finally{n.f()}return null}var xc=1,Sc=vt((function e(t){ht(this,e),this.listenProvider_=t,this.syncPointTree_=new wu(null),this.pendingWriteTree_={visibleWrites:xu.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function Ec(e,t,n,r,i){return function(e,t,n,r,i){yr(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Su(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Pc(e,new hu({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Cc(e,t,n,r){!function(e,t,n,r){yr(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Eu(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=wu.fromObject(n);return Pc(e,new du({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Ic(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Lu(e.pendingWriteTree_,t)){var i=new wu(null);return null!=r.snap?i=i.set(Vo(),!0):oo(r.children,(function(e){i=i.set(new Bo(e),!0)})),Pc(e,new lu(r.path,i,n))}return[]}function Tc(e,t,n){return Pc(e,new hu({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Nc(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t._path,o=e.syncPointTree_.get(a),s=[];if(o&&("default"===t._queryIdentifier||bc(o,t))){var u=yc(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(a));var c=u.removed;if(s=u.events,!i){var l=-1!==c.findIndex((function(e){return e._queryParams.loadsAllData()})),f=e.syncPointTree_.findOnPath(a,(function(e,t){return _c(t)}));if(l&&!f){var h=e.syncPointTree_.subtree(a);if(!h.isEmpty())for(var d=function(e){return e.fold((function(e,t,n){if(t&&_c(t))return[wc(t)];var r=[];return t&&(r=mc(t)),oo(n,(function(e,t){r=r.concat(t)})),r}))}(h),p=0;p<d.length;++p){var v=d[p],y=v.query,m=Fc(e,v);e.listenProvider_.startListening(qc(y),Mc(e,y),m.hashFn,m.onComplete)}}if(!f&&c.length>0&&!r)if(l){e.listenProvider_.stopListening(qc(t),null)}else c.forEach((function(t){var n=e.queryToTagMap.get(Uc(t));e.listenProvider_.stopListening(qc(t),n)}))}!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=Uc(r),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}(e,c)}return s}function Ac(e,t,n,r){var i=Bc(e,r);if(null!=i){var a=Vc(i),o=a.path,s=a.queryId,u=Yo(o,t);return zc(e,o,new hu(uu(s),u,n))}return[]}function Dc(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t._path,a=null,o=!1;e.syncPointTree_.foreachOnPath(i,(function(e,t){var n=Yo(e,i);a=a||gc(t,n),o=o||_c(t)}));var s,u=e.syncPointTree_.get(i);(u?(o=o||_c(u),a=a||gc(u,Vo())):(u=new hc,e.syncPointTree_=e.syncPointTree_.set(i,u)),null!=a)?s=!0:(s=!1,a=Rs.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((function(e,t){var n=gc(t,Vo());n&&(a=a.updateImmediateChild(e,n))})));var c=bc(u,t);if(!c&&!t._queryParams.loadsAllData()){var l=Uc(t);yr(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var f=xc++;e.queryToTagMap.set(l,f),e.tagToQueryMap.set(f,l)}var h=vc(u,t,n,Pu(e.pendingWriteTree_,i),a,s);if(!c&&!o&&!r){var d=kc(u,t);h=h.concat(function(e,t,n){var r=t._path,i=Mc(e,t),a=Fc(e,n),o=e.listenProvider_.startListening(qc(t),i,a.hashFn,a.onComplete),s=e.syncPointTree_.subtree(r);if(i)yr(!_c(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(e,t,n){if(!Qo(e)&&t&&_c(t))return[wc(t).query];var r=[];return t&&(r=r.concat(mc(t).map((function(e){return e.query})))),oo(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<u.length;++c){var l=u[c];e.listenProvider_.stopListening(qc(l),Mc(e,l))}return o}(e,t,d))}return h}function Oc(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=gc(n,Yo(e,t));if(r)return r}));return Uu(r,t,i,n,!0)}function Rc(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=Yo(e,n);r=r||gc(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||gc(i,Vo()):(i=new hc,e.syncPointTree_=e.syncPointTree_.set(n,i));var a=null!=r,o=a?new pu(r,!0,!1):null;return function(e){return bu(e.viewCache_)}(pc(i,t,Pu(e.pendingWriteTree_,t._path),a?o.getNode():Rs.EMPTY_NODE,a))}function Pc(e,t){return Lc(t,e.syncPointTree_,null,Pu(e.pendingWriteTree_,Vo()))}function Lc(e,t,n,r){if(Qo(e.path))return jc(e,t,n,r);var i=t.get(Vo());null==n&&null!=i&&(n=gc(i,Vo()));var a=[],o=zo(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=Hu(r,o);a=a.concat(Lc(s,u,c,l))}return i&&(a=a.concat(dc(i,e,r,n))),a}function jc(e,t,n,r){var i=t.get(Vo());null==n&&null!=i&&(n=gc(i,Vo()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,s=Hu(r,t),u=e.operationForChild(t);u&&(a=a.concat(jc(u,i,o,s)))})),i&&(a=a.concat(dc(i,e,r,n))),a}function Fc(e,t){var n=t.query,r=Mc(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||Rs.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=Bc(e,n);if(r){var i=Vc(r),a=i.path,o=i.queryId,s=Yo(a,t);return zc(e,a,new fu(uu(o),s))}return[]}(e,n._path,r):function(e,t){return Pc(e,new fu({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Nc(e,n,null,i)}}}function Mc(e,t){var n=Uc(t);return e.queryToTagMap.get(n)}function Uc(e){return e._path.toString()+"$"+e._queryIdentifier}function Bc(e,t){return e.tagToQueryMap.get(t)}function Vc(e){var t=e.indexOf("$");return yr(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Bo(e.substr(0,t))}}function zc(e,t,n){var r=e.syncPointTree_.get(t);return yr(r,"Missing sync point for query tag that we're tracking"),dc(r,n,Pu(e.pendingWriteTree_,t),null)}function qc(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(yr(fc,"Reference.ts has not been loaded"),fc)(e._repo,e._path):e}var Zc=function(){function e(t){ht(this,e),this.node_=t}return vt(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),Wc=function(){function e(t,n){ht(this,e),this.syncTree_=t,this.path_=n}return vt(e,[{key:"getImmediateChild",value:function(t){var n=Go(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return Oc(this.syncTree_,this.path_)}}]),e}(),Hc=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Kc=function(e,t,n){return e&&"object"===typeof e?(yr(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?Gc(e[".sv"],t,n):"object"===typeof e[".sv"]?Qc(e[".sv"],t):void yr(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Gc=function(e,t,n){if("timestamp"===e)return n.timestamp;yr(!1,"Unexpected server value: "+e)},Qc=function(e,t,n){e.hasOwnProperty("increment")||yr(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&yr(!1,"Unexpected increment value: "+r);var i=t.node();if(yr(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},Yc=function(e,t,n,r){return Xc(t,new Wc(n,e),r)},$c=function(e,t,n){return Xc(e,new Zc(t),n)};function Xc(e,t,n){var r,i=e.getPriority().val(),a=Kc(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=Kc(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new xs(s,js(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new xs(a))),u.forEachChild(Is,(function(e,i){var a=Xc(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}var Jc=vt((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};ht(this,e),this.name=t,this.parent=n,this.node=r}));function el(e,t){for(var n=t instanceof Bo?t:new Bo(t),r=e,i=zo(n);null!==i;){var a=zr(r.node.children,i)||{children:{},childCount:0};r=new Jc(i,r,a),i=zo(n=Zo(n))}return r}function tl(e){return e.node.value}function nl(e,t){e.node.value=t,sl(e)}function rl(e){return e.node.childCount>0}function il(e,t){oo(e.node.children,(function(n,r){t(new Jc(n,e,r))}))}function al(e,t,n,r){n&&!r&&t(e),il(e,(function(e){al(e,t,!0,r)})),n&&r&&t(e)}function ol(e){return new Bo(null===e.parent?e.name:ol(e.parent)+"/"+e.name)}function sl(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===tl(e)&&!rl(e)}(n),i=Vr(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,sl(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,sl(e))}(e.parent,e.name,e)}var ul=/[\[\].#$\/\u0000-\u001F\u007F]/,cl=/[\[\].#$\u0000-\u001F\u007F]/,ll=10485760,fl=function(e){return"string"===typeof e&&0!==e.length&&!ul.test(e)},hl=function(e){return"string"===typeof e&&0!==e.length&&!cl.test(e)},dl=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!Xa(e)||e&&"object"===typeof e&&Vr(e,".sv")},pl=function(e,t,n,r){r&&void 0===t||vl(Xr(e,"value"),t,n)},vl=function e(t,n,r){var i=r instanceof Bo?new es(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+ns(i));if("function"===typeof n)throw new Error(t+"contains a function "+ns(i)+" with contents = "+n.toString());if(Xa(n))throw new Error(t+"contains "+n.toString()+" "+ns(i));if("string"===typeof n&&n.length>ll/3&&ti(n)>ll)throw new Error(t+"contains a string greater than "+ll+" utf8 bytes "+ns(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,o=!1;if(oo(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!fl(n)))throw new Error(t+" contains an invalid key ("+n+") "+ns(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=ti(t),ts(e)}(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=ti(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&o)throw new Error(t+' contains ".value" child '+ns(i)+" in addition to actual children.")}},yl=function(e,t,n,r){if(!r||void 0!==t){var i=Xr(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];oo(t,(function(e,t){var r=new Bo(e);if(vl(i,t,Go(n,r)),".priority"===Wo(r)&&!dl(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=Ho(r=t[n]),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!fl(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort($o);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&Jo(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}},ml=function(e,t,n){if(!n||void 0!==t){if(Xa(t))throw new Error(Xr(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!dl(t))throw new Error(Xr(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},gl=function(e,t,n,r){if((!r||void 0!==n)&&!fl(n))throw new Error(Xr(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},kl=function(e,t,n,r){if((!r||void 0!==n)&&!hl(n))throw new Error(Xr(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},bl=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),kl(e,t,n,r)},_l=function(e,t){if(".info"===zo(t))throw new Error(e+" failed = Can't modify data under /.info/")},wl=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!fl(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),hl(e)}(n))throw new Error(Xr(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},xl=vt((function e(){ht(this,e),this.eventLists_=[],this.recursionDepth_=0}));function Sl(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||Xo(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function El(e,t,n){Sl(e,n),Il(e,(function(e){return Xo(e,t)}))}function Cl(e,t,n){Sl(e,n),Il(e,(function(e){return Jo(e,t)||Jo(t,e)}))}function Il(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(Tl(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Tl(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();Za&&Ka("event: "+n.toString()),lo(r)}}}var Nl="repo_interrupt",Al=25,Dl=function(){function e(t,n,r,i){ht(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tu(),this.transactionQueueTree_=new Jc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return vt(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function Ol(e,t,n){if(e.stats_=Co(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Js(e.repoInfo_,(function(t,n,r,i){Ll(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return jl(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ur(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new as(e.repoInfo_,t,(function(t,n,r,i){Ll(e,t,n,r,i)}),(function(t){jl(e,t)}),(function(t){!function(e,t){oo(t,(function(t,n){Fl(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return Eo[n]||(Eo[n]=t()),Eo[n]}(e.repoInfo_,(function(){return new su(e.stats_,e.server_)})),e.infoData_=new eu,e.infoSyncTree_=new Sc({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=Tc(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),Fl(e,"connected",!1),e.serverSyncTree_=new Sc({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);Cl(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function Rl(e){var t=e.infoData_.getNode(new Bo(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Pl(e){return Hc({timestamp:Rl(e)})}function Ll(e,t,n,r,i){e.dataUpdateCount++;var a=new Bo(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=Zr(n,(function(e){return js(e)}));o=function(e,t,n,r){var i=Bc(e,r);if(i){var a=Vc(i),o=a.path,s=a.queryId,u=Yo(o,t),c=wu.fromObject(n);return zc(e,o,new du(uu(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=js(n);o=Ac(e.serverSyncTree_,a,u,i)}else if(r){var c=Zr(n,(function(e){return js(e)}));o=function(e,t,n){var r=wu.fromObject(n);return Pc(e,new du({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=js(n);o=Tc(e.serverSyncTree_,a,l)}var f=a;o.length>0&&(f=Gl(e,a)),Cl(e.eventQueue_,f,o)}function jl(e,t){Fl(e,"connected",t),!1===t&&function(e){Zl(e,"onDisconnectEvents");var t=Pl(e),n=tu();iu(e.onDisconnect_,Vo(),(function(r,i){var a=Yc(r,i,e.serverSyncTree_,t);nu(n,r,a)}));var r=[];iu(n,Vo(),(function(t,n){r=r.concat(Tc(e.serverSyncTree_,t,n));var i=Jl(e,t);Gl(e,i)})),e.onDisconnect_=tu(),Cl(e.eventQueue_,Vo(),r)}(e)}function Fl(e,t,n){var r=new Bo("/.info/"+t),i=js(n);e.infoData_.updateSnapshot(r,i);var a=Tc(e.infoSyncTree_,r,i);Cl(e.eventQueue_,r,a)}function Ml(e){return e.nextWriteId_++}function Ul(e,t,n,r,i){Zl(e,"set",{path:t.toString(),value:n,priority:r});var a=Pl(e),o=js(n,r),s=Oc(e.serverSyncTree_,t),u=$c(o,s,a),c=Ml(e),l=Ec(e.serverSyncTree_,t,u,c,!0);Sl(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),(function(n,r){var a="ok"===n;a||$a("set at "+t+" failed: "+n);var o=Ic(e.serverSyncTree_,c,!a);Cl(e.eventQueue_,t,o),Wl(e,i,n,r)}));var f=Jl(e,t);Gl(e,f),Cl(e.eventQueue_,f,[])}function Bl(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&ru(e.onDisconnect_,t),Wl(e,n,r,i)}))}function Vl(e,t,n,r){var i=js(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,a){"ok"===n&&nu(e.onDisconnect_,t,i),Wl(e,r,n,a)}))}function zl(e,t,n){var r;r=".info"===zo(t._path)?Nc(e.infoSyncTree_,t,n):Nc(e.serverSyncTree_,t,n),El(e.eventQueue_,t._path,r)}function ql(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Nl)}function Zl(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Ka.apply(void 0,[t].concat(r))}function Wl(e,t,n,r){t&&lo((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}}))}function Hl(e,t,n){return Oc(e.serverSyncTree_,t,n)||Rs.EMPTY_NODE}function Kl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||Xl(e,t),tl(t)){var n=Yl(e,t);yr(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=Hl(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];yr(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=Yo(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),f=t;e.server_.put(f.toString(),l,(function(r){Zl(e,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(Ic(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)o(s);Xl(e,el(e.transactionQueueTree_,t)),Kl(e,e.transactionQueueTree_),Cl(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)lo(a[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{$a("transaction at "+f.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}Gl(e,t)}}),o)}(e,ol(t),n)}else rl(t)&&il(t,(function(t){Kl(e,t)}))}function Gl(e,t){var n=Ql(e,t),r=ol(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})),o=a.map((function(e){return e.currentWriteId})),s=function(a){var s,u,c=t[a],l=Yo(n,c.path),f=!1;if(yr(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)f=!0,s=c.abortReason,i=i.concat(Ic(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=Al)f=!0,s="maxretry",i=i.concat(Ic(e.serverSyncTree_,c.currentWriteId,!0));else{var h=Hl(e,c.path,o);c.currentInputSnapshot=h;var d=t[a].update(h.val());if(void 0!==d){vl("transaction failed: Data returned ",d,c.path);var p=js(d);"object"===typeof d&&null!=d&&Vr(d,".priority")||(p=p.updatePriority(h.getPriority()));var v=c.currentWriteId,y=Pl(e),m=$c(p,h,y);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=m,c.currentWriteId=Ml(e),o.splice(o.indexOf(v),1),i=(i=i.concat(Ec(e.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat(Ic(e.serverSyncTree_,v,!0))}else f=!0,s="nodata",i=i.concat(Ic(e.serverSyncTree_,c.currentWriteId,!0))}Cl(e.eventQueue_,n,i),i=[],f&&(t[a].status=2,u=t[a].unwatcher,setTimeout(u,Math.floor(0)),t[a].onComplete&&("nodata"===s?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(s),!1,null)}))))},u=0;u<t.length;u++)s(u);Xl(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)lo(r[c]);Kl(e,e.transactionQueueTree_)}(e,Yl(e,n),r),r}function Ql(e,t){var n,r=e.transactionQueueTree_;for(n=zo(t);null!==n&&void 0===tl(r);)r=el(r,n),n=zo(t=Zo(t));return r}function Yl(e,t){var n=[];return $l(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function $l(e,t,n){var r=tl(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);il(t,(function(t){$l(e,t,n)}))}function Xl(e,t){var n=tl(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,nl(t,n.length>0?n:void 0)}il(t,(function(t){Xl(e,t)}))}function Jl(e,t){var n=ol(Ql(e,t)),r=el(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){ef(e,t)})),ef(e,r),al(r,(function(t){ef(e,t)})),n}function ef(e,t){var n=tl(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(yr(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(yr(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Ic(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?nl(t,void 0):n.length=a+1,Cl(e.eventQueue_,ol(t),i);for(var s=0;s<r.length;s++)lo(r[s])}}var tf=function(e,t){var n=nf(e),r=n.namespace;"firebase.com"===n.domain&&Ya(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Ya("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&$a("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new _o(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Bo(n.pathString)}},nf=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(l,f)),l<f&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,f)));var h=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=Tt(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):$a("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,f)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in h&&(a=h.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},rf="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",af=function(){var e=0,t=[];return function(n){var r,i=n===e;e=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=rf.charAt(n%64),n=Math.floor(n/64);yr(0===n,"Cannot push at time == 0");var o=a.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=rf.charAt(t[r]);return yr(20===o.length,"nextPushId: Length should be 20."),o}}(),of=function(){function e(t,n,r,i){ht(this,e),this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}return vt(e,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+Ur(this.snapshot.exportVal())}}]),e}(),sf=function(){function e(t,n,r){ht(this,e),this.eventRegistration=t,this.error=n,this.path=r}return vt(e,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),e}(),uf=function(){function e(t,n){ht(this,e),this.snapshotCallback=t,this.cancelCallback=n}return vt(e,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return yr(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),e}(),cf=function(){function e(t,n){ht(this,e),this._repo=t,this._path=n}return vt(e,[{key:"cancel",value:function(){var e=new Tr;return Bl(this._repo,this._path,e.wrapCallback((function(){}))),e.promise}},{key:"remove",value:function(){_l("OnDisconnect.remove",this._path);var e=new Tr;return Vl(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise}},{key:"set",value:function(e){_l("OnDisconnect.set",this._path),pl("OnDisconnect.set",e,this._path,!1);var t=new Tr;return Vl(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}},{key:"setWithPriority",value:function(e,t){_l("OnDisconnect.setWithPriority",this._path),pl("OnDisconnect.setWithPriority",e,this._path,!1),ml("OnDisconnect.setWithPriority",t,!1);var n=new Tr;return function(e,t,n,r,i){var a=js(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),(function(n,r){"ok"===n&&nu(e.onDisconnect_,t,a),Wl(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise}},{key:"update",value:function(e){_l("OnDisconnect.update",this._path),yl("OnDisconnect.update",e,this._path,!1);var t=new Tr;return function(e,t,n,r){if(qr(n))return Ka("onDisconnect().update() called with empty data.  Don't do anything."),void Wl(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,a){"ok"===i&&oo(n,(function(n,r){var i=js(r);nu(e.onDisconnect_,Go(t,n),i)})),Wl(0,r,i,a)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}}]),e}(),lf=function(){function e(t,n,r,i){ht(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return vt(e,[{key:"key",get:function(){return Qo(this._path)?null:Wo(this._path)}},{key:"ref",get:function(){return new pf(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=Xs(this._queryParams),t=io(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return Xs(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=ni(t))instanceof e))return!1;var n=this._repo===t._repo,r=Xo(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();function ff(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function hf(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===ls){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Ja)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==eo)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===Is){if(null!=t&&!dl(t)||null!=n&&!dl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(yr(e.getIndex()instanceof Fs||e.getIndex()===Us,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function df(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var pf=function(e){mt(n,e);var t=wt(n);function n(e,r){return ht(this,n),t.call(this,e,r,new Ks,!1)}return vt(n,[{key:"parent",get:function(){var e=Ko(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(lf),vf=function(){function e(t,n,r){ht(this,e),this._node=t,this.ref=n,this._index=r}return vt(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(t){var n=new Bo(t),r=gf(this.ref,t);return new e(this._node.getChild(n),r,Is)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,gf(n.ref,r),Is))}))}},{key:"hasChild",value:function(e){var t=new Bo(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function yf(e,t){return(e=ni(e))._checkNotDeleted("ref"),void 0!==t?gf(e._root,t):e._root}function mf(e,t){(e=ni(e))._checkNotDeleted("refFromURL");var n=tf(t,e._repo.repoInfo_.nodeAdmin);wl("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||Ya("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),yf(e,n.path.toString())}function gf(e,t){return null===zo((e=ni(e))._path)?bl("child","path",t,!1):kl("child","path",t,!1),new pf(e._repo,Go(e._path,t))}function kf(e,t){e=ni(e),_l("set",e._path),pl("set",t,e._path,!1);var n=new Tr;return Ul(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function bf(e,t){yl("update",t,e._path,!1);var n=new Tr;return function(e,t,n,r){Zl(e,"update",{path:t.toString(),value:n});var i=!0,a=Pl(e),o={};if(oo(n,(function(n,r){i=!1,o[n]=Yc(Go(t,n),js(r),e.serverSyncTree_,a)})),i)Ka("update() called with empty data.  Don't do anything."),Wl(0,r,"ok",void 0);else{var s=Ml(e),u=Cc(e.serverSyncTree_,t,o,s);Sl(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var a="ok"===n;a||$a("update at "+t+" failed: "+n);var o=Ic(e.serverSyncTree_,s,!a),u=o.length>0?Gl(e,t):t;Cl(e.eventQueue_,u,o),Wl(0,r,n,i)})),oo(n,(function(n){var r=Jl(e,Go(t,n));Gl(e,r)})),Cl(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function _f(e){e=ni(e);var t=new uf((function(){})),n=new wf(t);return function(e,t,n){var r=Rc(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((function(r){var i,a=js(r).withIndex(t._queryParams.getIndex());if(Dc(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())i=Tc(e.serverSyncTree_,t._path,a);else{var o=Mc(e.serverSyncTree_,t);i=Ac(e.serverSyncTree_,t._path,a,o)}return Cl(e.eventQueue_,t._path,i),Nc(e.serverSyncTree_,t,n,null,!0),a}),(function(n){return Zl(e,"get for query "+Ur(t)+" failed: "+n),Promise.reject(new Error(n))}))}(e._repo,e,n).then((function(t){return new vf(t,new pf(e._repo,e._path),e._queryParams.getIndex())}))}var wf=function(){function e(t){ht(this,e),this.callbackContext=t}return vt(e,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new of("value",this,new vf(e.snapshotNode,new pf(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new sf(this,e,t):null}},{key:"matches",value:function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),e}(),xf=function(){function e(t,n){ht(this,e),this.eventType=t,this.callbackContext=n}return vt(e,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new sf(this,e,t):null}},{key:"createEvent",value:function(e,t){yr(null!=e.childName,"Child events should have a childName.");var n=gf(new pf(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new of(e.type,this,new vf(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),e}();function Sf(e,t,n,r,i){var a;if("object"===typeof r&&(a=void 0,i=r),"function"===typeof r&&(a=r),i&&i.onlyOnce){var o=n,s=function(t,n){zl(e._repo,e,c),o(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new uf(n,a||void 0),c="value"===t?new wf(u):new xf(t,u);return function(e,t,n){var r;r=".info"===zo(t._path)?Dc(e.infoSyncTree_,t,n):Dc(e.serverSyncTree_,t,n),El(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return zl(e._repo,e,c)}}function Ef(e,t,n,r){return Sf(e,"value",t,n,r)}function Cf(e,t,n,r){return Sf(e,"child_added",t,n,r)}function If(e,t,n,r){return Sf(e,"child_changed",t,n,r)}function Tf(e,t,n,r){return Sf(e,"child_moved",t,n,r)}function Nf(e,t,n,r){return Sf(e,"child_removed",t,n,r)}function Af(e,t,n){var r=null,i=n?new uf(n):null;"value"===t?r=new wf(i):t&&(r=new xf(t,i)),zl(e._repo,e,r)}var Df=vt((function e(){ht(this,e)})),Of=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._value=e,i._key=r,i}return vt(n,[{key:"_apply",value:function(e){pl("endAt",this._value,e._path,!0);var t=Qs(e._queryParams,this._value,this._key);if(df(t),hf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new lf(e._repo,e._path,t,e._orderByCalled)}}]),n}(Df);var Rf=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._value=e,i._key=r,i}return vt(n,[{key:"_apply",value:function(e){pl("endBefore",this._value,e._path,!1);var t=function(e,t,n){var r;return(r=e.index_===ls||n?Qs(e,t,n):Qs(e,t,Ja)).endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(df(t),hf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new lf(e._repo,e._path,t,e._orderByCalled)}}]),n}(Df);var Pf=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._value=e,i._key=r,i}return vt(n,[{key:"_apply",value:function(e){pl("startAt",this._value,e._path,!0);var t=Gs(e._queryParams,this._value,this._key);if(df(t),hf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new lf(e._repo,e._path,t,e._orderByCalled)}}]),n}(Df);var Lf=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._value=e,i._key=r,i}return vt(n,[{key:"_apply",value:function(e){pl("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;return(r=e.index_===ls||n?Gs(e,t,n):Gs(e,t,eo)).startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(df(t),hf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new lf(e._repo,e._path,t,e._orderByCalled)}}]),n}(Df);var jf=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this))._limit=e,r}return vt(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new lf(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(Df);var Ff=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this))._limit=e,r}return vt(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new lf(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(Df);var Mf=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this))._path=e,r}return vt(n,[{key:"_apply",value:function(e){ff(e,"orderByChild");var t=new Bo(this._path);if(Qo(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new Fs(t),r=Ys(e._queryParams,n);return hf(r),new lf(e._repo,e._path,r,!0)}}]),n}(Df);var Uf=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"_apply",value:function(e){ff(e,"orderByKey");var t=Ys(e._queryParams,ls);return hf(t),new lf(e._repo,e._path,t,!0)}}]),n}(Df);var Bf=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"_apply",value:function(e){ff(e,"orderByPriority");var t=Ys(e._queryParams,Is);return hf(t),new lf(e._repo,e._path,t,!0)}}]),n}(Df);var Vf=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"_apply",value:function(e){ff(e,"orderByValue");var t=Ys(e._queryParams,Us);return hf(t),new lf(e._repo,e._path,t,!0)}}]),n}(Df);var zf=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._value=e,i._key=r,i}return vt(n,[{key:"_apply",value:function(e){if(pl("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Of(this._value,this._key)._apply(new Pf(this._value,this._key)._apply(e))}}]),n}(Df);function qf(e){for(var t=ni(e),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0,o=r;a<o.length;a++){t=o[a]._apply(t)}return t}!function(e){yr(!ic,"__referenceConstructor has already been defined"),ic=e}(pf),function(e){yr(!fc,"__referenceConstructor has already been defined"),fc=e}(pf);var Zf="FIREBASE_DATABASE_EMULATOR_HOST",Wf={},Hf=!1;function Kf(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||Ya("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ka("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s=tf(a,i),u=s.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[Zf]),c?(o=!0,a="http://".concat(c,"?ns=").concat(u.namespace),u=(s=tf(a,i)).repoInfo):o=!s.repoInfo.secure;var l=i&&o?new vo(vo.OWNER):new po(e.name,e.options,t);wl("Invalid Firebase Database URL",s),Qo(s.path)||Ya("Database URL must point to the root of a Firebase Database (not including a child path).");var f=function(e,t,n,r){var i=Wf[t.name];i||(i={},Wf[t.name]=i);var a=i[e.toURLString()];a&&Ya("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new Dl(e,Hf,n,r),i[e.toURLString()]=a,a}(u,e,l,new ho(e.name,n));return new Gf(f,e)}var Gf=function(){function e(t,n){ht(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return vt(e,[{key:"_repo",get:function(){return this._instanceStarted||(Ol(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new pf(this._repo,Vo())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=Wf[t];n&&n[e.key]===e||Ya("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),ql(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&Ya("Cannot call "+e+" on a deleted database.")}}]),e}();function Qf(){Ro.IS_TRANSPORT_INITIALIZED&&$a("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Yf(){Qf(),No.forceDisallow()}function $f(){Qf(),Oo.forceDisallow(),No.forceAllow()}function Xf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=ni(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Ya("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ya('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new vo(vo.OWNER);else if(r.mockUserToken){var o="string"===typeof r.mockUserToken?r.mockUserToken:Nr(r.mockUserToken,e.app.options.projectId);a=new vo(o)}!function(e,t,n,r){e.repoInfo_=new _o("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,a)}function Jf(e){var t;(e=ni(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Nl)}function eh(e,t){Ha(e,t)}var th={".sv":"timestamp"};var nh=function(){function e(t,n){ht(this,e),this.committed=t,this.snapshot=n}return vt(e,[{key:"toJSON",value:function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}();function rh(e,t,n){var r;if(e=ni(e),_l("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new Tr,o=Ef(e,(function(){}));return function(e,t,n,r,i,a){Zl(e,"transaction on "+t);var o={path:t,update:n,onComplete:r,status:null,order:Va(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=Hl(e,t,void 0);o.currentInputSnapshot=s;var u=o.update(s.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{vl("transaction failed: Data returned ",u,o.path),o.status=0;var c,l=el(e.transactionQueueTree_,t),f=tl(l)||[];f.push(o),nl(l,f),"object"===typeof u&&null!==u&&Vr(u,".priority")?(c=zr(u,".priority"),yr(dl(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(Oc(e.serverSyncTree_,t)||Rs.EMPTY_NODE).getPriority().val();var h=Pl(e),d=js(u,c),p=$c(d,s,h);o.currentOutputSnapshotRaw=d,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ml(e);var v=Ec(e.serverSyncTree_,t,p,o.currentWriteId,o.applyLocally);Cl(e.eventQueue_,t,v),Kl(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?a.reject(t):(i=new vf(r,new pf(e._repo,e._path),Is),a.resolve(new nh(n,i)))}),o,i),a.promise}as.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},as.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){Pa(Xi),Wi(new ri("database",(function(e,t){var n=t.instanceIdentifier;return Kf(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),ia(Da,Oa,e),ia(Da,Oa,"esm2017")}();var ih=new pi("@firebase/database-compat"),ah=function(e){var t="FIREBASE WARNING: "+e;ih.warn(t)},oh=function(){function e(t){ht(this,e),this._delegate=t}return vt(e,[{key:"cancel",value:function(e){$r("OnDisconnect.cancel",0,1,arguments.length),Jr("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"remove",value:function(e){$r("OnDisconnect.remove",0,1,arguments.length),Jr("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"set",value:function(e,t){$r("OnDisconnect.set",1,2,arguments.length),Jr("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"setWithPriority",value:function(e,t,n){$r("OnDisconnect.setWithPriority",2,3,arguments.length),Jr("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"update",value:function(e,t){if($r("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,ah("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jr("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}}]),e}(),sh=function(){function e(t,n){ht(this,e),this.committed=t,this.snapshot=n}return vt(e,[{key:"toJSON",value:function(){return $r("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}(),uh=function(){function e(t,n){ht(this,e),this._database=t,this._delegate=n}return vt(e,[{key:"val",value:function(){return $r("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}},{key:"exportVal",value:function(){return $r("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}},{key:"toJSON",value:function(){return $r("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"exists",value:function(){return $r("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}},{key:"child",value:function(t){return $r("DataSnapshot.child",0,1,arguments.length),t=String(t),kl("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))}},{key:"hasChild",value:function(e){return $r("DataSnapshot.hasChild",1,1,arguments.length),kl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}},{key:"getPriority",value:function(){return $r("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}},{key:"forEach",value:function(t){var n=this;return $r("DataSnapshot.forEach",1,1,arguments.length),Jr("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))}},{key:"hasChildren",value:function(){return $r("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}},{key:"key",get:function(){return this._delegate.key}},{key:"numChildren",value:function(){return $r("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}},{key:"getRef",value:function(){return $r("DataSnapshot.ref",0,0,arguments.length),new lh(this._database,this._delegate.ref)}},{key:"ref",get:function(){return this.getRef()}}]),e}(),ch=function(){function e(t,n){ht(this,e),this.database=t,this._delegate=n}return vt(e,[{key:"on",value:function(t,n,r,i){var a,o=this;$r("Query.on",2,4,arguments.length),Jr("Query.on","callback",n,!1);var s=e.getCancelAndContextArgs_("Query.on",r,i),u=function(e,t){n.call(s.context,new uh(o.database,e),t)};u.userCallback=n,u.context=s.context;var c=null===(a=s.cancel)||void 0===a?void 0:a.bind(s.context);switch(t){case"value":return Ef(this._delegate,u,c),n;case"child_added":return Cf(this._delegate,u,c),n;case"child_removed":return Nf(this._delegate,u,c),n;case"child_changed":return If(this._delegate,u,c),n;case"child_moved":return Tf(this._delegate,u,c),n;default:throw new Error(Xr("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}},{key:"off",value:function(e,t,n){if($r("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Xr(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),Jr("Query.off","callback",t,!0),ei("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,Af(this._delegate,e,r)}else Af(this._delegate,e)}},{key:"get",value:function(){var e=this;return _f(this._delegate).then((function(t){return new uh(e.database,t)}))}},{key:"once",value:function(t,n,r,i){var a=this;$r("Query.once",1,4,arguments.length),Jr("Query.once","callback",n,!0);var o=e.getCancelAndContextArgs_("Query.once",r,i),s=new Tr,u=function(e,t){var r=new uh(a.database,e);n&&n.call(o.context,r,t),s.resolve(r)};u.userCallback=n,u.context=o.context;var c=function(e){o.cancel&&o.cancel.call(o.context,e),s.reject(e)};switch(t){case"value":Ef(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":Cf(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":Nf(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":If(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":Tf(this._delegate,u,c,{onlyOnce:!0});break;default:throw new Error(Xr("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}},{key:"limitToFirst",value:function(t){return $r("Query.limitToFirst",1,1,arguments.length),new e(this.database,qf(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new jf(e)}(t)))}},{key:"limitToLast",value:function(t){return $r("Query.limitToLast",1,1,arguments.length),new e(this.database,qf(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ff(e)}(t)))}},{key:"orderByChild",value:function(t){return $r("Query.orderByChild",1,1,arguments.length),new e(this.database,qf(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return kl("orderByChild","path",e,!1),new Mf(e)}(t)))}},{key:"orderByKey",value:function(){return $r("Query.orderByKey",0,0,arguments.length),new e(this.database,qf(this._delegate,new Uf))}},{key:"orderByPriority",value:function(){return $r("Query.orderByPriority",0,0,arguments.length),new e(this.database,qf(this._delegate,new Bf))}},{key:"orderByValue",value:function(){return $r("Query.orderByValue",0,0,arguments.length),new e(this.database,qf(this._delegate,new Vf))}},{key:"startAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return $r("Query.startAt",0,2,arguments.length),new e(this.database,qf(this._delegate,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return gl("startAt","key",t,!0),new Pf(e,t)}(t,n)))}},{key:"startAfter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return $r("Query.startAfter",0,2,arguments.length),new e(this.database,qf(this._delegate,function(e,t){return gl("startAfter","key",t,!0),new Lf(e,t)}(t,n)))}},{key:"endAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return $r("Query.endAt",0,2,arguments.length),new e(this.database,qf(this._delegate,function(e,t){return gl("endAt","key",t,!0),new Of(e,t)}(t,n)))}},{key:"endBefore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return $r("Query.endBefore",0,2,arguments.length),new e(this.database,qf(this._delegate,function(e,t){return gl("endBefore","key",t,!0),new Rf(e,t)}(t,n)))}},{key:"equalTo",value:function(t,n){return $r("Query.equalTo",1,2,arguments.length),new e(this.database,qf(this._delegate,function(e,t){return gl("equalTo","key",t,!0),new zf(e,t)}(t,n)))}},{key:"toString",value:function(){return $r("Query.toString",0,0,arguments.length),this._delegate.toString()}},{key:"toJSON",value:function(){return $r("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"isEqual",value:function(t){if($r("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(t._delegate)}},{key:"ref",get:function(){return new lh(this.database,new pf(this._delegate._repo,this._delegate._path))}}],[{key:"getCancelAndContextArgs_",value:function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Jr(e,"cancel",r.cancel,!0),r.context=n,ei(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(Xr(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}}]),e}(),lh=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,new lf(r._repo,r._path,new Ks,!1))).database=e,i._delegate=r,i}return vt(n,[{key:"getKey",value:function(){return $r("Reference.key",0,0,arguments.length),this._delegate.key}},{key:"child",value:function(e){return $r("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new n(this.database,gf(this._delegate,e))}},{key:"getParent",value:function(){$r("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new n(this.database,e):null}},{key:"getRoot",value:function(){return $r("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}},{key:"set",value:function(e,t){$r("Reference.set",1,2,arguments.length),Jr("Reference.set","onComplete",t,!0);var n=kf(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"update",value:function(e,t){if($r("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,ah("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_l("Reference.update",this._delegate._path),Jr("Reference.update","onComplete",t,!0);var i=bf(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}},{key:"setWithPriority",value:function(e,t,n){$r("Reference.setWithPriority",2,3,arguments.length),Jr("Reference.setWithPriority","onComplete",n,!0);var r=function(e,t,n){if(_l("setWithPriority",e._path),pl("setWithPriority",t,e._path,!1),ml("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new Tr;return Ul(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"remove",value:function(e){$r("Reference.remove",0,1,arguments.length),Jr("Reference.remove","onComplete",e,!0);var t,n=(t=this._delegate,_l("remove",t._path),kf(t,null));return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n}},{key:"transaction",value:function(e,t,n){var r=this;$r("Reference.transaction",1,3,arguments.length),Jr("Reference.transaction","transactionUpdate",e,!1),Jr("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(Xr(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);var i=rh(this._delegate,e,{applyLocally:n}).then((function(e){return new sh(e.committed,new uh(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i}},{key:"setPriority",value:function(e,t){$r("Reference.setPriority",1,2,arguments.length),Jr("Reference.setPriority","onComplete",t,!0);var n=function(e,t){e=ni(e),_l("setPriority",e._path),ml("setPriority",t,!1);var n=new Tr;return Ul(e._repo,Go(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"push",value:function(e,t){var r=this;$r("Reference.push",0,2,arguments.length),Jr("Reference.push","onComplete",t,!0);var i=function(e,t){e=ni(e),_l("push",e._path),pl("push",t,e._path,!0);var n,r=Rl(e._repo),i=af(r),a=gf(e,i),o=gf(e,i);return n=null!=t?kf(o,t).then((function(){return o})):Promise.resolve(o),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}(this._delegate,e),a=i.then((function(e){return new n(r.database,e)}));t&&a.then((function(){return t(null)}),(function(e){return t(e)}));var o=new n(this.database,i);return o.then=a.then.bind(a),o.catch=a.catch.bind(a,void 0),o}},{key:"onDisconnect",value:function(){return _l("Reference.onDisconnect",this._delegate._path),new oh(new cf(this._delegate._repo,this._delegate._path))}},{key:"key",get:function(){return this.getKey()}},{key:"parent",get:function(){return this.getParent()}},{key:"root",get:function(){return this.getRoot()}}]),n}(ch),fh=function(){function e(t,n){var r=this;ht(this,e),this._delegate=t,this.app=n,this.INTERNAL={delete:function(){return r._delegate._delete()},forceWebSockets:Yf,forceLongPolling:$f}}return vt(e,[{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Xf(this._delegate,e,t,n)}},{key:"ref",value:function(e){if($r("database.ref",0,1,arguments.length),e instanceof lh){var t=mf(this._delegate,e.toString());return new lh(this,t)}var n=yf(this._delegate,e);return new lh(this,n)}},{key:"refFromURL",value:function(e){$r("database.refFromURL",1,1,arguments.length);var t=mf(this._delegate,e);return new lh(this,t)}},{key:"goOffline",value:function(){return $r("database.goOffline",0,0,arguments.length),function(e){(e=ni(e))._checkNotDeleted("goOffline"),ql(e._repo)}(this._delegate)}},{key:"goOnline",value:function(){return $r("database.goOnline",0,0,arguments.length),Jf(this._delegate)}}]),e}();fh.ServerValue={TIMESTAMP:th,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}};var hh,dh=Object.freeze({__proto__:null,initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,a=e.namespace,o=e.nodeAdmin,s=void 0!==o&&o;Pa(r);var u=new ai("auth-internal",new ui("database-standalone"));return u.setComponent(new ri("auth-internal",(function(){return i}),"PRIVATE")),{instance:new fh(Kf(t,u,void 0,n,s),t),namespace:a}}}),ph=fh.ServerValue;(hh=Aa).INTERNAL.registerComponent(new ri("database-compat",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new fh(i,r)}),"PUBLIC").setServiceProps({Reference:lh,Query:ch,Database:fh,DataSnapshot:uh,enableLogging:eh,INTERNAL:dh,ServerValue:ph}).setMultipleInstances(!0)),hh.registerVersion("@firebase/database-compat","0.3.4");var vh,yh="firebasestorage.googleapis.com",mh="storageBucket",gh=function(e){mt(n,e);var t=wt(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ht(this,n),(i=t.call(this,kh(e),"Firebase Storage: ".concat(r," (").concat(kh(e),")"))).status_=a,i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(_t(i),n.prototype),i}return vt(n,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return kh(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),n}(Lr);function kh(e){return"storage/"+e}function bh(){return new gh(vh.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function _h(){return new gh(vh.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function wh(){return new gh(vh.CANCELED,"User canceled the upload/download.")}function xh(){return new gh(vh.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Sh(e){return new gh(vh.INVALID_ARGUMENT,e)}function Eh(){return new gh(vh.APP_DELETED,"The Firebase app was deleted.")}function Ch(e){return new gh(vh.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ih(e,t){return new gh(vh.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Th(e){throw new gh(vh.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(vh||(vh={}));var Nh,Ah=function(){function e(t,n){ht(this,e),this.bucket=t,this.path_=n}return vt(e,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(t,n){var r,i;try{r=e.makeFromUrl(t,n)}catch(a){return new e(t,"")}if(""===r.path)return r;throw i=t,new gh(vh.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}},{key:"makeFromUrl",value:function(t,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var a=new RegExp("^gs://"+i+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===yh?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<u.length;c++){var l=u[c],f=l.regex.exec(t);if(f){var h=f[l.indices.bucket],d=f[l.indices.path];d||(d=""),r=new e(h,d),l.postModify(r);break}}if(null==r)throw function(e){return new gh(vh.INVALID_URL,"Invalid URL '"+e+"'.")}(t);return r}}]),e}(),Dh=function(){function e(t){ht(this,e),this.promise_=Promise.reject(t)}return vt(e,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),e}();function Oh(e){return"string"===typeof e||e instanceof String}function Rh(e){return Ph()&&e instanceof Blob}function Ph(){return"undefined"!==typeof Blob&&!Or()}function Lh(e,t,n,r){if(r<t)throw Sh("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Sh("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function jh(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function Fh(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function Mh(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Nh||(Nh={}));var Uh=function(){function e(t,n,r,i,a,o,s,u,c,l,f){var h=this,d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];ht(this,e),this.url_=t,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=s,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=f,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){h.resolve_=e,h.reject_=t,h.start_()}))}return vt(e,[{key:"start_",value:function(){var e=this,t=function(t,n){var r=e.resolve_,i=e.reject_,a=n.connection;if(n.wasSuccessCode)try{var o=e.callback_(a,a.getResponse());!function(e){return void 0!==e}(o)?r():r(o)}catch(u){i(u)}else if(null!==a){var s=bh();s.serverResponse=a.getErrorText(),e.errorCallback_?i(e.errorCallback_(a,s)):i(s)}else{if(n.canceled)i(e.appDelete_?Eh():wh());else i(_h())}};this.canceled_?t(0,new Bh(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,i=null,a=null,o=!1,s=0;function u(){return 2===s}var c=!1;function l(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function f(t){i=setTimeout((function(){i=null,e(d,u())}),t)}function h(){a&&clearTimeout(a)}function d(e){if(c)h();else{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return h(),void l.call.apply(l,[null,e].concat(n));var a;if(u()||o)return h(),void l.call.apply(l,[null,e].concat(n));r<64&&(r*=2),1===s?(s=2,a=0):a=1e3*(r+Math.random()),f(a)}}var p=!1;function v(e){p||(p=!0,h(),c||(null!==i?(e||(s=2),clearTimeout(i),f(0)):e||(s=1)))}return f(0),a=setTimeout((function(){o=!0,v(!0)}),n),v}((function(t,n){if(n)t(!1,new Bh(!1,null,!0));else{var r=e.connectionFactory_();e.pendingConnection_=r;var i=function(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)};null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(){null!==e.progressCallback_&&r.removeUploadProgressListener(i),e.pendingConnection_=null;var n=r.getErrorCode()===Nh.NO_ERROR,a=r.getStatus();if(!n||Mh(a,e.additionalRetryCodes_)&&e.retry){var o=r.getErrorCode()===Nh.ABORT;t(!1,new Bh(!1,null,o))}else{var s=-1!==e.successCodes_.indexOf(a);t(!0,new Bh(s,r))}}))}}),t,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),e}(),Bh=vt((function e(t,n,r){ht(this,e),this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}));function Vh(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function zh(){for(var e=Vh(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){for(var i=new e,a=0;a<n.length;a++)i.append(n[a]);return i.getBlob()}if(Ph())return new Blob(n);throw new gh(vh.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function qh(e){if("undefined"===typeof atob)throw t="base-64",new gh(vh.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}var Zh={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Wh=vt((function e(t,n){ht(this,e),this.data=t,this.contentType=n||null}));function Hh(e,t){switch(e){case Zh.RAW:return new Wh(Kh(t));case Zh.BASE64:case Zh.BASE64URL:return new Wh(Gh(e,t));case Zh.DATA_URL:return new Wh(function(e){var t=new Qh(e);return t.base64?Gh(Zh.BASE64,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(n){throw Ih(Zh.DATA_URL,"Malformed data URL.")}return Kh(t)}(t.rest)}(t),function(e){var t=new Qh(e);return t.contentType}(t))}throw bh()}function Kh(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Gh(e,t){switch(e){case Zh.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw Ih(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Zh.BASE64URL:var i=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(i||a)throw Ih(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=qh(t)}catch(c){if(c.message.includes("polyfill"))throw c;throw Ih(e,"Invalid character found")}for(var s=new Uint8Array(o.length),u=0;u<o.length;u++)s[u]=o.charCodeAt(u);return s}var Qh=vt((function e(t){ht(this,e),this.base64=!1,this.contentType=null;var n=t.match(/^data:([^,]+)?,/);if(null===n)throw Ih(Zh.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}));var Yh=function(){function e(t,n){ht(this,e);var r=0,i="";Rh(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}return vt(e,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(t,n){if(Rh(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}var i=new Uint8Array(this.data_.buffer,t,n-t);return new e(i,!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(Ph()){var i=n.map((function(t){return t instanceof e?t.data_:t}));return new e(zh.apply(null,i))}var a=n.map((function(e){return Oh(e)?Hh(Zh.RAW,e).data:e.data_})),o=0;a.forEach((function(e){o+=e.byteLength}));var s=new Uint8Array(o),u=0;return a.forEach((function(e){for(var t=0;t<e.length;t++)s[u++]=e[t]})),new e(s,!0)}}]),e}();function $h(e){var t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Xh(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Jh(e,t){return t}var ed=vt((function e(t,n,r,i){ht(this,e),this.server=t,this.local=n||t,this.writable=!!r,this.xform=i||Jh})),td=null;function nd(){if(td)return td;var e=[];e.push(new ed("bucket")),e.push(new ed("generation")),e.push(new ed("metageneration")),e.push(new ed("name","fullPath",!0));var t=new ed("name");t.xform=function(e,t){return function(e){return!Oh(e)||e.length<2?e:Xh(e)}(t)},e.push(t);var n=new ed("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new ed("timeCreated")),e.push(new ed("updated")),e.push(new ed("md5Hash",null,!0)),e.push(new ed("cacheControl",null,!0)),e.push(new ed("contentDisposition",null,!0)),e.push(new ed("contentEncoding",null,!0)),e.push(new ed("contentLanguage",null,!0)),e.push(new ed("contentType",null,!0)),e.push(new ed("metadata","customMetadata",!0)),td=e}function rd(e,t,n){for(var r={type:"file"},i=n.length,a=0;a<i;a++){var o=n[a];r[o.local]=o.xform(r,t[o.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new Ah(n,r);return t._makeStorageReference(i)}})}(r,e),r}function id(e,t,n){var r=$h(t);return null===r?null:rd(e,r,n)}function ad(e,t){for(var n={},r=t.length,i=0;i<r;i++){var a=t[i];a.writable&&(n[a.server]=e[a.local])}return JSON.stringify(n)}var od="prefixes",sd="items";function ud(e,t,n){var r=$h(n);return null===r?null:function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[od]){var i,a=Tt(n[od]);try{for(a.s();!(i=a.n()).done;){var o=i.value.replace(/\/$/,""),s=e._makeStorageReference(new Ah(t,o));r.prefixes.push(s)}}catch(h){a.e(h)}finally{a.f()}}if(n[sd]){var u,c=Tt(n[sd]);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=e._makeStorageReference(new Ah(t,l.name));r.items.push(f)}}catch(h){c.e(h)}finally{c.f()}}return r}(e,t,r)}var cd=vt((function e(t,n,r,i){ht(this,e),this.url=t,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function ld(e){if(!e)throw bh()}function fd(e,t){return function(n,r){var i=id(e,r,t);return ld(null!==i),i}}function hd(e,t){return function(n,r){var i=id(e,r,t);return ld(null!==i),function(e,t,n,r){var i=$h(t);if(null===i)return null;if(!Oh(i.downloadTokens))return null;var a=i.downloadTokens;if(0===a.length)return null;var o=encodeURIComponent;return a.split(",").map((function(t){var i=e.bucket,a=e.fullPath;return jh("/b/"+o(i)+"/o/"+o(a),n,r)+Fh({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function dd(e){return function(t,n){var r,i,a;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new gh(vh.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new gh(vh.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,r=new gh(vh.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new gh(vh.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function pd(e){var t=dd(e);return function(n,r){var i,a=t(n,r);return 404===n.getStatus()&&(i=e.path,a=new gh(vh.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),a.serverResponse=r.serverResponse,a}}function vd(e,t,n){var r=jh(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new cd(r,"GET",fd(e,n),i);return a.errorHandler=pd(t),a}function yd(e,t,n,r,i){var a={};t.isRoot?a.prefix="":a.prefix=t.path+"/",n&&n.length>0&&(a.delimiter=n),r&&(a.pageToken=r),i&&(a.maxResults=i);var o=jh(t.bucketOnlyServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,u=new cd(o,"GET",function(e,t){return function(n,r){var i=ud(e,t,r);return ld(null!==i),i}}(e,t.bucket),s);return u.urlParams=a,u.errorHandler=dd(t),u}function md(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function gd(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+s;var u=md(t,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ad(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",f=Yh.getBlob(c,r,l);if(null===f)throw xh();var h={name:u.fullPath},d=jh(a,e.host,e._protocol),p=e.maxUploadRetryTime,v=new cd(d,"POST",fd(e,n),p);return v.urlParams=h,v.headers=o,v.body=f.uploadData(),v.errorHandler=dd(t),v}var kd=vt((function e(t,n,r,i){ht(this,e),this.current=t,this.total=n,this.finalized=!!r,this.metadata=i||null}));function bd(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){ld(!1)}return ld(!!n&&-1!==(t||["active"]).indexOf(n)),n}var _d=262144;function wd(e,t,n,r,i,a,o,s){var u=new kd(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new gh(vh.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var f=u.current,h=f+l,d={"X-Goog-Upload-Command":0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":"".concat(u.current)},p=r.slice(f,h);if(null===p)throw xh();var v=t.maxUploadRetryTime,y=new cd(n,"POST",(function(e,n){var i,o=bd(e,["active","final"]),s=u.current+l,c=r.size();return i="final"===o?fd(t,a)(e,n):null,new kd(s,c,"final"===o,i)}),v);return y.headers=d,y.body=p.uploadData(),y.progressCallback=s||null,y.errorHandler=dd(e),y}var xd={STATE_CHANGED:"state_changed"},Sd={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ed(e){switch(e){case"running":case"pausing":case"canceling":return Sd.RUNNING;case"paused":return Sd.PAUSED;case"success":return Sd.SUCCESS;case"canceled":return Sd.CANCELED;default:return Sd.ERROR}}var Cd=vt((function e(t,n,r){ht(this,e);var i=function(e){return"function"===typeof e}(t)||null!=n||null!=r;if(i)this.next=t,this.error=null!==n&&void 0!==n?n:void 0,this.complete=null!==r&&void 0!==r?r:void 0;else{var a=t;this.next=a.next,this.error=a.error,this.complete=a.complete}}));function Id(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((function(){return e.apply(void 0,n)}))}}var Td=null,Nd=function(){function e(){var t=this;ht(this,e),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Nh.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=Nh.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=Nh.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return vt(e,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw Th("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw Th("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw Th("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw Th("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw Th("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),e}(),Ad=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),n}(Nd);function Dd(){return Td?Td():new Ad}var Od=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;ht(this,e),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=n,this._metadata=i,this._mappings=nd(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){if(r._request=void 0,r._chunkMultiplier=1,e._codeEquals(vh.CANCELED))r._needToFetchStatus=!0,r.completeTransitions_();else{var t=r.isExponentialBackoffExpired();if(Mh(e.status,[])){if(!t)return r.sleepTime=Math.max(2*r.sleepTime,1e3),r._needToFetchStatus=!0,void r.completeTransitions_();e=_h()}r._error=e,r._transition("error")}},this._metadataErrorHandler=function(e){r._request=void 0,e._codeEquals(vh.CANCELED)?r.completeTransitions_():(r._error=e,r._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t,r._start()})),this._promise.then(null,(function(){}))}return vt(e,[{key:"isExponentialBackoffExpired",value:function(){return this.sleepTime>this.maxSleepTime}},{key:"_makeProgressCallback",value:function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}}},{key:"_shouldDoResumable",value:function(e){return e.size()>262144}},{key:"_start",value:function(){var e=this;"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((function(){e.pendingTimeout=void 0,e._continueUpload()}),this.sleepTime):this._oneShotUpload())}},{key:"_resolveToken",value:function(e){var t=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=(0,u.Z)(n,2),i=r[0],a=r[1];switch(t._state){case"running":e(i,a);break;case"canceling":t._transition("canceled");break;case"pausing":t._transition("paused")}}))}},{key:"_createResumable",value:function(){var e=this;this._resolveToken((function(t,n){var r=function(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o=md(t,r,i),s={name:o.fullPath},u=jh(a,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=ad(o,n),f=e.maxUploadRetryTime,h=new cd(u,"POST",(function(e){var t;bd(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){ld(!1)}return ld(Oh(t)),t}),f);return h.urlParams=s,h.headers=c,h.body=l,h.errorHandler=dd(t),h}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,Dd,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()}),e._errorHandler)}))}},{key:"_fetchStatus",value:function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n,r){var i=function(e,t,n,r){var i=e.maxUploadRetryTime,a=new cd(n,"POST",(function(e){var t=bd(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(a){ld(!1)}n||ld(!1);var i=Number(n);return ld(!isNaN(i)),new kd(i,r.size(),"final"===t)}),i);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=dd(t),a}(e._ref.storage,e._ref._location,t,e._blob),a=e._ref.storage._makeRequest(i,Dd,n,r);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()}),e._errorHandler)}))}},{key:"_continueUpload",value:function(){var e=this,t=_d*this._chunkMultiplier,n=new kd(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,a){var o;try{o=wd(e._ref._location,e._ref.storage,r,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(u){return e._error=u,void e._transition("error")}var s=e._ref.storage._makeRequest(o,Dd,i,a,!1);e._request=s,s.getPromise().then((function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition("success")):e.completeTransitions_()}),e._errorHandler)}))}},{key:"_increaseMultiplier",value:function(){2*(_d*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}},{key:"_fetchMetadata",value:function(){var e=this;this._resolveToken((function(t,n){var r=vd(e._ref.storage,e._ref._location,e._mappings),i=e._ref.storage._makeRequest(r,Dd,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._transition("success")}),e._metadataErrorHandler)}))}},{key:"_oneShotUpload",value:function(){var e=this;this._resolveToken((function(t,n){var r=gd(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,Dd,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition("success")}),e._errorHandler)}))}},{key:"_updateProgress",value:function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}},{key:"_transition",value:function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=wh(),this._state=e,this._notifyObservers()}}},{key:"completeTransitions_",value:function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}},{key:"snapshot",get:function(){var e=Ed(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}},{key:"on",value:function(e,t,n,r){var i=this,a=new Cd(t||void 0,n||void 0,r||void 0);return this._addObserver(a),function(){i._removeObserver(a)}}},{key:"then",value:function(e,t){return this._promise.then(e,t)}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"_addObserver",value:function(e){this._observers.push(e),this._notifyObserver(e)}},{key:"_removeObserver",value:function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}},{key:"_notifyObservers",value:function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))}},{key:"_finishPromise",value:function(){if(void 0!==this._resolve){var e=!0;switch(Ed(this._state)){case Sd.SUCCESS:Id(this._resolve.bind(null,this.snapshot))();break;case Sd.CANCELED:case Sd.ERROR:Id(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}},{key:"_notifyObserver",value:function(e){switch(Ed(this._state)){case Sd.RUNNING:case Sd.PAUSED:e.next&&Id(e.next.bind(e,this.snapshot))();break;case Sd.SUCCESS:e.complete&&Id(e.complete.bind(e))();break;default:e.error&&Id(e.error.bind(e,this._error))()}}},{key:"resume",value:function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}},{key:"pause",value:function(){var e="running"===this._state;return e&&this._transition("pausing"),e}},{key:"cancel",value:function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}]),e}(),Rd=function(){function e(t,n){ht(this,e),this._service=t,this._location=n instanceof Ah?n:Ah.makeFromUrl(n,t.host)}return vt(e,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(t,n){return new e(t,n)}},{key:"root",get:function(){var e=new Ah(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return Xh(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new Ah(this._location.bucket,t);return new e(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw Ch(e)}}]),e}();function Pd(e,t,n){return Ld.apply(this,arguments)}function Ld(){return(Ld=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={pageToken:r},e.next=3,jd(t,s);case 3:if(u=e.sent,(i=n.prefixes).push.apply(i,ft(u.prefixes)),(a=n.items).push.apply(a,ft(u.items)),null==u.nextPageToken){e.next=9;break}return e.next=9,Pd(t,n,u.nextPageToken);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jd(e,t){null!=t&&"number"===typeof t.maxResults&&Lh("options.maxResults",1,1e3,t.maxResults);var n=t||{},r=yd(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,Dd)}function Fd(e,t){e._throwIfRoot("updateMetadata");var n=function(e,t,n,r){var i=jh(t.fullServerUrl(),e.host,e._protocol),a=ad(n,r),o=e.maxOperationRetryTime,s=new cd(i,"PATCH",fd(e,r),o);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=a,s.errorHandler=pd(t),s}(e.storage,e._location,t,nd());return e.storage.makeRequestWithTokens(n,Dd)}function Md(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=jh(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new cd(r,"GET",hd(e,n),i);return a.errorHandler=pd(t),a}(e.storage,e._location,nd());return e.storage.makeRequestWithTokens(t,Dd).then((function(e){if(null===e)throw new gh(vh.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function Ud(e){e._throwIfRoot("deleteObject");var t=function(e,t){var n=jh(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new cd(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=pd(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Dd)}function Bd(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new Ah(e._location.bucket,n);return new Rd(e.storage,r)}function Vd(e,t){if(e instanceof Zd){var n=e;if(null==n._bucket)throw new gh(vh.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+mh+"' property when initializing the app?");var r=new Rd(n,n._bucket);return null!=t?Vd(r,t):r}return void 0!==t?Bd(e,t):e}function zd(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Zd)return function(e,t){return new Rd(e,t)}(e,t);throw Sh("To use ref(service, url), the first argument must be a Storage instance.")}return Vd(e,t)}function qd(e,t){var n=null===t||void 0===t?void 0:t[mh];return null==n?null:Ah.makeFromBucketSpec(n,e)}var Zd=function(){function e(t,n,r,i,a){ht(this,e),this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=yh,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Ah.makeFromBucketSpec(i,this._host):qd(this._host,this.app.options)}return vt(e,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=Ah.makeFromBucketSpec(this._url,e):this._bucket=qd(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){Lh("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){Lh("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._overrideAuthToken){e.next=2;break}return e.abrupt("return",this._overrideAuthToken);case 2:if(!(t=this._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,t.getToken();case 6:if(null===(n=e.sent)){e.next=9;break}return e.abrupt("return",n.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,t.getToken();case 4:return n=e.sent,e.abrupt("return",n.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new Rd(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var i=this,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new Dh(Eh());var o=function(e,t,n,r,i,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=Fh(e.urlParams),u=e.url+s,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new Uh(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,a);return this._requests.add(o),o.getPromise().then((function(){return i._requests.delete(o)}),(function(){return i._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return r=e.sent,i=(0,u.Z)(r,2),a=i[0],s=i[1],e.abrupt("return",this._makeRequest(t,n,a,s).getPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Wd="@firebase/storage",Hd="0.11.2",Kd="storage";function Gd(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Od(e,new Yh(t),n)}(e=ni(e),t,n)}function Qd(e){return function(e){e._throwIfRoot("getMetadata");var t=vd(e.storage,e._location,nd());return e.storage.makeRequestWithTokens(t,Dd)}(e=ni(e))}function Yd(e){return function(e){var t={prefixes:[],items:[]};return Pd(e,t).then((function(){return t}))}(e=ni(e))}function $d(e,t){return zd(e=ni(e),t)}function Xd(e,t,n){!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var i=r.mockUserToken;i&&(e._overrideAuthToken="string"===typeof i?i:Nr(i,e.app.options.projectId))}(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}function Jd(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new Zd(r,i,a,n,Xi)}Wi(new ri(Kd,Jd,"PUBLIC").setMultipleInstances(!0)),ia(Wd,Hd,""),ia(Wd,Hd,"esm2017");var ep=function(){function e(t,n,r){ht(this,e),this._delegate=t,this.task=n,this.ref=r}return vt(e,[{key:"bytesTransferred",get:function(){return this._delegate.bytesTransferred}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"state",get:function(){return this._delegate.state}},{key:"totalBytes",get:function(){return this._delegate.totalBytes}}]),e}(),tp=function(){function e(t,n){ht(this,e),this._delegate=t,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return vt(e,[{key:"snapshot",get:function(){return new ep(this._delegate.snapshot,this,this._ref)}},{key:"then",value:function(e,t){var n=this;return this._delegate.then((function(t){if(e)return e(new ep(t,n,n._ref))}),t)}},{key:"on",value:function(e,t,n,r){var i=this,a=void 0;return t&&(a="function"===typeof t?function(e){return t(new ep(e,i,i._ref))}:{next:t.next?function(e){return t.next(new ep(e,i,i._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,n||void 0,r||void 0)}}]),e}(),np=function(){function e(t,n){ht(this,e),this._delegate=t,this._service=n}return vt(e,[{key:"prefixes",get:function(){var e=this;return this._delegate.prefixes.map((function(t){return new rp(t,e._service)}))}},{key:"items",get:function(){var e=this;return this._delegate.items.map((function(t){return new rp(t,e._service)}))}},{key:"nextPageToken",get:function(){return this._delegate.nextPageToken||null}}]),e}(),rp=function(){function e(t,n){ht(this,e),this._delegate=t,this.storage=n}return vt(e,[{key:"name",get:function(){return this._delegate.name}},{key:"bucket",get:function(){return this._delegate.bucket}},{key:"fullPath",get:function(){return this._delegate.fullPath}},{key:"toString",value:function(){return this._delegate.toString()}},{key:"child",value:function(t){var n=function(e,t){return Bd(e,t)}(this._delegate,t);return new e(n,this.storage)}},{key:"root",get:function(){return new e(this._delegate.root,this.storage)}},{key:"parent",get:function(){var t=this._delegate.parent;return null==t?null:new e(t,this.storage)}},{key:"put",value:function(e,t){return this._throwIfRoot("put"),new tp(Gd(this._delegate,e,t),this)}},{key:"putString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zh.RAW,n=arguments.length>2?arguments[2]:void 0;this._throwIfRoot("putString");var r=Hh(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new tp(new Od(this._delegate,new Yh(r.data,!0),i),this)}},{key:"listAll",value:function(){var e=this;return Yd(this._delegate).then((function(t){return new np(t,e.storage)}))}},{key:"list",value:function(e){var t=this;return function(e,t){return jd(e=ni(e),t)}(this._delegate,e||void 0).then((function(e){return new np(e,t.storage)}))}},{key:"getMetadata",value:function(){return Qd(this._delegate)}},{key:"updateMetadata",value:function(e){return function(e,t){return Fd(e=ni(e),t)}(this._delegate,e)}},{key:"getDownloadURL",value:function(){return Md(ni(this._delegate))}},{key:"delete",value:function(){return this._throwIfRoot("delete"),Ud(ni(this._delegate))}},{key:"_throwIfRoot",value:function(e){if(""===this._delegate._location.path)throw Ch(e)}}]),e}(),ip=function(){function e(t,n){ht(this,e),this.app=t,this._delegate=n}return vt(e,[{key:"maxOperationRetryTime",get:function(){return this._delegate.maxOperationRetryTime}},{key:"maxUploadRetryTime",get:function(){return this._delegate.maxUploadRetryTime}},{key:"ref",value:function(e){if(ap(e))throw Sh("ref() expected a child path but got a URL, use refFromURL instead.");return new rp($d(this._delegate,e),this)}},{key:"refFromURL",value:function(e){if(!ap(e))throw Sh("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Ah.makeFromUrl(e,this._delegate.host)}catch(t){throw Sh("refFromUrl() expected a valid full URL but got an invalid one.")}return new rp($d(this._delegate,e),this)}},{key:"setMaxUploadRetryTime",value:function(e){this._delegate.maxUploadRetryTime=e}},{key:"setMaxOperationRetryTime",value:function(e){this._delegate.maxOperationRetryTime=e}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Xd(this._delegate,e,t,n)}}]),e}();function ap(e){return/^[A-Za-z]+:\/\//.test(e)}function op(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("storage").getImmediate({identifier:n});return new ip(r,i)}function sp(){return sp="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gt(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},sp.apply(this,arguments)}!function(e){var t={TaskState:Sd,TaskEvent:xd,StringFormat:Zh,Storage:ip,Reference:rp};e.INTERNAL.registerComponent(new ri("storage-compat",op,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.2")}(Aa);var up,cp="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},lp={},fp=fp||{},hp=cp||self;function dp(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function pp(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var vp="closure_uid_"+(1e9*Math.random()>>>0),yp=0;function mp(e,t,n){return e.call.apply(e.bind,arguments)}function gp(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function kp(e,t,n){return(kp=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mp:gp).apply(null,arguments)}function bp(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function _p(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function wp(){this.s=this.s,this.o=this.o}wp.prototype.s=!1,wp.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,vp)&&e[vp]||(e[vp]=++yp))},wp.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var xp=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Sp(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Ep(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(dp(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function Cp(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Cp.prototype.h=function(){this.defaultPrevented=!0};var Ip=function(){if(!hp.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{hp.addEventListener("test",(function(){}),t),hp.removeEventListener("test",(function(){}),t)}catch(n){}return e}();function Tp(e){return/^[\s\xa0]*$/.test(e)}function Np(){var e=hp.navigator;return e&&(e=e.userAgent)?e:""}function Ap(e){return-1!=Np().indexOf(e)}function Dp(e){return Dp[" "](e),e}Dp[" "]=function(){};var Op,Rp,Pp=Ap("Opera"),Lp=Ap("Trident")||Ap("MSIE"),jp=Ap("Edge"),Fp=jp||Lp,Mp=Ap("Gecko")&&!(-1!=Np().toLowerCase().indexOf("webkit")&&!Ap("Edge"))&&!(Ap("Trident")||Ap("MSIE"))&&!Ap("Edge"),Up=-1!=Np().toLowerCase().indexOf("webkit")&&!Ap("Edge");function Bp(){var e=hp.document;return e?e.documentMode:void 0}e:{var Vp="",zp=function(){var e=Np();return Mp?/rv:([^\);]+)(\)|;)/.exec(e):jp?/Edge\/([\d\.]+)/.exec(e):Lp?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Up?/WebKit\/(\S+)/.exec(e):Pp?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(zp&&(Vp=zp?zp[1]:""),Lp){var qp=Bp();if(null!=qp&&qp>parseFloat(Vp)){Op=String(qp);break e}}Op=Vp}if(hp.document&&Lp){var Zp=Bp();Rp=Zp||(parseInt(Op,10)||void 0)}else Rp=void 0;var Wp=Rp;function Hp(e,t){if(Cp.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Mp){e:{try{Dp(t.nodeName);var i=!0;break e}catch(We){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Kp[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Hp.$.h.call(this)}}_p(Hp,Cp);var Kp={2:"touch",3:"pen",4:"mouse"};Hp.prototype.h=function(){Hp.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Gp="closure_listenable_"+(1e6*Math.random()|0),Qp=0;function Yp(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Qp,this.fa=this.ia=!1}function $p(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Xp(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Jp(e){var t={};for(var n in e)t[n]=e[n];return t}var ev="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tv(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<ev.length;a++)n=ev[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function nv(e){this.src=e,this.g={},this.h=0}function rv(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=xp(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&($p(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function iv(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.fa&&a.listener==t&&a.capture==!!n&&a.la==r)return i}return-1}nv.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=iv(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Yp(t,this.src,a,!!r,i)).ia=n,e.push(t)),t};var av="closure_lm_"+(1e6*Math.random()|0),ov={};function sv(e,t,n,r,i){if(r&&r.once)return cv(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)sv(e,t[a],n,r,i);return null}return n=yv(n),e&&e[Gp]?e.O(t,n,pp(r)?!!r.capture:!!r,i):uv(e,t,n,!1,r,i)}function uv(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=pp(i)?!!i.capture:!!i,s=pv(e);if(s||(e[av]=s=new nv(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=dv;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Ip||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(hv(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function cv(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)cv(e,t[a],n,r,i);return null}return n=yv(n),e&&e[Gp]?e.P(t,n,pp(r)?!!r.capture:!!r,i):uv(e,t,n,!0,r,i)}function lv(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)lv(e,t[a],n,r,i);else r=pp(r)?!!r.capture:!!r,n=yv(n),e&&e[Gp]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=iv(a=e.g[t],n,r,i))&&($p(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=pv(e))&&(t=e.g[t.toString()],e=-1,t&&(e=iv(t,n,r,i)),(n=-1<e?t[e]:null)&&fv(n))}function fv(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Gp])rv(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(hv(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=pv(t))?(rv(n,e),0==n.h&&(n.src=null,t[av]=null)):$p(e)}}}function hv(e){return e in ov?ov[e]:ov[e]="on"+e}function dv(e,t){if(e.fa)e=!0;else{t=new Hp(t,this);var n=e.listener,r=e.la||e.src;e.ia&&fv(e),e=n.call(r,t)}return e}function pv(e){return(e=e[av])instanceof nv?e:null}var vv="__closure_events_fn_"+(1e9*Math.random()>>>0);function yv(e){return"function"===typeof e?e:(e[vv]||(e[vv]=function(t){return e.handleEvent(t)}),e[vv])}function mv(){wp.call(this),this.i=new nv(this),this.S=this,this.J=null}function gv(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new Cp(t,e);else if(t instanceof Cp)t.target=t.target||e;else{var i=t;tv(t=new Cp(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=kv(o,r,!0,t)&&i}if(i=kv(o=t.g=e,r,!0,t)&&i,i=kv(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=kv(o=t.g=n[a],r,!1,t)&&i}function kv(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.fa&&o.capture==n){var s=o.listener,u=o.la||o.src;o.ia&&rv(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}_p(mv,wp),mv.prototype[Gp]=!0,mv.prototype.removeEventListener=function(e,t,n,r){lv(this,e,t,n,r)},mv.prototype.N=function(){if(mv.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)$p(n[r]);delete t.g[e],t.h--}}this.J=null},mv.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},mv.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var bv=hp.JSON.stringify,_v=function(){function e(t,n){ht(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return vt(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}();function wv(){var e=Av,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var xv=function(){function e(){ht(this,e),this.h=this.g=null}return vt(e,[{key:"add",value:function(e,t){var n=Sv.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Sv=new _v((function(){return new Ev}),(function(e){return e.reset()})),Ev=function(){function e(){ht(this,e),this.next=this.g=this.h=null}return vt(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Cv(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Iv(e){hp.setTimeout((function(){throw e}),0)}var Tv,Nv=!1,Av=new xv,Dv=function(){var e=hp.Promise.resolve(void 0);Tv=function(){e.then(Ov)}},Ov=function(){for(var e;e=wv();){try{e.h.call(e.g)}catch(n){Iv(n)}var t=Sv;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Nv=!1};function Rv(e,t){mv.call(this),this.h=e||1,this.g=t||hp,this.j=kp(this.qb,this),this.l=Date.now()}function Pv(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Lv(e,t,n){if("function"===typeof e)n&&(e=kp(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=kp(e.handleEvent,e)}return 2147483647<Number(t)?-1:hp.setTimeout(e,t||0)}function jv(e){e.g=Lv((function(){e.g=null,e.i&&(e.i=!1,jv(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}_p(Rv,mv),(up=Rv.prototype).ga=!1,up.T=null,up.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),gv(this,"tick"),this.ga&&(Pv(this),this.start()))}},up.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},up.N=function(){Rv.$.N.call(this),Pv(this),delete this.g};var Fv=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return vt(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:jv(this)}},{key:"N",value:function(){sp(gt(n.prototype),"N",this).call(this),this.g&&(hp.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(wp);function Mv(e){wp.call(this),this.h=e,this.g={}}_p(Mv,wp);var Uv=[];function Bv(e,t,n,r){Array.isArray(n)||(n&&(Uv[0]=n.toString()),n=Uv);for(var i=0;i<n.length;i++){var a=sv(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function Vv(e){Xp(e.g,(function(e,t){this.g.hasOwnProperty(t)&&fv(e)}),e),e.g={}}function zv(){this.g=!0}function qv(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return bv(n)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}Mv.prototype.N=function(){Mv.$.N.call(this),Vv(this)},Mv.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},zv.prototype.Ea=function(){this.g=!1},zv.prototype.info=function(){};var Zv={},Wv=null;function Hv(){return Wv=Wv||new mv}function Kv(e){Cp.call(this,Zv.Ta,e)}function Gv(e){var t=Hv();gv(t,new Kv(t))}function Qv(e,t){Cp.call(this,Zv.STAT_EVENT,e),this.stat=t}function Yv(e){var t=Hv();gv(t,new Qv(t,e))}function $v(e,t){Cp.call(this,Zv.Ua,e),this.size=t}function Xv(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return hp.setTimeout((function(){e()}),t)}Zv.Ta="serverreachability",_p(Kv,Cp),Zv.STAT_EVENT="statevent",_p(Qv,Cp),Zv.Ua="timingevent",_p($v,Cp);var Jv={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ey={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ty(){}function ny(e){return e.h||(e.h=e.i())}function ry(){}ty.prototype.h=null;var iy,ay={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oy(){Cp.call(this,"d")}function sy(){Cp.call(this,"c")}function uy(){}function cy(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Mv(this),this.P=fy,e=Fp?125:void 0,this.V=new Rv(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ly}function ly(){this.i=null,this.g="",this.h=!1}_p(oy,Cp),_p(sy,Cp),_p(uy,ty),uy.prototype.g=function(){return new XMLHttpRequest},uy.prototype.i=function(){return{}},iy=new uy;var fy=45e3,hy={},dy={};function py(e,t,n){e.L=1,e.v=Ry(Ty(t)),e.s=n,e.S=!0,vy(e,null)}function vy(e,t){e.G=Date.now(),ky(e),e.A=Ty(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Hy(n.i,"t",r),e.C=0,n=e.l.J,e.h=new ly,e.g=Km(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Fv(kp(e.Pa,e,e.g),e.O)),Bv(e.U,e.g,"readystatechange",e.nb),t=e.I?Jp(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Gv(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function yy(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function my(e,t,n){for(var r,i=!0;!e.J&&e.C<n.length;){if((r=gy(e,n))==dy){4==t&&(e.o=4,Yv(14),i=!1),qv(e.j,e.m,null,"[Incomplete Response]");break}if(r==hy){e.o=4,Yv(15),qv(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}qv(e.j,e.m,r,null),Sy(e,r)}yy(e)&&r!=dy&&r!=hy&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Yv(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Um(t),t.M=!0,Yv(11))):(qv(e.j,e.m,n,"[Invalid Chunked Response]"),xy(e),wy(e))}function gy(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?dy:(n=Number(t.substring(n,r)),isNaN(n)?hy:(r+=1)+n>t.length?dy:(t=t.slice(r,r+n),e.C=r+n,t))}function ky(e){e.Y=Date.now()+e.P,by(e,e.P)}function by(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Xv(kp(e.lb,e),t)}function _y(e){e.B&&(hp.clearTimeout(e.B),e.B=null)}function wy(e){0==e.l.H||e.J||zm(e.l,e)}function xy(e){_y(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Pv(e.V),Vv(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Sy(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Jy(n.i,e)))if(!e.K&&Jy(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Vm(n),Dm(n)}Mm(n),Yv(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Xv(kp(n.ib,n),6e3));if(1>=Xy(n.i)&&n.oa){try{n.oa()}catch(a){}n.oa=void 0}}else Zm(n,11)}else if((e.K||n.g==e)&&Vm(n),!Tp(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.V=a[0],a=a[1],2==n.H)if("c"==a[0]){n.K=a[1],n.pa=a[2];var o=a[3];null!=o&&(n.ra=o,n.l.info("VER="+n.ra));var s=a[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));var u=a[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;f.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(f.j=f.l,f.g=new Set,f.h&&(em(f,f.h),f.h=null))}if(r.F){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.Da=h,Oy(r.I,r.F,h))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var d=e;if((r=n).wa=Hm(r,r.J?r.pa:null,r.Y),d.K){tm(r.i,d);var p=d,v=r.L;v&&p.setTimeout(v),p.B&&(_y(p),ky(p)),r.g=d}else Fm(r);0<n.j.length&&Rm(n)}else"stop"!=a[0]&&"close"!=a[0]||Zm(n,7);else 3==n.H&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Zm(n,7):Am(n):"noop"!=a[0]&&n.h&&n.h.Aa(a),n.A=0)}Gv()}catch(a){}}function Ey(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(dp(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(dp(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(dp(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(up=cy.prototype).setTimeout=function(e){this.P=e},up.nb=function(e){e=e.target;var t=this.M;t&&3==Sm(e)?t.l():this.Pa(e)},up.Pa=function(e){try{if(e==this.g)e:{var t=Sm(this.g),n=this.g.Ia();this.g.da();if(!(3>t)&&(3!=t||Fp||this.g&&(this.h.h||this.g.ja()||Em(this.g)))){this.J||4!=t||7==n||Gv(),_y(this);var r=this.g.da();this.ca=r;t:if(yy(this)){var i=Em(this.g);e="";var a=i.length,o=4==Sm(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){xy(this),wy(this);var s="";break t}this.h.i=new hp.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.W,t,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tp(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,Yv(12),xy(this),wy(this);break e}qv(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sy(this,r)}this.S?(my(this,t,s),Fp&&this.i&&3==t&&(Bv(this.U,this.V,"tick",this.mb),this.V.start())):(qv(this.j,this.m,s,null),Sy(this,s)),4==t&&xy(this),this.i&&!this.J&&(4==t?zm(this.l,this):(this.i=!1,ky(this)))}else(function(e){var t={};e=(e.g&&2<=Sm(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!Tp(e[n])){var r=Cv(e[n]),i=r[0];if("string"===typeof(r=r[1])){r=r.trim();var a=t[i]||[];t[i]=a,a.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<s.indexOf("Unknown SID")?(this.o=3,Yv(12)):(this.o=0,Yv(13)),xy(this),wy(this)}}}catch(t){}},up.mb=function(){if(this.g){var e=Sm(this.g),t=this.g.ja();this.C<t.length&&(_y(this),my(this,e,t),this.i&&4!=e&&ky(this))}},up.cancel=function(){this.J=!0,xy(this)},up.lb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Gv(),Yv(17)),xy(this),this.o=2,wy(this)):by(this,this.Y-e)};var Cy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Iy(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Iy){this.h=e.h,Ny(this,e.j),this.s=e.s,this.g=e.g,Ay(this,e.m),this.l=e.l;var t=e.i,n=new zy;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Dy(this,n),this.o=e.o}else e&&(t=String(e).match(Cy))?(this.h=!1,Ny(this,t[1]||"",!0),this.s=Py(t[2]||""),this.g=Py(t[3]||"",!0),Ay(this,t[4]),this.l=Py(t[5]||"",!0),Dy(this,t[6]||"",!0),this.o=Py(t[7]||"")):(this.h=!1,this.i=new zy(null,this.h))}function Ty(e){return new Iy(e)}function Ny(e,t,n){e.j=n?Py(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ay(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Dy(e,t,n){t instanceof zy?(e.i=t,function(e,t){t&&!e.j&&(qy(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Zy(this,t),Hy(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Ly(t,By)),e.i=new zy(t,e.h))}function Oy(e,t,n){e.i.set(t,n)}function Ry(e){return Oy(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Py(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ly(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,jy),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function jy(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Iy.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ly(t,Fy,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ly(t,Fy,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ly(n,"/"==n.charAt(0)?Uy:My,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ly(n,Vy)),e.join("")};var Fy=/[#\/\?@]/g,My=/[#\?:]/g,Uy=/[#\?]/g,By=/[#\?@]/g,Vy=/#/g;function zy(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function qy(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Zy(e,t){qy(e),t=Ky(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Wy(e,t){return qy(e),t=Ky(e,t),e.g.has(t)}function Hy(e,t,n){Zy(e,t),0<n.length&&(e.i=null,e.g.set(Ky(e,t),Sp(n)),e.h+=n.length)}function Ky(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(up=zy.prototype).add=function(e,t){qy(this),this.i=null,e=Ky(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},up.forEach=function(e,t){qy(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},up.ta=function(){qy(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},up.Z=function(e){qy(this);var t=[];if("string"===typeof e)Wy(this,e)&&(t=t.concat(this.g.get(Ky(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},up.set=function(e,t){return qy(this),this.i=null,Wy(this,e=Ky(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},up.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},up.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var Gy=vt((function e(t,n){ht(this,e),this.g=t,this.map=n}));function Qy(e){this.l=e||Yy,hp.PerformanceNavigationTiming?e=0<(e=hp.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(hp.g&&hp.g.Ka&&hp.g.Ka()&&hp.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Yy=10;function $y(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xy(e){return e.h?1:e.g?e.g.size:0}function Jy(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function em(e,t){e.g?e.g.add(t):e.h=t}function tm(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nm(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Tt(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.F)}}catch(a){r.e(a)}finally{r.f()}return n}return Sp(e.i)}Qy.prototype.cancel=function(){if(this.i=nm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Tt(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}};var rm,im=function(){function e(){ht(this,e)}return vt(e,[{key:"stringify",value:function(e){return hp.JSON.stringify(e,void 0)}},{key:"parse",value:function(e){return hp.JSON.parse(e,void 0)}}]),e}();function am(){this.g=new im}function om(e,t,n){var r=n||"";try{Ey(e,(function(e,n){var i=e;pp(e)&&(i=bv(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function sm(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(We){}}function um(e){this.l=e.fc||null,this.j=e.ob||!1}function cm(e,t){mv.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=lm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_p(um,ty),um.prototype.g=function(){return new cm(this.l,this.j)},um.prototype.i=(rm={},function(){return rm}),_p(cm,mv);var lm=0;function fm(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function hm(e){e.readyState=4,e.l=null,e.j=null,e.A=null,dm(e)}function dm(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(up=cm.prototype).open=function(e,t){if(this.readyState!=lm)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,dm(this)},up.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||hp).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},up.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,hm(this)),this.readyState=lm},up.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,dm(this)),this.g&&(this.readyState=3,dm(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof hp.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fm(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},up.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?hm(this):dm(this),3==this.readyState&&fm(this)}},up.Za=function(e){this.g&&(this.response=this.responseText=e,hm(this))},up.Ya=function(e){this.g&&(this.response=e,hm(this))},up.ka=function(){this.g&&hm(this)},up.setRequestHeader=function(e,t){this.v.append(e,t)},up.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},up.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(cm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var pm=hp.JSON.parse;function vm(e){mv.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ym,this.L=this.M=!1}_p(vm,mv);var ym="",mm=/^https?$/i,gm=["POST","PUT"];function km(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,bm(e),wm(e)}function bm(e){e.F||(e.F=!0,gv(e,"complete"),gv(e,"error"))}function _m(e){if(e.h&&"undefined"!=typeof fp&&(!e.C[1]||4!=Sm(e)||2!=e.da()))if(e.v&&4==Sm(e))Lv(e.La,0,e);else if(gv(e,"readystatechange"),4==Sm(e)){e.h=!1;try{var t,n=e.da();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.I).match(Cy)[1]||null;!a&&hp.self&&hp.self.location&&(a=hp.self.location.protocol.slice(0,-1)),i=!mm.test(a?a.toLowerCase():"")}t=i}if(t)gv(e,"complete"),gv(e,"success");else{e.m=6;try{var o=2<Sm(e)?e.g.statusText:""}catch(s){o=""}e.j=o+" ["+e.da()+"]",bm(e)}}finally{wm(e)}}}function wm(e,t){if(e.g){xm(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||gv(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function xm(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(hp.clearTimeout(e.A),e.A=null)}function Sm(e){return e.g?e.g.readyState:0}function Em(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case ym:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(E){return null}}function Cm(e){var t="";return Xp(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Im(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Cm(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Oy(e,t,n))}function Tm(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Nm(e){this.Ga=0,this.j=[],this.l=new zv,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Tm("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Tm("baseRetryDelayMs",5e3,e),this.hb=Tm("retryDelaySeedMs",1e4,e),this.eb=Tm("forwardChannelMaxRetries",2,e),this.xa=Tm("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Qy(e&&e.concurrentRequestLimit),this.Ja=new am,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Am(e){if(Om(e),3==e.H){var t=e.W++,n=Ty(e.I);if(Oy(n,"SID",e.K),Oy(n,"RID",t),Oy(n,"TYPE","terminate"),Lm(e,n),(t=new cy(e,e.l,t)).L=2,t.v=Ry(Ty(n)),n=!1,hp.navigator&&hp.navigator.sendBeacon)try{n=hp.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&hp.Image&&((new Image).src=t.v,n=!0),n||(t.g=Km(t.l,null),t.g.ha(t.v)),t.G=Date.now(),ky(t)}Wm(e)}function Dm(e){e.g&&(Um(e),e.g.cancel(),e.g=null)}function Om(e){Dm(e),e.u&&(hp.clearTimeout(e.u),e.u=null),Vm(e),e.i.cancel(),e.m&&("number"===typeof e.m&&hp.clearTimeout(e.m),e.m=null)}function Rm(e){if(!$y(e.i)&&!e.m){e.m=!0;var t=e.Na;Tv||Dv(),Nv||(Tv(),Nv=!0),Av.add(t,e),e.C=0}}function Pm(e,t){var n;n=t?t.m:e.W++;var r=Ty(e.I);Oy(r,"SID",e.K),Oy(r,"RID",n),Oy(r,"AID",e.V),Lm(e,r),e.o&&e.s&&Im(r,e.o,e.s),n=new cy(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=jm(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),em(e.i,n),py(n,r,t)}function Lm(e,t){e.na&&Xp(e.na,(function(e,n){Oy(t,n,e)})),e.h&&Ey({},(function(e,n){Oy(t,n,e)}))}function jm(e,t,n){n=Math.min(e.j.length,n);var r=e.h?kp(e.h.Va,e.h,e):null;e:for(var i=e.j,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].g,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].g,l=i[u].map;if(0>(c-=a))a=Math.max(0,i[u].g-100),s=!1;else try{om(l,o,"req"+c+"_")}catch(B){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.j.splice(0,n),t.F=e,r}function Fm(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Tv||Dv(),Nv||(Tv(),Nv=!0),Av.add(t,e),e.A=0}}function Mm(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Xv(kp(e.Ma,e),qm(e,e.A)),e.A++,!0)}function Um(e){null!=e.B&&(hp.clearTimeout(e.B),e.B=null)}function Bm(e){e.g=new cy(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ty(e.wa);Oy(t,"RID","rpc"),Oy(t,"SID",e.K),Oy(t,"AID",e.V),Oy(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Oy(t,"TO",e.qa),Oy(t,"TYPE","xmlhttp"),Lm(e,t),e.o&&e.s&&Im(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Ry(Ty(t)),n.s=null,n.S=!0,vy(n,e)}function Vm(e){null!=e.v&&(hp.clearTimeout(e.v),e.v=null)}function zm(e,t){var n=null;if(e.g==t){Vm(e),Um(e),e.g=null;var r=2}else{if(!Jy(e.i,t))return;n=t.F,tm(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;gv(r=Hv(),new $v(r,n)),Rm(e)}else Fm(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(Xy(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Xv(kp(e.Na,e,t),qm(e,e.C)),e.C++,!0))}(e,t)||2==r&&Mm(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Zm(e,5);break;case 4:Zm(e,10);break;case 3:Zm(e,6);break;default:Zm(e,2)}}function qm(e,t){var n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Zm(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=kp(e.pb,e);n||(n=new Iy("//www.google.com/images/cleardot.gif"),hp.location&&"http"==hp.location.protocol||Ny(n,"https"),Ry(n)),function(e,t){var n=new zv;if(hp.Image){var r=new Image;r.onload=bp(sm,n,r,"TestLoadImage: loaded",!0,t),r.onerror=bp(sm,n,r,"TestLoadImage: error",!1,t),r.onabort=bp(sm,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=bp(sm,n,r,"TestLoadImage: timeout",!1,t),hp.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Yv(2);e.H=0,e.h&&e.h.za(t),Wm(e),Om(e)}function Wm(e){if(e.H=0,e.ma=[],e.h){var t=nm(e.i);0==t.length&&0==e.j.length||(Ep(e.ma,t),Ep(e.ma,e.j),e.i.i.length=0,Sp(e.j),e.j.length=0),e.h.ya()}}function Hm(e,t,n){var r=n instanceof Iy?Ty(n):new Iy(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Ay(r,r.m);else{var i=hp.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new Iy(null);r&&Ny(a,r),t&&(a.g=t),i&&Ay(a,i),n&&(a.l=n),r=a}return n=e.F,t=e.Da,n&&t&&Oy(r,n,t),Oy(r,"VER",e.ra),Lm(e,r),r}function Km(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new vm(new um({ob:!0})):new vm(e.va)).Oa(e.J),t}function Gm(){}function Qm(){if(Lp&&!(10<=Number(Wp)))throw Error("Environmental error: no available transport.")}function Ym(e,t){mv.call(this),this.g=new Nm(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Tp(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Tp(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Jm(this)}function $m(e){oy.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Xm(){sy.call(this),this.status=1}function Jm(e){this.g=e}function eg(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function tg(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],o=t+(a^n&(i^a))+r[0]+3614090360&4294967295;o=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(o<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((a=(t=n+((o=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=a+((o=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function ng(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}(up=vm.prototype).Oa=function(e){this.M=e},up.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():iy.g(),this.C=this.u?ny(this.u):ny(iy),this.g.onreadystatechange=kp(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void km(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var a,o=Tt(r.keys());try{for(o.s();!(a=o.n()).done;){var s=a.value;n.set(s,r.get(s))}}catch(p){o.e(p)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),i=hp.FormData&&e instanceof hp.FormData,!(0<=xp(gm,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var c,l=Tt(n);try{for(l.s();!(c=l.n()).done;){var f=(0,u.Z)(c.value,2),h=f[0],d=f[1];this.g.setRequestHeader(h,d)}}catch(p){l.e(p)}finally{l.f()}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{xm(this),0<this.B&&((this.L=function(e){return Lp&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=kp(this.ua,this)):this.A=Lv(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){km(this,s)}},up.ua=function(){"undefined"!=typeof fp&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,gv(this,"timeout"),this.abort(8))},up.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,gv(this,"complete"),gv(this,"abort"),wm(this))},up.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wm(this,!0)),vm.$.N.call(this)},up.La=function(){this.s||(this.G||this.v||this.l?_m(this):this.kb())},up.kb=function(){_m(this)},up.isActive=function(){return!!this.g},up.da=function(){try{return 2<Sm(this)?this.g.status:-1}catch(rm){return-1}},up.ja=function(){try{return this.g?this.g.responseText:""}catch(rm){return""}},up.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),pm(t)}},up.Ia=function(){return this.m},up.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(up=Nm.prototype).ra=8,up.H=1,up.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new cy(this,this.l,e),n=this.s;if(this.U&&(n?tv(n=Jp(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,i=0;i<this.j.length;i++){var a=this.j[i];if(void 0===(a="__data__"in a.map&&"string"===typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.j.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=jm(this,t,r),Oy(i=Ty(this.I),"RID",e),Oy(i,"CVER",22),this.F&&Oy(i,"X-HTTP-Session-Id",this.F),Lm(this,i),n&&(this.O?r="headers="+encodeURIComponent(String(Cm(n)))+"&"+r:this.o&&Im(i,this.o,n)),em(this.i,t),this.bb&&Oy(i,"TYPE","init"),this.P?(Oy(i,"$req",r),Oy(i,"SID","null"),t.aa=!0,py(t,i,null)):py(t,i,r),this.H=2}}else 3==this.H&&(e?Pm(this,e):0==this.j.length||$y(this.i)||Pm(this))},up.Ma=function(){if(this.u=null,Bm(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Xv(kp(this.jb,this),e)}},up.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Yv(10),Dm(this),Bm(this))},up.ib=function(){null!=this.v&&(this.v=null,Dm(this),Mm(this),Yv(19))},up.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Yv(2)):(this.l.info("Failed to ping google.com"),Yv(1))},up.isActive=function(){return!!this.h&&this.h.isActive(this)},(up=Gm.prototype).Ba=function(){},up.Aa=function(){},up.za=function(){},up.ya=function(){},up.isActive=function(){return!0},up.Va=function(){},Qm.prototype.g=function(e,t){return new Ym(e,t)},_p(Ym,mv),Ym.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Yv(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Hm(e,null,e.Y),Rm(e)},Ym.prototype.close=function(){Am(this.g)},Ym.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=bv(e),e=n);t.j.push(new Gy(t.fb++,e)),3==t.H&&Rm(t)},Ym.prototype.N=function(){this.g.h=null,delete this.j,Am(this.g),delete this.g,Ym.$.N.call(this)},_p($m,oy),_p(Xm,sy),_p(Jm,Gm),Jm.prototype.Ba=function(){gv(this.g,"a")},Jm.prototype.Aa=function(e){gv(this.g,new $m(e))},Jm.prototype.za=function(e){gv(this.g,new Xm)},Jm.prototype.ya=function(){gv(this.g,"b")},_p(eg,(function(){this.blockSize=-1})),eg.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},eg.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,a=0;a<t;){if(0==i)for(;a<=n;)tg(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(r[i++]=e.charCodeAt(a++),i==this.blockSize){tg(this,r),i=0;break}}else for(;a<t;)if(r[i++]=e[a++],i==this.blockSize){tg(this,r),i=0;break}}this.h=i,this.i+=t},eg.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var rg={};function ig(e){return-128<=e&&128>e?function(e,t){var n=rg;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new ng([0|e],0>e?-1:0)})):new ng([0|e],0>e?-1:0)}function ag(e){if(isNaN(e)||!isFinite(e))return sg;if(0>e)return hg(ag(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=og;return new ng(t,0)}var og=4294967296,sg=ig(0),ug=ig(1),cg=ig(16777216);function lg(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function fg(e){return-1==e.h}function hg(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new ng(n,~e.h).add(ug)}function dg(e,t){return e.add(hg(t))}function pg(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function vg(e,t){this.g=e,this.h=t}function yg(e,t){if(lg(t))throw Error("division by zero");if(lg(e))return new vg(sg,sg);if(fg(e))return t=yg(hg(e),t),new vg(hg(t.g),hg(t.h));if(fg(t))return t=yg(e,hg(t)),new vg(hg(t.g),t.h);if(30<e.g.length){if(fg(e)||fg(t))throw Error("slowDivide_ only works with positive integers.");for(var n=ug,r=t;0>=r.X(e);)n=mg(n),r=mg(r);var i=gg(n,1),a=gg(r,1);for(r=gg(r,2),n=gg(n,2);!lg(r);){var o=a.add(r);0>=o.X(e)&&(i=i.add(n),a=o),r=gg(r,1),n=gg(n,1)}return t=dg(e,i.R(t)),new vg(i,t)}for(i=sg;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(a=ag(n)).R(t);fg(o)||0<o.X(e);)o=(a=ag(n-=r)).R(t);lg(a)&&(a=ug),i=i.add(a),e=dg(e,o)}return new vg(i,e)}function mg(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new ng(n,e.h)}function gg(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.D(a+n)>>>t|e.D(a+n+1)<<32-t:e.D(a+n);return new ng(i,e.h)}(up=ng.prototype).ea=function(){if(fg(this))return-hg(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:og+r)*t,t*=og}return e},up.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(lg(this))return"0";if(fg(this))return"-"+hg(this).toString(e);for(var t=ag(Math.pow(e,6)),n=this,r="";;){var i=yg(n,t).g,a=((0<(n=dg(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(lg(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},up.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},up.X=function(e){return fg(e=dg(this,e))?-1:lg(e)?0:1},up.abs=function(){return fg(this)?hg(this):this},up.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.D(i))+(65535&e.D(i)),o=(a>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new ng(n,-2147483648&n[n.length-1]?-1:0)},up.R=function(e){if(lg(this)||lg(e))return sg;if(fg(this))return fg(e)?hg(this).R(hg(e)):hg(hg(this).R(e));if(fg(e))return hg(this.R(hg(e)));if(0>this.X(cg)&&0>e.X(cg))return ag(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.D(r)>>>16,o=65535&this.D(r),s=e.D(i)>>>16,u=65535&e.D(i);n[2*r+2*i]+=o*u,pg(n,2*r+2*i),n[2*r+2*i+1]+=a*u,pg(n,2*r+2*i+1),n[2*r+2*i+1]+=o*s,pg(n,2*r+2*i+1),n[2*r+2*i+2]+=a*s,pg(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new ng(n,0)},up.gb=function(e){return yg(this,e).h},up.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new ng(n,this.h&e.h)},up.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new ng(n,this.h|e.h)},up.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new ng(n,this.h^e.h)},Qm.prototype.createWebChannel=Qm.prototype.g,Ym.prototype.send=Ym.prototype.u,Ym.prototype.open=Ym.prototype.m,Ym.prototype.close=Ym.prototype.close,Jv.NO_ERROR=0,Jv.TIMEOUT=8,Jv.HTTP_ERROR=6,ey.COMPLETE="complete",ry.EventType=ay,ay.OPEN="a",ay.CLOSE="b",ay.ERROR="c",ay.MESSAGE="d",mv.prototype.listen=mv.prototype.O,vm.prototype.listenOnce=vm.prototype.P,vm.prototype.getLastError=vm.prototype.Sa,vm.prototype.getLastErrorCode=vm.prototype.Ia,vm.prototype.getStatus=vm.prototype.da,vm.prototype.getResponseJson=vm.prototype.Wa,vm.prototype.getResponseText=vm.prototype.ja,vm.prototype.send=vm.prototype.ha,vm.prototype.setWithCredentials=vm.prototype.Oa,eg.prototype.digest=eg.prototype.l,eg.prototype.reset=eg.prototype.reset,eg.prototype.update=eg.prototype.j,ng.prototype.add=ng.prototype.add,ng.prototype.multiply=ng.prototype.R,ng.prototype.modulo=ng.prototype.gb,ng.prototype.compare=ng.prototype.X,ng.prototype.toNumber=ng.prototype.ea,ng.prototype.toString=ng.prototype.toString,ng.prototype.getBits=ng.prototype.D,ng.fromNumber=ag,ng.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return hg(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=ag(Math.pow(n,8)),i=sg,a=0;a<t.length;a+=8){var o=Math.min(8,t.length-a),s=parseInt(t.substring(a,a+o),n);8>o?(o=ag(Math.pow(n,o)),i=i.R(o).add(ag(s))):i=(i=i.R(r)).add(ag(s))}return i};var kg=lp.createWebChannelTransport=function(){return new Qm},bg=lp.getStatEventTarget=function(){return Hv()},_g=lp.ErrorCode=Jv,wg=lp.EventType=ey,xg=lp.Event=Zv,Sg=lp.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Eg=lp.FetchXmlHttpFactory=um,Cg=lp.WebChannel=ry,Ig=lp.XhrIo=vm,Tg=lp.Md5=eg,Ng=lp.Integer=ng,Ag="@firebase/firestore",Dg=function(){function e(t){ht(this,e),this.uid=t}return vt(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Dg.UNAUTHENTICATED=new Dg(null),Dg.GOOGLE_CREDENTIALS=new Dg("google-credentials-uid"),Dg.FIRST_PARTY=new Dg("first-party-uid"),Dg.MOCK_USER=new Dg("mock-user");var Og="9.22.2",Rg=new pi("@firebase/firestore");function Pg(){return Rg.logLevel}function Lg(e){if(Rg.logLevel<=si.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mg);Rg.debug.apply(Rg,["Firestore (".concat(Og,"): ").concat(e)].concat(ft(i)))}}function jg(e){if(Rg.logLevel<=si.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mg);Rg.error.apply(Rg,["Firestore (".concat(Og,"): ").concat(e)].concat(ft(i)))}}function Fg(e){if(Rg.logLevel<=si.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mg);Rg.warn.apply(Rg,["Firestore (".concat(Og,"): ").concat(e)].concat(ft(i)))}}function Mg(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Ug(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Og,") INTERNAL ASSERTION FAILED: ")+e;throw jg(t),new Error(t)}function Bg(e,t){e||Ug()}function Vg(e,t){return e}var zg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qg=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return vt(n)}(Lr),Zg=vt((function e(){var t=this;ht(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Wg=vt((function e(t,n){ht(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Hg=function(){function e(){ht(this,e)}return vt(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Dg.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Kg=function(){function e(t){ht(this,e),this.token=t,this.changeListener=null}return vt(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),Gg=function(){function e(t){ht(this,e),this.t=t,this.currentUser=Dg.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return vt(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new Zg;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new Zg,e.enqueueRetryable((function(){return i(n.currentUser)}))};var u=function(){var t=a;e.enqueueRetryable((0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},c=function(e){Lg("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),u()};this.t.onInit((function(e){return c(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?c(e):(Lg("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Zg)}}),0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Lg("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Bg("string"==typeof n.accessToken),new Wg(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Bg(null===e||"string"==typeof e),new Dg(e)}}]),e}(),Qg=function(){function e(t,n,r){ht(this,e),this.h=t,this.l=n,this.m=r,this.type="FirstParty",this.user=Dg.FIRST_PARTY,this.g=new Map}return vt(e,[{key:"p",value:function(){return this.m?this.m():null}},{key:"headers",get:function(){this.g.set("X-Goog-AuthUser",this.h);var e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}]),e}(),Yg=function(){function e(t,n,r){ht(this,e),this.h=t,this.l=n,this.m=r}return vt(e,[{key:"getToken",value:function(){return Promise.resolve(new Qg(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Dg.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),$g=vt((function e(t){ht(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Xg=function(){function e(t){ht(this,e),this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}return vt(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Lg("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.T;return n.T=e.token,Lg("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){Lg("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.I.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.I.getImmediate({optional:!0});e?i(e):Lg("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Bg("string"==typeof t.token),e.T=t.token,new $g(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Jg(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var ek=function(){function e(){ht(this,e)}return vt(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62),n="";n.length<20;)for(var r=Jg(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62));return n}}]),e}();function tk(e,t){return e<t?-1:e>t?1:0}function nk(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function rk(e){return e+"\0"}var ik=function(){function e(t,n){if(ht(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new qg(zg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new qg(zg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new qg(zg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qg(zg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return vt(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?tk(this.nanoseconds,e.nanoseconds):tk(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),ak=function(){function e(t){ht(this,e),this.timestamp=t}return vt(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new ik(0,0))}},{key:"max",value:function(){return new e(new ik(253402300799,999999999))}}]),e}(),ok=function(){function e(t,n,r){ht(this,e),void 0===n?n=0:n>t.length&&Ug(),void 0===r?r=t.length-n:r>t.length-n&&Ug(),this.segments=t,this.offset=n,this.len=r}return vt(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),sk=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new qg(zg.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,ft(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(ok),uk=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ck=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return uk.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new qg(zg.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new qg(zg.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qg(zg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new qg(zg.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(ok),lk=function(){function e(t){ht(this,e),this.path=t}return vt(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===sk.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(sk.fromString(t))}},{key:"fromName",value:function(t){return new e(sk.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(sk.emptyPath())}},{key:"comparator",value:function(e,t){return sk.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new sk(t.slice()))}}]),e}(),fk=vt((function e(t,n,r,i){ht(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function hk(e){return e.fields.find((function(e){return 2===e.kind}))}function dk(e){return e.fields.filter((function(e){return 2!==e.kind}))}fk.UNKNOWN_ID=-1;var pk=vt((function e(t,n){ht(this,e),this.fieldPath=t,this.kind=n}));var vk=function(){function e(t,n){ht(this,e),this.sequenceNumber=t,this.offset=n}return vt(e,null,[{key:"empty",value:function(){return new e(0,gk.min())}}]),e}();function yk(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ak.fromTimestamp(1e9===r?new ik(n+1,0):new ik(n,r));return new gk(i,lk.empty(),t)}function mk(e){return new gk(e.readTime,e.key,-1)}var gk=function(){function e(t,n,r){ht(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return vt(e,null,[{key:"min",value:function(){return new e(ak.min(),lk.empty(),-1)}},{key:"max",value:function(){return new e(ak.max(),lk.empty(),-1)}}]),e}();function kk(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=lk.comparator(e.documentKey,t.documentKey))?n:tk(e.largestBatchId,t.largestBatchId)}var bk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_k=function(){function e(){ht(this,e),this.onCommittedListeners=[]}return vt(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function wk(e){return xk.apply(this,arguments)}function xk(){return(xk=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===zg.FAILED_PRECONDITION&&t.message===bk){e.next=2;break}throw t;case 2:Lg("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Sk=function(){function e(t){var n=this;ht(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return vt(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Ug(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Tt(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(){var s=u;n(t[s]).next((function(t){a[s]=t,++o===i&&e(a)}),(function(e){return r(e)}))},u=0;u<i;u++)s()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function i(){!0===t()?n().next((function(){i()}),r):e()}()}))}}]),e}(),Ek=function(){function e(t,n){var r=this;ht(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.v=new Zg,this.transaction.oncomplete=function(){r.v.resolve()},this.transaction.onabort=function(){n.error?r.v.reject(new Tk(t,n.error)):r.v.resolve()},this.transaction.onerror=function(e){var n=Rk(e.target.error);r.v.reject(new Tk(t,n))}}return vt(e,[{key:"R",get:function(){return this.v.promise}},{key:"abort",value:function(e){e&&this.v.reject(e),this.aborted||(Lg("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"P",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Ak(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Tk(n,t)}}}]),e}(),Ck=function(){function e(t,n,r){ht(this,e),this.name=t,this.version=n,this.V=r,12.2===e.S(Ar())&&jg("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return vt(e,[{key:"$",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Lg("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Tk(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new qg(zg.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new qg(zg.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Tk(t,n))},i.onupgradeneeded=function(e){Lg("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.V.O(t,i.transaction,e.oldVersion,n.version).next((function(){Lg("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.F&&(this.db.onversionchange=function(e){return n.F(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"B",value:function(e){this.F=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){var a,s,u,c,l=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,s=0,u=(0,o.Z)().mark((function e(){var n,u,c,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++s,e.prev=1,e.next=4,l.$(t);case 4:return l.db=e.sent,n=Ek.open(l.db,t,a?"readonly":"readwrite",r),u=i(n).next((function(e){return n.P(),e})).catch((function(e){return n.abort(e),Sk.reject(e)})).toPromise(),u.catch((function(){})),e.next=9,n.R;case 9:return e.t0=u,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),c=e.t1,f="FirebaseError"!==c.name&&s<3,Lg("SimpleDb","Transaction failed with error:",c.message,"Retrying:",f),l.close(),f){e.next=18;break}return e.abrupt("return",{v:Promise.reject(c)});case 18:case"end":return e.stop()}}),e,null,[[1,13]])}));case 3:return e.delegateYield(u(),"t0",4);case 4:if("object"!==typeof(c=e.t0)){e.next=7;break}return e.abrupt("return",c.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Lg("SimpleDb","Removing database:",e),Dk(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"D",value:function(){if(!Pr())return!1;if(e.C())return!0;var t=Ar(),n=e.S(t),r=0<n&&n<10,i=e.N(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"C",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"/social-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.k)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"S",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"N",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),Ik=function(){function e(t){ht(this,e),this.L=t,this.q=!1,this.U=null}return vt(e,[{key:"isDone",get:function(){return this.q}},{key:"K",get:function(){return this.U}},{key:"cursor",set:function(e){this.L=e}},{key:"done",value:function(){this.q=!0}},{key:"G",value:function(e){this.U=e}},{key:"delete",value:function(){return Dk(this.L.delete())}}]),e}(),Tk=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,zg.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return vt(n)}(qg);function Nk(e){return"IndexedDbTransactionError"===e.name}var Ak=function(){function e(t){ht(this,e),this.store=t}return vt(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Lg("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Lg("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Dk(n)}},{key:"add",value:function(e){return Lg("SimpleDb","ADD",this.store.name,e,e),Dk(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Dk(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Lg("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Lg("SimpleDb","DELETE",this.store.name,e),Dk(this.store.delete(e))}},{key:"count",value:function(){return Lg("SimpleDb","COUNT",this.store.name),Dk(this.store.count())}},{key:"j",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.W(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Sk((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"H",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Sk((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){Lg("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Y=!1;var r=this.cursor(n);return this.W(r,(function(e,t,n){return n.delete()}))}},{key:"X",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.W(r,t)}},{key:"Z",value:function(e){var t=this.cursor({});return new Sk((function(n,r){t.onerror=function(e){var t=Rk(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"W",value:function(e,t){var n=[];return new Sk((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Ik(i),o=t(i.primaryKey,i.value,a);if(o instanceof Sk){var s=o.catch((function(e){return a.done(),Sk.reject(e)}));n.push(s)}a.isDone?r():null===a.K?i.continue():i.continue(a.K)}else r()}})).next((function(){return Sk.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Dk(e){return new Sk((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Rk(e.target.error);n(t)}}))}var Ok=!1;function Rk(e){var t=Ck.S(Ar());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new qg("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Ok||(Ok=!0,setTimeout((function(){throw r}),0)),r}}return e}var Pk=function(){function e(t,n){ht(this,e),this.asyncQueue=t,this.tt=n,this.task=null}return vt(e,[{key:"start",value:function(){this.et(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"et",value:function(e){var t=this;Lg("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Lg,e.t1="Documents written: ",e.next=6,t.tt.nt();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!Nk(e.t4)){e.next=17;break}Lg("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,wk(e.t4);case 19:return e.next=21,t.et(6e4);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),Lk=function(){function e(t,n){ht(this,e),this.localStore=t,this.persistence=n}return vt(e,[{key:"nt",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n=this,r=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.st(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"st",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Sk.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Lg("IndexBackiller","Processing collection: ".concat(t)),n.it(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"it",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next((function(){return r.rt(i,n)})).next((function(n){return Lg("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return a.size}))}))}))}},{key:"rt",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=mk(t);kk(r,n)>0&&(n=r)})),new gk(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),jk=function(){function e(t,n){var r=this;ht(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ot(e)},this.ut=function(e){return n.writeSequenceNumber(e)})}return vt(e,[{key:"ot",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ut&&this.ut(e),e}}]),e}();function Fk(e){return null==e}function Mk(e){return 0===e&&1/e==-1/0}function Uk(e){return"number"==typeof e&&Number.isInteger(e)&&!Mk(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Bk(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=zk(t)),t=Vk(e.get(n),t);return zk(t)}function Vk(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function zk(e){return e+"\x01\x01"}function qk(e){var t=e.length;if(Bg(t>=2),2===t)return Bg("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),sk.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&Ug(),e.charAt(o+1)){case"\x01":var s=e.substring(a,o),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:Ug()}a=o+2}return new sk(r)}jk.ct=-1;var Zk=["userId","batchId"];function Wk(e,t){return[e,Bk(t)]}function Hk(e,t,n){return[e,Bk(t),n]}var Kk={},Gk=["prefixPath","collectionGroup","readTime","documentId"],Qk=["prefixPath","collectionGroup","documentId"],Yk=["collectionGroup","readTime","prefixPath","documentId"],$k=["canonicalId","targetId"],Xk=["targetId","path"],Jk=["path","targetId"],eb=["collectionId","parent"],tb=["indexId","uid"],nb=["uid","sequenceNumber"],rb=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ib=["indexId","uid","orderedDocumentKey"],ab=["userId","collectionPath","documentId"],ob=["userId","collectionPath","largestBatchId"],sb=["userId","collectionGroup","largestBatchId"],ub=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),cb=[].concat(ft(ub),["documentOverlays"]),lb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fb=lb,hb=[].concat(fb,["indexConfiguration","indexState","indexEntries"]),db=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).ht=e,i.currentSequenceNumber=r,i}return vt(n)}(_k);function pb(e,t){var n=Vg(e);return Ck.M(n.ht,t)}function vb(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function yb(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function mb(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var gb=function(){function e(t,n){ht(this,e),this.comparator=t,this.root=n||bb.EMPTY}return vt(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,bb.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bb.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new kb(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new kb(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new kb(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new kb(this.root,e,this.comparator,!0)}}]),e}(),kb=function(){function e(t,n,r,i){ht(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return vt(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),bb=function(){function e(t,n,r,i,a){ht(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return vt(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Ug();if(this.right.isRed())throw Ug();var e=this.left.check();if(e!==this.right.check())throw Ug();return e+(this.isRed()?0:1)}}]),e}();bb.EMPTY=null,bb.RED=!0,bb.BLACK=!1,bb.EMPTY=new(function(){function e(){ht(this,e),this.size=0}return vt(e,[{key:"key",get:function(){throw Ug()}},{key:"value",get:function(){throw Ug()}},{key:"color",get:function(){throw Ug()}},{key:"left",get:function(){throw Ug()}},{key:"right",get:function(){throw Ug()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new bb(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var _b=function(){function e(t){ht(this,e),this.comparator=t,this.data=new gb(this.comparator)}return vt(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new wb(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new wb(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),wb=function(){function e(t){ht(this,e),this.iter=t}return vt(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function xb(e){return e.hasNext()?e.getNext():void 0}var Sb=function(){function e(t){ht(this,e),this.fields=t,t.sort(ck.comparator)}return vt(e,[{key:"unionWith",value:function(t){var n,r=new _b(ck.comparator),i=Tt(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=Tt(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=Tt(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return nk(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),Eb=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),(e=t.apply(this,arguments)).name="Base64DecodeError",e}return vt(n)}(St(Error));var Cb=function(e){function t(e){ht(this,t),this.binaryString=e}return vt(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return tk(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){var n=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Eb("Invalid base64 string: "+e):e}}(e);return new t(n)}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();Cb.EMPTY_BYTE_STRING=new Cb("");var Ib=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tb(e){if(Bg(!!e),"string"==typeof e){var t=0,n=Ib.exec(e);if(Bg(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Nb(e.seconds),nanos:Nb(e.nanos)}}function Nb(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ab(e){return"string"==typeof e?Cb.fromBase64String(e):Cb.fromUint8Array(e)}function Db(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ob(e){var t=e.mapValue.fields.__previous_value__;return Db(t)?Ob(t):t}function Rb(e){var t=Tb(e.mapValue.fields.__local_write_time__.timestampValue);return new ik(t.seconds,t.nanos)}var Pb=vt((function e(t,n,r,i,a,o,s,u,c){ht(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=u,this.useFetchStreams=c})),Lb=function(){function e(t,n){ht(this,e),this.projectId=t,this.database=n||"(default)"}return vt(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}(),jb={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Fb={nullValue:"NULL_VALUE"};function Mb(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Db(e)?4:Xb(e)?9007199254740991:10:Ug()}function Ub(e,t){if(e===t)return!0;var n=Mb(e);if(n!==Mb(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Rb(e).isEqual(Rb(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Tb(e.timestampValue),r=Tb(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ab(e.bytesValue).isEqual(Ab(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Nb(e.geoPointValue.latitude)===Nb(t.geoPointValue.latitude)&&Nb(e.geoPointValue.longitude)===Nb(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Nb(e.integerValue)===Nb(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Nb(e.doubleValue),r=Nb(t.doubleValue);return n===r?Mk(n)===Mk(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return nk(e.arrayValue.values||[],t.arrayValue.values||[],Ub);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(vb(n)!==vb(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ub(n[i],r[i])))return!1;return!0}(e,t);default:return Ug()}}function Bb(e,t){return void 0!==(e.values||[]).find((function(e){return Ub(e,t)}))}function Vb(e,t){if(e===t)return 0;var n=Mb(e),r=Mb(t);if(n!==r)return tk(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tk(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Nb(e.integerValue||e.doubleValue),r=Nb(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return zb(e.timestampValue,t.timestampValue);case 4:return zb(Rb(e),Rb(t));case 5:return tk(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Ab(e),r=Ab(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=tk(n[i],r[i]);if(0!==a)return a}return tk(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=tk(Nb(e.latitude),Nb(t.latitude));return 0!==n?n:tk(Nb(e.longitude),Nb(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=Vb(n[i],r[i]);if(a)return a}return tk(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===jb.mapValue&&t===jb.mapValue)return 0;if(e===jb.mapValue)return 1;if(t===jb.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=tk(r[o],a[o]);if(0!==s)return s;var u=Vb(n[r[o]],i[a[o]]);if(0!==u)return u}return tk(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Ug()}}function zb(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return tk(e,t);var n=Tb(e),r=Tb(t),i=tk(n.seconds,r.seconds);return 0!==i?i:tk(n.nanos,r.nanos)}function qb(e){return Zb(e)}function Zb(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Tb(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ab(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,lk.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Tt(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=Zb(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Tt(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(Zb(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):Ug();var t,n}function Wb(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Hb(e){return!!e&&"integerValue"in e}function Kb(e){return!!e&&"arrayValue"in e}function Gb(e){return!!e&&"nullValue"in e}function Qb(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Yb(e){return!!e&&"mapValue"in e}function $b(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return yb(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=$b(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=$b(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Xb(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Jb(e){return"nullValue"in e?Fb:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Wb(Lb.empty(),lk.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Ug()}function e_(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Wb(Lb.empty(),lk.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?jb:Ug()}function t_(e,t){var n=Vb(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function n_(e,t){var n=Vb(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var r_=function(){function e(t){ht(this,e),this.value=t}return vt(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Yb(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$b(t)}},{key:"setAll",value:function(e){var t=this,n=ck.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=$b(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());Yb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Ub(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Yb(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){yb(t,(function(t,n){return e[t]=n}));var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e($b(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function i_(e){var t=[];return yb(e.fields,(function(e,n){var r=new ck([e]);if(Yb(n)){var i=i_(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Tt(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)})),new Sb(t)}var a_=function(){function e(t,n,r,i,a,o,s){ht(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=s}return vt(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(ak.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=r_.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=r_.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=ak.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,ak.min(),ak.min(),ak.min(),r_.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,ak.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,ak.min(),ak.min(),r_.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,ak.min(),ak.min(),r_.empty(),2)}}]),e}(),o_=vt((function e(t,n){ht(this,e),this.position=t,this.inclusive=n}));function s_(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?lk.comparator(lk.fromName(o.referenceValue),n.key):Vb(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function u_(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Ub(e.position[n],t.position[n]))return!1;return!0}var c_=vt((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";ht(this,e),this.field=t,this.dir=n}));function l_(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var f_=vt((function e(){ht(this,e)})),h_=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return vt(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Vb(t,this.value)):null!==t&&Mb(this.value)===Mb(t)&&this.matchesComparison(Vb(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ug()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new w_(e,t,r):"array-contains"===t?new C_(e,r):"in"===t?new I_(e,r):"not-in"===t?new T_(e,r):"array-contains-any"===t?new N_(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new x_(e,n):new S_(e,n)}}]),n}(f_),d_=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).filters=e,i.op=r,i.lt=null,i}return vt(n,[{key:"matches",value:function(e){return p_(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.lt||(this.lt=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.lt}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.ft((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"ft",value:function(e){var t,n=Tt(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(f_);function p_(e){return"and"===e.op}function v_(e){return"or"===e.op}function y_(e){return m_(e)&&p_(e)}function m_(e){var t,n=Tt(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof d_)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function g_(e){if(e instanceof h_)return e.field.canonicalString()+e.op.toString()+qb(e.value);if(y_(e))return e.filters.map((function(e){return g_(e)})).join(",");var t=e.filters.map((function(e){return g_(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function k_(e,t){return e instanceof h_?function(e,t){return t instanceof h_&&e.op===t.op&&e.field.isEqual(t.field)&&Ub(e.value,t.value)}(e,t):e instanceof d_?function(e,t){return t instanceof d_&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&k_(n,t.filters[r])}),!0)}(e,t):void Ug()}function b_(e,t){var n=e.filters.concat(t);return d_.create(n,e.op)}function __(e){return e instanceof h_?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(qb(e.value))}(e):e instanceof d_?function(e){return e.op.toString()+" {"+e.getFilters().map(__).join(" ,")+"}"}(e):"Filter"}var w_=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this,e,r,i)).key=lk.fromName(i.referenceValue),a}return vt(n,[{key:"matches",value:function(e){var t=lk.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(h_),x_=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,"in",r)).keys=E_("in",r),i}return vt(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(h_),S_=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,"not-in",r)).keys=E_("not-in",r),i}return vt(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(h_);function E_(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return lk.fromName(e.referenceValue)}))}var C_=function(e){mt(n,e);var t=wt(n);function n(e,r){return ht(this,n),t.call(this,e,"array-contains",r)}return vt(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return Kb(t)&&Bb(t.arrayValue,this.value)}}]),n}(h_),I_=function(e){mt(n,e);var t=wt(n);function n(e,r){return ht(this,n),t.call(this,e,"in",r)}return vt(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Bb(this.value.arrayValue,t)}}]),n}(h_),T_=function(e){mt(n,e);var t=wt(n);function n(e,r){return ht(this,n),t.call(this,e,"not-in",r)}return vt(n,[{key:"matches",value:function(e){if(Bb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Bb(this.value.arrayValue,t)}}]),n}(h_),N_=function(e){mt(n,e);var t=wt(n);function n(e,r){return ht(this,n),t.call(this,e,"array-contains-any",r)}return vt(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!Kb(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Bb(t.value.arrayValue,e)}))}}]),n}(h_),A_=vt((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;ht(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.dt=null}));function D_(e){return new A_(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function O_(e){var t=Vg(e);if(null===t.dt){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return g_(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Fk(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return qb(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return qb(e)})).join(",")),t.dt=n}return t.dt}function R_(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!l_(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!k_(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!u_(e.startAt,t.startAt)&&u_(e.endAt,t.endAt)}function P_(e){return lk.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function L_(e,t){return e.filters.filter((function(e){return e instanceof h_&&e.field.isEqual(t)}))}function j_(e,t,n){var r,i=Fb,a=!0,o=Tt(L_(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,u=Fb,c=!0;switch(s.op){case"<":case"<=":u=Jb(s.value);break;case"==":case"in":case">=":u=s.value;break;case">":u=s.value,c=!1;break;case"!=":case"not-in":u=Fb}t_({value:i,inclusive:a},{value:u,inclusive:c})<0&&(i=u,a=c)}}catch(h){o.e(h)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];t_({value:i,inclusive:a},{value:f,inclusive:n.inclusive})<0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}function F_(e,t,n){var r,i=jb,a=!0,o=Tt(L_(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,u=jb,c=!0;switch(s.op){case">=":case">":u=e_(s.value),c=!1;break;case"==":case"in":case"<=":u=s.value;break;case"<":u=s.value,c=!1;break;case"!=":case"not-in":u=jb}n_({value:i,inclusive:a},{value:u,inclusive:c})>0&&(i=u,a=c)}}catch(h){o.e(h)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];n_({value:i,inclusive:a},{value:f,inclusive:n.inclusive})>0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}var M_=vt((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;ht(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.wt=null,this._t=null,this.startAt,this.endAt}));function U_(e,t,n,r,i,a,o,s){return new M_(e,t,n,r,i,a,o,s)}function B_(e){return new M_(e)}function V_(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function z_(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function q_(e){var t,n=Tt(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function Z_(e){return null!==e.collectionGroup}function W_(e){var t=Vg(e);if(null===t.wt){t.wt=[];var n=q_(t),r=z_(t);if(null!==n&&null===r)n.isKeyField()||t.wt.push(new c_(n)),t.wt.push(new c_(ck.keyField(),"asc"));else{var i,a=!1,o=Tt(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.wt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new c_(ck.keyField(),u))}}}return t.wt}function H_(e){var t=Vg(e);if(!t._t)if("F"===t.limitType)t._t=D_(t.path,t.collectionGroup,W_(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Tt(W_(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new c_(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var s=t.endAt?new o_(t.endAt.position,t.endAt.inclusive):null,u=t.startAt?new o_(t.startAt.position,t.startAt.inclusive):null;t._t=D_(t.path,t.collectionGroup,r,t.filters,t.limit,s,u)}return t._t}function K_(e,t){t.getFirstInequalityField(),q_(e);var n=e.filters.concat([t]);return new M_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function G_(e,t,n){return new M_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Q_(e,t){return R_(H_(e),H_(t))&&e.limitType===t.limitType}function Y_(e){return"".concat(O_(H_(e)),"|lt:").concat(e.limitType)}function $_(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return __(e)})).join(", "),"]")),Fk(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return qb(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return qb(e)})).join(",")),"Target(".concat(t,")")}(H_(e)),"; limitType=").concat(e.limitType,")")}function X_(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):lk.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Tt(W_(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Tt(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=s_(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,W_(e),t))&&!(e.endAt&&!function(e,t,n){var r=s_(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,W_(e),t))}(e,t)}function J_(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ew(e){return function(t,n){var r,i=!1,a=Tt(W_(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=tw(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function tw(e,t,n){var r=e.field.isKeyField()?lk.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Vb(r,i):Ug()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ug()}}var nw=function(){function e(t,n){ht(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return vt(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=(0,u.Z)(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(c){i.e(c)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){yb(this.inner,(function(t,n){var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=(0,u.Z)(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(c){i.e(c)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return mb(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),rw=new gb(lk.comparator);function iw(){return rw}var aw=new gb(lk.comparator);function ow(){for(var e=aw,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function sw(e){var t=aw;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function uw(){return lw()}function cw(){return lw()}function lw(){return new nw((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var fw=new gb(lk.comparator),hw=new _b(lk.comparator);function dw(){for(var e=hw,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var pw=new _b(tk);function vw(){return pw}function yw(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mk(t)?"-0":t}}function mw(e){return{integerValue:""+e}}function gw(e,t){return Uk(t)?mw(t):yw(e,t)}var kw=vt((function e(){ht(this,e),this._=void 0}));function bw(e,t,n){return e instanceof xw?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Db(t)&&(t=Ob(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Sw?Ew(e,t):e instanceof Cw?Iw(e,t):function(e,t){var n=ww(e,t),r=Nw(n)+Nw(e.gt);return Hb(n)&&Hb(e.gt)?mw(r):yw(e.serializer,r)}(e,t)}function _w(e,t,n){return e instanceof Sw?Ew(e,t):e instanceof Cw?Iw(e,t):n}function ww(e,t){return e instanceof Tw?Hb(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var xw=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n)}(kw),Sw=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).elements=e,r}return vt(n)}(kw);function Ew(e,t){var n,r=Aw(t),i=Tt(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return Ub(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Cw=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).elements=e,r}return vt(n)}(kw);function Iw(e,t){var n,r=Aw(t),i=Tt(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!Ub(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Tw=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).serializer=e,i.gt=r,i}return vt(n)}(kw);function Nw(e){return Nb(e.integerValue||e.doubleValue)}function Aw(e){return Kb(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Dw=vt((function e(t,n){ht(this,e),this.field=t,this.transform=n}));var Ow=vt((function e(t,n){ht(this,e),this.version=t,this.transformResults=n})),Rw=function(){function e(t,n){ht(this,e),this.updateTime=t,this.exists=n}return vt(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Pw(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Lw=vt((function e(){ht(this,e)}));function jw(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Gw(e.key,Rw.none()):new Vw(e.key,e.data,Rw.none());var n,r=e.data,i=r_.empty(),a=new _b(ck.comparator),o=Tt(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new zw(e.key,i,new Sb(a.toArray()),Rw.none())}function Fw(e,t,n){e instanceof Vw?function(e,t,n){var r=e.value.clone(),i=Zw(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof zw?function(e,t,n){if(Pw(e.precondition,t)){var r=Zw(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(qw(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Mw(e,t,n,r){return e instanceof Vw?function(e,t,n,r){if(!Pw(e.precondition,t))return n;var i=e.value.clone(),a=Ww(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof zw?function(e,t,n,r){if(!Pw(e.precondition,t))return n;var i=Ww(e.fieldTransforms,r,t),a=t.data;return a.setAll(qw(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Pw(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Uw(e,t){var n,r=null,i=Tt(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=ww(a.transform,o||null);null!=s&&(null===r&&(r=r_.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function Bw(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&nk(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Sw&&t instanceof Sw||e instanceof Cw&&t instanceof Cw?nk(e.elements,t.elements,Ub):e instanceof Tw&&t instanceof Tw?Ub(e.gt,t.gt):e instanceof xw&&t instanceof xw}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Vw=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return ht(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return vt(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Lw),zw=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return ht(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return vt(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Lw);function qw(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Zw(e,t,n){var r=new Map;Bg(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,_w(o,s,n[i]))}return r}function Ww(e,t,n){var r,i=new Map,a=Tt(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,bw(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Hw,Kw,Gw=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return vt(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Lw),Qw=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return vt(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Lw),Yw=function(){function e(t,n,r,i){ht(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return vt(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Fw(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=Tt(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Mw(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=Tt(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=Mw(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=cw();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=jw(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(ak.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),dw())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&nk(this.mutations,e.mutations,(function(e,t){return Bw(e,t)}))&&nk(this.baseMutations,e.baseMutations,(function(e,t){return Bw(e,t)}))}}]),e}(),$w=function(){function e(t,n,r,i){ht(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return vt(e,null,[{key:"from",value:function(t,n,r){Bg(t.mutations.length===r.length);for(var i=fw,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),Xw=function(){function e(t,n){ht(this,e),this.largestBatchId=t,this.mutation=n}return vt(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Jw=vt((function e(t,n){ht(this,e),this.count=t,this.unchangedNames=n}));function ex(e){switch(e){default:return Ug();case zg.CANCELLED:case zg.UNKNOWN:case zg.DEADLINE_EXCEEDED:case zg.RESOURCE_EXHAUSTED:case zg.INTERNAL:case zg.UNAVAILABLE:case zg.UNAUTHENTICATED:return!1;case zg.INVALID_ARGUMENT:case zg.NOT_FOUND:case zg.ALREADY_EXISTS:case zg.PERMISSION_DENIED:case zg.FAILED_PRECONDITION:case zg.ABORTED:case zg.OUT_OF_RANGE:case zg.UNIMPLEMENTED:case zg.DATA_LOSS:return!0}}function tx(e){if(void 0===e)return jg("GRPC error has no .code"),zg.UNKNOWN;switch(e){case Hw.OK:return zg.OK;case Hw.CANCELLED:return zg.CANCELLED;case Hw.UNKNOWN:return zg.UNKNOWN;case Hw.DEADLINE_EXCEEDED:return zg.DEADLINE_EXCEEDED;case Hw.RESOURCE_EXHAUSTED:return zg.RESOURCE_EXHAUSTED;case Hw.INTERNAL:return zg.INTERNAL;case Hw.UNAVAILABLE:return zg.UNAVAILABLE;case Hw.UNAUTHENTICATED:return zg.UNAUTHENTICATED;case Hw.INVALID_ARGUMENT:return zg.INVALID_ARGUMENT;case Hw.NOT_FOUND:return zg.NOT_FOUND;case Hw.ALREADY_EXISTS:return zg.ALREADY_EXISTS;case Hw.PERMISSION_DENIED:return zg.PERMISSION_DENIED;case Hw.FAILED_PRECONDITION:return zg.FAILED_PRECONDITION;case Hw.ABORTED:return zg.ABORTED;case Hw.OUT_OF_RANGE:return zg.OUT_OF_RANGE;case Hw.UNIMPLEMENTED:return zg.UNIMPLEMENTED;case Hw.DATA_LOSS:return zg.DATA_LOSS;default:return Ug()}}(Kw=Hw||(Hw={}))[Kw.OK=0]="OK",Kw[Kw.CANCELLED=1]="CANCELLED",Kw[Kw.UNKNOWN=2]="UNKNOWN",Kw[Kw.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kw[Kw.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kw[Kw.NOT_FOUND=5]="NOT_FOUND",Kw[Kw.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kw[Kw.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kw[Kw.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kw[Kw.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kw[Kw.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kw[Kw.ABORTED=10]="ABORTED",Kw[Kw.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kw[Kw.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kw[Kw.INTERNAL=13]="INTERNAL",Kw[Kw.UNAVAILABLE=14]="UNAVAILABLE",Kw[Kw.DATA_LOSS=15]="DATA_LOSS";var nx=function(){function e(){ht(this,e),this.onExistenceFilterMismatchCallbacks=new Map}return vt(e,[{key:"onExistenceFilterMismatch",value:function(e){var t=this,n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),function(){return t.onExistenceFilterMismatchCallbacks.delete(n)}}},{key:"notifyOnExistenceFilterMismatch",value:function(e){this.onExistenceFilterMismatchCallbacks.forEach((function(t){return t(e)}))}}],[{key:"instance",get:function(){return rx}},{key:"getOrCreateInstance",value:function(){return null===rx&&(rx=new e),rx}}]),e}(),rx=null;function ix(){return new TextEncoder}var ax=new Ng([4294967295,4294967295],0);function ox(e){var t=ix().encode(e),n=new Tg;return n.update(t),new Uint8Array(n.digest())}function sx(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Ng([n,r],0),new Ng([i,a],0)]}var ux=function(){function e(t,n,r){if(ht(this,e),this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new cx("Invalid padding: ".concat(n));if(r<0)throw new cx("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new cx("Invalid hash count: ".concat(r));if(0===t.length&&0!==n)throw new cx("Invalid padding when bitmap length is 0: ".concat(n));this.It=8*t.length-n,this.Tt=Ng.fromNumber(this.It)}return vt(e,[{key:"Et",value:function(e,t,n){var r=e.add(t.multiply(Ng.fromNumber(n)));return 1===r.compare(ax)&&(r=new Ng([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}},{key:"At",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"vt",value:function(e){if(0===this.It)return!1;for(var t=sx(ox(e)),n=(0,u.Z)(t,2),r=n[0],i=n[1],a=0;a<this.hashCount;a++){var o=this.Et(r,i,a);if(!this.At(o))return!1}return!0}},{key:"insert",value:function(e){if(0!==this.It)for(var t=sx(ox(e)),n=(0,u.Z)(t,2),r=n[0],i=n[1],a=0;a<this.hashCount;a++){var o=this.Et(r,i,a);this.Rt(o)}}},{key:"Rt",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(t,n,r){var i=t%8==0?0:8-t%8,a=new e(new Uint8Array(Math.ceil(t/8)),i,n);return r.forEach((function(e){return a.insert(e)})),a}}]),e}(),cx=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),(e=t.apply(this,arguments)).name="BloomFilterError",e}return vt(n)}(St(Error)),lx=function(){function e(t,n,r,i,a){ht(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return vt(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,fx.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(ak.min(),i,new gb(tk),iw(),dw())}}]),e}(),fx=function(){function e(t,n,r,i,a){ht(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return vt(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,dw(),dw(),dw())}}]),e}(),hx=vt((function e(t,n,r,i){ht(this,e),this.Pt=t,this.removedTargetIds=n,this.key=r,this.bt=i})),dx=vt((function e(t,n){ht(this,e),this.targetId=t,this.Vt=n})),px=vt((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cb.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;ht(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),vx=function(){function e(){ht(this,e),this.St=0,this.Dt=gx(),this.Ct=Cb.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}return vt(e,[{key:"current",get:function(){return this.xt}},{key:"resumeToken",get:function(){return this.Ct}},{key:"kt",get:function(){return 0!==this.St}},{key:"Mt",get:function(){return this.Nt}},{key:"$t",value:function(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}},{key:"Ot",value:function(){var e=dw(),t=dw(),n=dw();return this.Dt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ug()}})),new fx(this.Ct,this.xt,e,t,n)}},{key:"Ft",value:function(){this.Nt=!1,this.Dt=gx()}},{key:"Bt",value:function(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}},{key:"Lt",value:function(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}},{key:"qt",value:function(){this.St+=1}},{key:"Ut",value:function(){this.St-=1}},{key:"Kt",value:function(){this.Nt=!0,this.xt=!0}}]),e}(),yx=function(){function e(t){ht(this,e),this.Gt=t,this.Qt=new Map,this.jt=iw(),this.zt=mx(),this.Wt=new gb(tk)}return vt(e,[{key:"Ht",value:function(e){var t,n=Tt(e.Pt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.bt&&e.bt.isFoundDocument()?this.Jt(r,e.bt):this.Yt(r,e.key,e.bt)}}catch(s){n.e(s)}finally{n.f()}var i,a=Tt(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Yt(o,e.key,e.bt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Xt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Zt(n);switch(e.state){case 0:t.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||t.removeTarget(n);break;case 3:t.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:t.te(n)&&(t.ee(n),r.$t(e.resumeToken));break;default:Ug()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((function(e,r){n.te(r)&&t(r)}))}},{key:"ne",value:function(e){var t,n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){var a=i.target;if(P_(a))if(0===r){var o=new lk(a.path);this.Yt(n,o,a_.newNoDocument(o,ak.min()))}else Bg(1===r);else{var s=this.ie(n);if(s!==r){var u=this.re(e,s);if(0!==u){this.ee(n);var c=2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,c)}null===(t=nx.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,a,o,s,u,c={localCacheCount:t,existenceFilterCount:n.count},l=n.unchangedNames;return l&&(c.bloomFilter={applied:0===e,hashCount:null!==(r=null==l?void 0:l.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(a=null===(i=null==l?void 0:l.bits)||void 0===i?void 0:i.bitmap)||void 0===a?void 0:a.length)&&void 0!==o?o:0,padding:null!==(u=null===(s=null==l?void 0:l.bits)||void 0===s?void 0:s.padding)&&void 0!==u?u:0}),c}(u,s,e.Vt))}}}}},{key:"re",value:function(e,t){var n=e.Vt,r=n.unchangedNames,i=n.count;if(!r||!r.bits)return 1;var a,o,s=r.bits,u=s.bitmap,c=void 0===u?"":u,l=s.padding,f=void 0===l?0:l,h=r.hashCount,d=void 0===h?0:h;try{a=Ab(c).toUint8Array()}catch(e){if(e instanceof Eb)return Fg("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{o=new ux(a,f,d)}catch(e){return Fg(e instanceof cx?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===o.It?1:i!==t-this.oe(e.targetId,o)?2:0}},{key:"oe",value:function(e,t){var n=this,r=this.Gt.getRemoteKeysForTarget(e),i=0;return r.forEach((function(r){var a=n.Gt.ue(),o="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(r.path.canonicalString());t.vt(o)||(n.Yt(e,r,null),i++)})),i}},{key:"ce",value:function(e){var t=this,n=new Map;this.Qt.forEach((function(r,i){var a=t.se(i);if(a){if(r.current&&P_(a.target)){var o=new lk(a.target.path);null!==t.jt.get(o)||t.ae(i,o)||t.Yt(i,o,a_.newNoDocument(o,e))}r.Mt&&(n.set(i,r.Ot()),r.Ft())}}));var r=dw();this.zt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.se(e);return!n||"TargetPurposeLimboResolution"===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.jt.forEach((function(t,n){return n.setReadTime(e)}));var i=new lx(e,n,this.Wt,this.jt,r);return this.jt=iw(),this.zt=mx(),this.Wt=new gb(tk),i}},{key:"Jt",value:function(e,t){if(this.te(e)){var n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}}},{key:"Yt",value:function(e,t,n){if(this.te(e)){var r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Qt.delete(e)}},{key:"ie",value:function(e){var t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"qt",value:function(e){this.Zt(e).qt()}},{key:"Zt",value:function(e){var t=this.Qt.get(e);return t||(t=new vx,this.Qt.set(e,t)),t}},{key:"he",value:function(e){var t=this.zt.get(e);return t||(t=new _b(tk),this.zt=this.zt.insert(e,t)),t}},{key:"te",value:function(e){var t=null!==this.se(e);return t||Lg("WatchChangeAggregator","Detected inactive target",e),t}},{key:"se",value:function(e){var t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}},{key:"ee",value:function(e){var t=this;this.Qt.set(e,new vx),this.Gt.getRemoteKeysForTarget(e).forEach((function(n){t.Yt(e,n,null)}))}},{key:"ae",value:function(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}]),e}();function mx(){return new gb(lk.comparator)}function gx(){return new gb(lk.comparator)}var kx={asc:"ASCENDING",desc:"DESCENDING"},bx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_x={and:"AND",or:"OR"},wx=vt((function e(t,n){ht(this,e),this.databaseId=t,this.useProto3Json=n}));function xx(e,t){return e.useProto3Json||Fk(t)?t:{value:t}}function Sx(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ex(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Cx(e,t){return Sx(e,t.toTimestamp())}function Ix(e){return Bg(!!e),ak.fromTimestamp(function(e){var t=Tb(e);return new ik(t.seconds,t.nanos)}(e))}function Tx(e,t){return function(e){return new sk(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Nx(e){var t=sk.fromString(e);return Bg(Xx(t)),t}function Ax(e,t){return Tx(e.databaseId,t.path)}function Dx(e,t){var n=Nx(t);if(n.get(1)!==e.databaseId.projectId)throw new qg(zg.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new qg(zg.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new lk(Lx(n))}function Ox(e,t){return Tx(e.databaseId,t)}function Rx(e){var t=Nx(e);return 4===t.length?sk.emptyPath():Lx(t)}function Px(e){return new sk(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Lx(e){return Bg(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function jx(e,t,n){return{name:Ax(e,t),fields:n.value.mapValue.fields}}function Fx(e,t,n){var r=Dx(e,t.name),i=Ix(t.updateTime),a=t.createTime?Ix(t.createTime):ak.min(),o=new r_({mapValue:{fields:t.fields}}),s=a_.newFoundDocument(r,i,a,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Mx(e,t){return"found"in t?function(e,t){Bg(!!t.found),t.found.name,t.found.updateTime;var n=Dx(e,t.found.name),r=Ix(t.found.updateTime),i=t.found.createTime?Ix(t.found.createTime):ak.min(),a=new r_({mapValue:{fields:t.found.fields}});return a_.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){Bg(!!t.missing),Bg(!!t.readTime);var n=Dx(e,t.missing),r=Ix(t.readTime);return a_.newNoDocument(n,r)}(e,t):Ug()}function Ux(e,t){var n;if(t instanceof Vw)n={update:jx(e,t.key,t.value)};else if(t instanceof Gw)n={delete:Ax(e,t.key)};else if(t instanceof zw)n={update:jx(e,t.key,t.data),updateMask:$x(t.fieldMask)};else{if(!(t instanceof Qw))return Ug();n={verify:Ax(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof xw)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Sw)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Cw)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Tw)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Ug()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Cx(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ug()}(e,t.precondition)),n}function Bx(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Rw.updateTime(Ix(e.updateTime)):void 0!==e.exists?Rw.exists(e.exists):Rw.none()}(t.currentDocument):Rw.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)Bg("REQUEST_TIME"===t.setToServerValue),n=new xw;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Sw(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Cw(i)}else"increment"in t?n=new Tw(e,t.increment):Ug();var a=ck.fromServerFormat(t.fieldPath);return new Dw(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=Dx(e,t.update.name),a=new r_({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Sb(t.map((function(e){return ck.fromServerFormat(e)})))}(t.updateMask);return new zw(i,a,o,n,r)}return new Vw(i,a,n,r)}if(t.delete){var s=Dx(e,t.delete);return new Gw(s,n)}if(t.verify){var u=Dx(e,t.verify);return new Qw(u,n)}return Ug()}function Vx(e,t){return{documents:[Ox(e,t.path)]}}function zx(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Ox(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Ox(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return Yx(d_.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:Gx(e.field),direction:Wx(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s=xx(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function qx(e){var t=Rx(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Bg(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=function(e){var t=Zx(e);return t instanceof d_&&y_(t)?t.getFilters():[t]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new c_(Qx(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var u=null;n.limit&&(u=function(e){var t;return Fk(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new o_(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new o_(n,t)}(n.endAt)),U_(t,i,s,o,u,"F",c,l)}function Zx(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Qx(e.unaryFilter.field);return h_.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Qx(e.unaryFilter.field);return h_.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qx(e.unaryFilter.field);return h_.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Qx(e.unaryFilter.field);return h_.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ug()}}(e):void 0!==e.fieldFilter?function(e){return h_.create(Qx(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ug()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return d_.create(e.compositeFilter.filters.map((function(e){return Zx(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ug()}}(e.compositeFilter.op))}(e):Ug()}function Wx(e){return kx[e]}function Hx(e){return bx[e]}function Kx(e){return _x[e]}function Gx(e){return{fieldPath:e.canonicalString()}}function Qx(e){return ck.fromServerFormat(e.fieldPath)}function Yx(e){return e instanceof h_?function(e){if("=="===e.op){if(Qb(e.value))return{unaryFilter:{field:Gx(e.field),op:"IS_NAN"}};if(Gb(e.value))return{unaryFilter:{field:Gx(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Qb(e.value))return{unaryFilter:{field:Gx(e.field),op:"IS_NOT_NAN"}};if(Gb(e.value))return{unaryFilter:{field:Gx(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gx(e.field),op:Hx(e.op),value:e.value}}}(e):e instanceof d_?function(e){var t=e.getFilters().map((function(e){return Yx(e)}));return 1===t.length?t[0]:{compositeFilter:{op:Kx(e.op),filters:t}}}(e):Ug()}function $x(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function Xx(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var Jx=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ak.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ak.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Cb.EMPTY_BYTE_STRING,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;ht(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=u}return vt(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}},{key:"withExpectedCount",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}]),e}(),eS=vt((function e(t){ht(this,e),this.fe=t}));function tS(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:nS(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Ax(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Sx(e,t.version.toTimestamp()),createTime:Sx(e,t.createTime.toTimestamp())}}(e.fe,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:rS(t.version)};else{if(!t.isUnknownDocument())return Ug();r.unknownDocument={path:n.path.toArray(),version:rS(t.version)}}return r}function nS(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function rS(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function iS(e){var t=new ik(e.seconds,e.nanoseconds);return ak.fromTimestamp(t)}function aS(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Bx(e.fe,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Bx(e.fe,t)})),s=ik.fromMillis(t.localWriteTimeMs);return new Yw(t.batchId,s,n,o)}function oS(e){var t,n,r=iS(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?iS(e.lastLimboFreeSnapshotVersion):ak.min();return void 0!==e.query.documents?(Bg(1===(n=e.query).documents.length),t=H_(B_(Rx(n.documents[0])))):t=function(e){return H_(qx(e))}(e.query),new Jx(t,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,i,Cb.fromBase64String(e.resumeToken))}function sS(e,t){var n,r=rS(t.snapshotVersion),i=rS(t.lastLimboFreeSnapshotVersion);n=P_(t.target)?Vx(e.fe,t.target):zx(e.fe,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:O_(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function uS(e){var t=qx({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?G_(t,t.limit,"L"):t}function cS(e,t){return new Xw(t.largestBatchId,Bx(e.fe,t.overlayMutation))}function lS(e,t){var n=t.path.lastSegment();return[e,Bk(t.path.popLast()),n]}function fS(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:rS(r.readTime),documentKey:Bk(r.documentKey.path),largestBatchId:r.largestBatchId}}var hS=function(){function e(){ht(this,e)}return vt(e,[{key:"getBundleMetadata",value:function(e,t){return dS(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:iS(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return dS(e).put({bundleId:(n=t).id,createTime:rS(Ix(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return pS(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:uS(t.bundledQuery),readTime:iS(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return pS(e).put(function(e){return{name:e.name,readTime:rS(Ix(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function dS(e){return pb(e,"bundles")}function pS(e){return pb(e,"namedQueries")}var vS=function(){function e(t,n){ht(this,e),this.serializer=t,this.userId=n}return vt(e,[{key:"getOverlay",value:function(e,t){var n=this;return yS(e).get(lS(this.userId,t)).next((function(e){return e?cS(n.serializer,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=uw();return Sk.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new Xw(t,a);i.push(r.we(e,o))})),Sk.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(Bk(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(yS(e).J("collectionPathOverlayIndex",i))})),Sk.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=uw(),a=Bk(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return yS(e).j("collectionPathOverlayIndex",o).next((function(e){var t,n=Tt(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=cS(r.serializer,a);i.set(o.getKey(),o)}}catch(s){n.e(s)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=uw(),s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return yS(e).X({index:"collectionGroupOverlayIndex",range:s},(function(e,t,n){var s=cS(a.serializer,t);o.size()<r||s.largestBatchId===i?(o.set(s.getKey(),s),i=s.largestBatchId):n.done()})).next((function(){return o}))}},{key:"we",value:function(e,t){return yS(e).put(function(e,t,n){var r=lS(t,n.mutation.key),i=(0,u.Z)(r,3);i[0];return{userId:t,collectionPath:i[1],documentId:i[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Ux(e.fe,n.mutation)}}(this.serializer,this.userId,t))}}],[{key:"de",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function yS(e){return pb(e,"documentOverlays")}var mS=function(){function e(){ht(this,e)}return vt(e,[{key:"_e",value:function(e,t){this.me(e,t),t.ge()}},{key:"me",value:function(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Nb(e.integerValue));else if("doubleValue"in e){var n=Nb(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Mk(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie("".concat(r.seconds||"")),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Ab(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ye(t,45),t.pe(i.latitude||0),t.pe(i.longitude||0)}else"mapValue"in e?Xb(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Ug()}},{key:"Te",value:function(e,t){this.ye(t,25),this.be(e,t)}},{key:"be",value:function(e,t){t.Ie(e)}},{key:"Re",value:function(e,t){var n=e.fields||{};this.ye(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.Te(a,t),this.me(n[a],t)}}},{key:"Pe",value:function(e,t){var n=e.values||[];this.ye(t,50);var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.me(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"ve",value:function(e,t){var n=this;this.ye(t,37),lk.fromName(e).path.forEach((function(e){n.ye(t,60),n.be(e,t)}))}},{key:"ye",value:function(e,t){e.pe(t)}},{key:"Ee",value:function(e){e.pe(2)}}]),e}();function gS(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function kS(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=gS(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}mS.Ve=new mS;var bS=function(){function e(){ht(this,e),this.buffer=new Uint8Array(1024),this.position=0}return vt(e,[{key:"Se",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.De(n.value),n=t.next();this.Ce()}},{key:"xe",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ne(n.value),n=t.next();this.ke()}},{key:"Me",value:function(e){var t,n=Tt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.De(i);else if(i<2048)this.De(960|i>>>6),this.De(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.De(480|i>>>12),this.De(128|63&i>>>6),this.De(128|63&i);else{var a=r.codePointAt(0);this.De(240|a>>>18),this.De(128|63&a>>>12),this.De(128|63&a>>>6),this.De(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Ce()}},{key:"$e",value:function(e){var t,n=Tt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ne(i);else if(i<2048)this.Ne(960|i>>>6),this.Ne(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ne(480|i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i);else{var a=r.codePointAt(0);this.Ne(240|a>>>18),this.Ne(128|63&a>>>12),this.Ne(128|63&a>>>6),this.Ne(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.ke()}},{key:"Oe",value:function(e){var t=this.Fe(e),n=kS(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"Le",value:function(e){var t=this.Fe(e),n=kS(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"qe",value:function(){this.Ue(255),this.Ue(255)}},{key:"Ke",value:function(){this.Ge(255),this.Ge(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Qe",value:function(){return this.buffer.slice(0,this.position)}},{key:"Fe",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"De",value:function(e){var t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}},{key:"Ne",value:function(e){var t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}},{key:"Ce",value:function(){this.Ue(0),this.Ue(1)}},{key:"ke",value:function(){this.Ge(0),this.Ge(1)}},{key:"Ue",value:function(e){this.Be(1),this.buffer[this.position++]=e}},{key:"Ge",value:function(e){this.Be(1),this.buffer[this.position++]=~e}},{key:"Be",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),_S=function(){function e(t){ht(this,e),this.je=t}return vt(e,[{key:"Ae",value:function(e){this.je.Se(e)}},{key:"Ie",value:function(e){this.je.Me(e)}},{key:"pe",value:function(e){this.je.Oe(e)}},{key:"ge",value:function(){this.je.qe()}}]),e}(),wS=function(){function e(t){ht(this,e),this.je=t}return vt(e,[{key:"Ae",value:function(e){this.je.xe(e)}},{key:"Ie",value:function(e){this.je.$e(e)}},{key:"pe",value:function(e){this.je.Le(e)}},{key:"ge",value:function(){this.je.Ke()}}]),e}(),xS=function(){function e(){ht(this,e),this.je=new bS,this.ze=new _S(this.je),this.We=new wS(this.je)}return vt(e,[{key:"seed",value:function(e){this.je.seed(e)}},{key:"He",value:function(e){return 0===e?this.ze:this.We}},{key:"Qe",value:function(){return this.je.Qe()}},{key:"reset",value:function(){this.je.reset()}}]),e}(),SS=function(){function e(t,n,r,i){ht(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return vt(e,[{key:"Je",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function ES(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=CS(e.arrayValue,t.arrayValue))?n:0!==(n=CS(e.directionalValue,t.directionalValue))?n:lk.comparator(e.documentKey,t.documentKey)}function CS(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var IS=function(){function e(t){ht(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ye=t.orderBy,this.Xe=[];var n,r=Tt(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.Ze=i:this.Xe.push(i)}}catch(a){r.e(a)}finally{r.f()}}return vt(e,[{key:"tn",value:function(e){Bg(e.collectionGroup===this.collectionId);var t=hk(e);if(void 0!==t&&!this.en(t))return!1;for(var n=dk(e),r=new Set,i=0,a=0;i<n.length&&this.en(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){var o=n[i];if(!this.nn(this.Ze,o)||!this.sn(this.Ye[a++],o))return!1}++i}for(;i<n.length;++i){var s=n[i];if(a>=this.Ye.length||!this.sn(this.Ye[a++],s))return!1}return!0}},{key:"en",value:function(e){var t,n=Tt(this.Xe);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.nn(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"nn",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"sn",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function TS(e){var t,n;if(Bg(e instanceof h_||e instanceof d_),e instanceof h_){if(e instanceof I_){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return h_.create(e.field,"==",t)})))||[];return d_.create(r,"or")}return e}var i=e.filters.map((function(e){return TS(e)}));return d_.create(i,e.op)}function NS(e){if(0===e.getFilters().length)return[];var t=RS(TS(e));return Bg(OS(t)),AS(t)||DS(t)?[t]:t.getFilters()}function AS(e){return e instanceof h_}function DS(e){return e instanceof d_&&y_(e)}function OS(e){return AS(e)||DS(e)||function(e){if(e instanceof d_&&v_(e)){var t,n=Tt(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!AS(r)&&!DS(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function RS(e){if(Bg(e instanceof h_||e instanceof d_),e instanceof h_)return e;if(1===e.filters.length)return RS(e.filters[0]);var t=e.filters.map((function(e){return RS(e)})),n=d_.create(t,e.op);return OS(n=jS(n))?n:(Bg(n instanceof d_),Bg(p_(n)),Bg(n.filters.length>1),n.filters.reduce((function(e,t){return PS(e,t)})))}function PS(e,t){var n;return Bg(e instanceof h_||e instanceof d_),Bg(t instanceof h_||t instanceof d_),n=e instanceof h_?t instanceof h_?function(e,t){return d_.create([e,t],"and")}(e,t):LS(e,t):t instanceof h_?LS(t,e):function(e,t){if(Bg(e.filters.length>0&&t.filters.length>0),p_(e)&&p_(t))return b_(e,t.getFilters());var n=v_(e)?e:t,r=v_(e)?t:e,i=n.filters.map((function(e){return PS(e,r)}));return d_.create(i,"or")}(e,t),jS(n)}function LS(e,t){if(p_(t))return b_(t,e.getFilters());var n=t.filters.map((function(t){return PS(e,t)}));return d_.create(n,"or")}function jS(e){if(Bg(e instanceof h_||e instanceof d_),e instanceof h_)return e;var t=e.getFilters();if(1===t.length)return jS(t[0]);if(m_(e))return e;var n=t.map((function(e){return jS(e)})),r=[];return n.forEach((function(t){t instanceof h_?r.push(t):t instanceof d_&&(t.op===e.op?r.push.apply(r,ft(t.filters)):r.push(t))})),1===r.length?r[0]:d_.create(r,e.op)}var FS=function(){function e(){ht(this,e),this.rn=new MS}return vt(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.rn.add(t),Sk.resolve()}},{key:"getCollectionParents",value:function(e,t){return Sk.resolve(this.rn.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Sk.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Sk.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Sk.resolve(null)}},{key:"getIndexType",value:function(e,t){return Sk.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Sk.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Sk.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Sk.resolve(gk.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Sk.resolve(gk.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Sk.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Sk.resolve()}}]),e}(),MS=function(){function e(){ht(this,e),this.index={}}return vt(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new _b(sk.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new _b(sk.comparator)).toArray()}}]),e}(),US=new Uint8Array(0),BS=function(){function e(t,n){ht(this,e),this.user=t,this.databaseId=n,this.on=new MS,this.un=new nw((function(e){return O_(e)}),(function(e,t){return R_(e,t)})),this.uid=t.uid||""}return vt(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.on.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.on.add(t)}));var a={collectionId:r,parent:Bk(i)};return VS(e).put(a)}return Sk.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[rk(t),""],!1,!0);return VS(e).j(r).next((function(e){var r,i=Tt(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(qk(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=qS(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var o=ZS(e);return a.next((function(e){o.put(fS(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=qS(e),r=ZS(e),i=zS(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=zS(e),i=!0,a=new Map;return Sk.forEach(this.cn(t),(function(t){return n.an(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=dw(),o=[];return Sk.forEach(a,(function(i,a){var s;Lg("IndexedDbIndexManager","Using index ".concat((s=i,"id=".concat(s.indexId,"|cg=").concat(s.collectionGroup,"|f=").concat(s.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(O_(t)));var u=function(e,t){var n=hk(t);if(void 0===n)return null;var r,i=Tt(L_(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r=new Map,i=Tt(dk(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Tt(L_(e,o.fieldPath));try{for(s.s();!(a=s.n()).done;){var u=a.value;switch(u.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),u.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),u.value),Array.from(r.values())}}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],i=!0,a=Tt(dk(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=0===o.kind?j_(e,o.fieldPath,e.startAt):F_(e,o.fieldPath,e.startAt);r.push(s.value),i&&(i=s.inclusive)}}catch(u){a.e(u)}finally{a.f()}return new o_(r,i)}(a,i),f=function(e,t){var n,r=[],i=!0,a=Tt(dk(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=0===o.kind?F_(e,o.fieldPath,e.endAt):j_(e,o.fieldPath,e.endAt);r.push(s.value),i&&(i=s.inclusive)}}catch(u){a.e(u)}finally{a.f()}return new o_(r,i)}(a,i),h=n.hn(i,a,l),d=n.hn(i,a,f),p=n.ln(i,a,c),v=n.fn(i.indexId,u,h,l.inclusive,d,f.inclusive,p);return Sk.forEach(v,(function(n){return r.H(n,t.limit).next((function(t){t.forEach((function(t){var n=lk.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return Sk.resolve(null)}))}},{key:"cn",value:function(e){var t=this.un.get(e);return t||(t=0===e.filters.length?[e]:NS(d_.create(e.filters,"and")).map((function(t){return D_(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.un.set(e,t),t)}},{key:"fn",value:function(e,t,n,r,i,a,o){for(var s=this,u=(null!=t?t.length:1)*Math.max(n.length,i.length),c=u/(null!=t?t.length:1),l=[],f=function(){var u=t?s.dn(t[h/c]):US,f=s.wn(e,u,n[h%c],r),d=s._n(e,u,i[h%c],a),p=o.map((function(t){return s.wn(e,u,t,!0)}));l.push.apply(l,ft(s.createRange(f,d,p)))},h=0;h<u;++h)f();return l}},{key:"wn",value:function(e,t,n,r){var i=new SS(e,lk.empty(),t,n);return r?i:i.Je()}},{key:"_n",value:function(e,t,n,r){var i=new SS(e,lk.empty(),t,n);return r?i.Je():i}},{key:"an",value:function(e,t){var n=new IS(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,i=Tt(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.tn(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.cn(t);return Sk.forEach(i,(function(t){return n.an(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new _b(ck.comparator),r=!1,i=Tt(e.filters);try{for(i.s();!(t=i.n()).done;){var a,o=Tt(t.value.getFlattenedFilters());try{for(o.s();!(a=o.n()).done;){var s=a.value;s.field.isKeyField()||("array-contains"===s.op||"array-contains-any"===s.op?r=!0:n=n.add(s.field))}}catch(f){o.e(f)}finally{o.f()}}}catch(f){i.e(f)}finally{i.f()}var u,c=Tt(e.orderBy);try{for(c.s();!(u=c.n()).done;){var l=u.value;l.field.isKeyField()||(n=n.add(l.field))}}catch(f){c.e(f)}finally{c.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return function(e){return null!==e.limit}(t)&&i.length>1&&2===r?1:r}))}},{key:"mn",value:function(e,t){var n,r=new xS,i=Tt(dk(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var s=r.He(a.kind);mS.Ve._e(o,s)}}catch(u){i.e(u)}finally{i.f()}return r.Qe()}},{key:"dn",value:function(e){var t=new xS;return mS.Ve._e(e,t.He(0)),t.Qe()}},{key:"gn",value:function(e,t){var n=new xS;return mS.Ve._e(Wb(this.databaseId,t),n.He(function(e){var t=dk(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Qe()}},{key:"ln",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new xS);var i,a=0,o=Tt(dk(e));try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=n[a++],l=Tt(r);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(this.yn(t,u.fieldPath)&&Kb(c))r=this.pn(r,u,c);else{var h=f.He(u.kind);mS.Ve._e(c,h)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.In(r)}},{key:"hn",value:function(e,t,n){return this.ln(e,t,n.position)}},{key:"In",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Qe();return t}},{key:"pn",value:function(e,t,n){var r,i=ft(e),a=[],o=Tt(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Tt(i);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new xS;f.seed(l.Qe()),mS.Ve._e(u,f.He(t.kind)),a.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}},{key:"yn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof h_&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=qS(e),i=ZS(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next((function(e){var t=[];return Sk.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new vk(t.sequenceNumber,new gk(iS(t.readTime),new lk(qk(t.documentKey)),t.largestBatchId)):vk.empty(),r=e.fields.map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return new pk(ck.fromServerFormat(n),r)}));return new fk(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:tk(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=qS(e),a=ZS(e);return this.Tn(e).next((function(e){return i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Sk.forEach(t,(function(t){return a.put(fS(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Sk.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?Sk.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),Sk.forEach(a,(function(r){return n.En(e,t,r).next((function(t){var a=n.An(i,r);return t.isEqual(a)?Sk.resolve():n.vn(e,i,r,t,a)}))}))}))}))}},{key:"Rn",value:function(e,t,n,r){return zS(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}},{key:"Pn",value:function(e,t,n,r){return zS(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}},{key:"En",value:function(e,t,n){var r=zS(e),i=new _b(ES);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(function(e,r){i=i.add(new SS(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"An",value:function(e,t){var n=new _b(ES),r=this.mn(t,e);if(null==r)return n;var i=hk(t);if(null!=i){var a=e.data.field(i.fieldPath);if(Kb(a)){var o,s=Tt(a.arrayValue.values||[]);try{for(s.s();!(o=s.n()).done;){var u=o.value;n=n.add(new SS(t.indexId,e.key,this.dn(u),r))}}catch(c){s.e(c)}finally{s.f()}}}else n=n.add(new SS(t.indexId,e.key,US,r));return n}},{key:"vn",value:function(e,t,n,r,i){var a=this;Lg("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),s=xb(a),u=xb(o);s||u;){var c=!1,l=!1;if(s&&u){var f=n(s,u);f<0?l=!0:f>0&&(c=!0)}else null!=s?l=!0:c=!0;c?(r(u),u=xb(o)):l?(i(s),s=xb(a)):(s=xb(a),u=xb(o))}}(r,i,ES,(function(r){o.push(a.Rn(e,t,n,r))}),(function(r){o.push(a.Pn(e,t,n,r))})),Sk.waitFor(o)}},{key:"Tn",value:function(e){var t=1;return ZS(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return ES(e,t)})).filter((function(e,t,n){return!t||0!==ES(e,n[t-1])}));var r=[];r.push(e);var i,a=Tt(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=ES(o,e),u=ES(o,t);if(0===s)r[0]=e.Je();else if(s>0&&u<0)r.push(o),r.push(o.Je());else if(u>0)break}}catch(d){a.e(d)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.bn(r[l],r[l+1]))return[];var f=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,US,[]],h=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,US,[]];c.push(IDBKeyRange.bound(f,h))}return c}},{key:"bn",value:function(e,t){return ES(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(WS)}},{key:"getMinOffset",value:function(e,t){var n=this;return Sk.mapArray(this.cn(t),(function(t){return n.an(e,t).next((function(e){return e||Ug()}))})).next(WS)}}]),e}();function VS(e){return pb(e,"collectionParents")}function zS(e){return pb(e,"indexEntries")}function qS(e){return pb(e,"indexConfiguration")}function ZS(e){return pb(e,"indexState")}function WS(e){Bg(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;kk(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new gk(t.readTime,t.documentKey,n)}var HS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KS=function(){function e(t,n,r){ht(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return vt(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function GS(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),s=0,u=r.X({range:o},(function(e,t,n){return s++,n.delete()}));a.push(u.next((function(){Bg(1===s)})));var c,l=[],f=Tt(n.mutations);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=Hk(t,h.key.path,n.batchId);a.push(i.delete(d)),l.push(h.key)}}catch(p){f.e(p)}finally{f.f()}return Sk.waitFor(a).next((function(){return l}))}function QS(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Ug();t=e.noDocument}return JSON.stringify(t).length}KS.DEFAULT_COLLECTION_PERCENTILE=10,KS.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,KS.DEFAULT=new KS(41943040,KS.DEFAULT_COLLECTION_PERCENTILE,KS.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),KS.DISABLED=new KS(-1,0,0);var YS=function(){function e(t,n,r,i){ht(this,e),this.userId=t,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}return vt(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return XS(e).X({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=JS(e),o=XS(e);return o.add({}).next((function(s){Bg("number"==typeof s);var u,c=new Yw(s,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return Ux(e.fe,t)})),i=n.mutations.map((function(t){return Ux(e.fe,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.serializer,i.userId,c),f=[],h=new _b((function(e,t){return tk(e.canonicalString(),t.canonicalString())})),d=Tt(r);try{for(d.s();!(u=d.n()).done;){var p=u.value,v=Hk(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),f.push(o.put(l)),f.push(a.put(v,Kk))}}catch(y){d.e(y)}finally{d.f()}return h.forEach((function(t){f.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.Vn[s]=c.keys()})),Sk.waitFor(f).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return XS(e).get(t).next((function(e){return e?(Bg(e.userId===n.userId),aS(n.serializer,e)):null}))}},{key:"Sn",value:function(e,t){var n=this;return this.Vn[t]?Sk.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.Vn[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return XS(e).X({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(Bg(t.batchId>=r),a=aS(n.serializer,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return XS(e).X({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return XS(e).j("userMutationsIndex",n).next((function(e){return e.map((function(e){return aS(t.serializer,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=Wk(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return JS(e).X({range:i},(function(r,i,o){var s=(0,u.Z)(r,3),c=s[0],l=s[1],f=s[2],h=qk(l);if(c===n.userId&&t.path.isEqual(h))return XS(e).get(f).next((function(e){if(!e)throw Ug();Bg(e.userId===n.userId),a.push(aS(n.serializer,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new _b(tk),i=[];return t.forEach((function(t){var a=Wk(n.userId,t.path),o=IDBKeyRange.lowerBound(a),s=JS(e).X({range:o},(function(e,i,a){var o=(0,u.Z)(e,3),s=o[0],c=o[1],l=o[2],f=qk(c);s===n.userId&&t.path.isEqual(f)?r=r.add(l):a.done()}));i.push(s)})),Sk.waitFor(i).next((function(){return n.Dn(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=Wk(this.userId,r),o=IDBKeyRange.lowerBound(a),s=new _b(tk);return JS(e).X({range:o},(function(e,t,a){var o=(0,u.Z)(e,3),c=o[0],l=o[1],f=o[2],h=qk(l);c===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(f)):a.done()})).next((function(){return n.Dn(e,s)}))}},{key:"Dn",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(XS(e).get(t).next((function(e){if(null===e)throw Ug();Bg(e.userId===n.userId),r.push(aS(n.serializer,e))})))})),Sk.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return GS(e.ht,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.Cn(t.batchId)})),Sk.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"Cn",value:function(e){delete this.Vn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Sk.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return JS(e).X({range:r},(function(e,n,r){if(e[0]===t.userId){var a=qk(e[1]);i.push(a)}else r.done()})).next((function(){Bg(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return $S(e,this.userId,t)}},{key:"xn",value:function(e){var t=this;return eE(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"de",value:function(t,n,r,i){return Bg(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function $S(e,t,n){var r=Wk(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return JS(e).X({range:a,Y:!0},(function(e,n,r){var a=(0,u.Z)(e,3),s=a[0],c=a[1];a[2];s===t&&c===i&&(o=!0),r.done()})).next((function(){return o}))}function XS(e){return pb(e,"mutations")}function JS(e){return pb(e,"documentMutations")}function eE(e){return pb(e,"mutationQueues")}var tE=function(){function e(t){ht(this,e),this.Nn=t}return vt(e,[{key:"next",value:function(){return this.Nn+=2,this.Nn}}],[{key:"kn",value:function(){return new e(0)}},{key:"Mn",value:function(){return new e(-1)}}]),e}(),nE=function(){function e(t,n){ht(this,e),this.referenceDelegate=t,this.serializer=n}return vt(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.$n(e).next((function(n){var r=new tE(n.highestTargetId);return n.highestTargetId=r.next(),t.On(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.$n(e).next((function(e){return ak.fromTimestamp(new ik(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.$n(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.$n(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.On(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Fn(e,t).next((function(){return n.$n(e).next((function(r){return r.targetCount+=1,n.Bn(t,r),n.On(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Fn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return rE(e).delete(t.targetId)})).next((function(){return n.$n(e)})).next((function(t){return Bg(t.targetCount>0),t.targetCount-=1,n.On(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return rE(e).X((function(o,s){var u=oS(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,a.push(r.removeTargetData(e,u)))})).next((function(){return Sk.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return rE(e).X((function(e,n){var r=oS(n);t(r)}))}},{key:"$n",value:function(e){return iE(e).get("targetGlobalKey").next((function(e){return Bg(null!==e),e}))}},{key:"On",value:function(e,t){return iE(e).put("targetGlobalKey",t)}},{key:"Fn",value:function(e,t){return rE(e).put(sS(this.serializer,t))}},{key:"Bn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.$n(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=O_(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return rE(e).X({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=oS(n);R_(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=aE(e);return t.forEach((function(t){var o=Bk(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Sk.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=aE(e);return Sk.forEach(t,(function(t){var a=Bk(t.path);return Sk.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=aE(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=aE(e),i=dw();return r.X({range:n,Y:!0},(function(e,t,n){var r=qk(e[1]),a=new lk(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=Bk(t.path),r=IDBKeyRange.bound([n],[rk(n)],!1,!0),i=0;return aE(e).X({index:"documentTargetsIndex",Y:!0,range:r},(function(e,t,n){var r=(0,u.Z)(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"le",value:function(e,t){return rE(e).get(t).next((function(e){return e?oS(e):null}))}}]),e}();function rE(e){return pb(e,"targets")}function iE(e){return pb(e,"targetGlobal")}function aE(e){return pb(e,"targetDocuments")}function oE(e,t){var n=(0,u.Z)(e,2),r=n[0],i=n[1],a=(0,u.Z)(t,2),o=a[0],s=a[1],c=tk(r,o);return 0===c?tk(i,s):c}var sE=function(){function e(t){ht(this,e),this.Ln=t,this.buffer=new _b(oE),this.qn=0}return vt(e,[{key:"Un",value:function(){return++this.qn}},{key:"Kn",value:function(e){var t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();oE(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),uE=function(){function e(t,n,r){ht(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Gn=null}return vt(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}},{key:"stop",value:function(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}},{key:"started",get:function(){return null!==this.Gn}},{key:"Qn",value:function(e){var t=this;Lg("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Gn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!Nk(e.t0)){e.next=12;break}Lg("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,wk(e.t0);case 14:return e.next=16,t.Qn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),cE=function(){function e(t,n){ht(this,e),this.jn=t,this.params=n}return vt(e,[{key:"calculateTargetCount",value:function(e,t){return this.jn.zn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Sk.resolve(jk.ct);var r=new sE(t);return this.jn.forEachTarget(e,(function(e){return r.Kn(e.sequenceNumber)})).next((function(){return n.jn.Wn(e,(function(e){return r.Kn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.jn.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.jn.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Lg("LruGarbageCollector","Garbage collection skipped; disabled"),Sk.resolve(HS)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Lg("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),HS):n.Hn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.jn.getCacheSize(e)}},{key:"Hn",value:function(e,t){var n,r,i,a,o,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Lg("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),Pg()<=si.DEBUG&&Lg("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(u-s)+"ms\n"+"Total Duration: ".concat(u-l,"ms")),Sk.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}();function lE(e,t){return new cE(e,t)}var fE=function(){function e(t,n){ht(this,e),this.db=t,this.garbageCollector=lE(this,n)}return vt(e,[{key:"zn",value:function(e){var t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Jn",value:function(e){var t=0;return this.Wn(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Wn",value:function(e,t){return this.Yn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return hE(e,n)}},{key:"removeReference",value:function(e,t,n){return hE(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return hE(e,t)}},{key:"Xn",value:function(e,t){return function(e,t){var n=!1;return eE(e).Z((function(r){return $S(e,r,t).next((function(e){return e&&(n=!0),Sk.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Yn(e,(function(o,s){if(s<=t){var u=n.Xn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,ak.min()),aE(e).delete([0,Bk(o.path)])}))}));i.push(u)}})).next((function(){return Sk.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return hE(e,t)}},{key:"Yn",value:function(e,t){var n,r=aE(e),i=jk.ct;return r.X({index:"documentTargetsIndex"},(function(e,r){var a=(0,u.Z)(e,2),o=a[0],s=(a[1],r.path),c=r.sequenceNumber;0===o?(i!==jk.ct&&t(new lk(qk(n)),i),i=c,n=s):i=jk.ct})).next((function(){i!==jk.ct&&t(new lk(qk(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function hE(e,t){return aE(e).put(function(e,t){return{targetId:0,path:Bk(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var dE=function(){function e(){ht(this,e),this.changes=new nw((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return vt(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,a_.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Sk.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),pE=function(){function e(t){ht(this,e),this.serializer=t}return vt(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return gE(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return gE(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],nS(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Zn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=a_.newInvalidDocument(t);return gE(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(function(e,i){r=n.ts(t,i)})).next((function(){return r}))}},{key:"es",value:function(e,t){var n=this,r={size:0,document:a_.newInvalidDocument(t)};return gE(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(function(e,i){r={document:n.ts(t,i),size:QS(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=iw();return this.ns(e,t,(function(e,t){var i=n.ts(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"ss",value:function(e,t){var n=this,r=iw(),i=new gb(lk.comparator);return this.ns(e,t,(function(e,t){var a=n.ts(e,t);r=r.insert(e,a),i=i.insert(e,QS(t))})).next((function(){return{documents:r,rs:i}}))}},{key:"ns",value:function(e,t,n){if(t.isEmpty())return Sk.resolve();var r=new _b(_E);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(kE(r.first()),kE(r.last())),a=r.getIterator(),o=a.getNext();return gE(e).X({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=lk.fromSegments([].concat(ft(t.prefixPath),[t.collectionGroup,t.documentId]));o&&_E(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.G(kE(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a=t.path,o=[a.popLast().toArray(),a.lastSegment(),nS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gE(e).j(IDBKeyRange.bound(o,s,!0)).next((function(e){var n,a=iw(),o=Tt(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=i.ts(lk.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);u.isFoundDocument()&&(X_(t,u)||r.has(u.key))&&(a=a.insert(u.key,u))}}catch(c){o.e(c)}finally{o.f()}return a}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=iw(),o=bE(t,n),s=bE(t,gk.max());return gE(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,s,!0)},(function(e,t,n){var o=i.ts(lk.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new yE(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return mE(e).get("remoteDocumentGlobalKey").next((function(e){return Bg(!!e),e}))}},{key:"Zn",value:function(e,t){return mE(e).put("remoteDocumentGlobalKey",t)}},{key:"ts",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=Fx(e.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=lk.fromSegments(t.noDocument.path),i=iS(t.noDocument.readTime);n=a_.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Ug();var a=lk.fromSegments(t.unknownDocument.path),o=iS(t.unknownDocument.version);n=a_.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new ik(e[0],e[1]);return ak.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(ak.min()))return n}return a_.newInvalidDocument(e)}}]),e}();function vE(e){return new pE(e)}var yE=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).os=e,i.trackRemovals=r,i.us=new nw((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return vt(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new _b((function(e,t){return tk(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var s=t.us.get(a);if(n.push(t.os.removeEntry(e,a,s.readTime)),o.isValidDocument()){var u=tS(t.os.serializer,o);i=i.add(a.path.popLast());var c=QS(u);r+=c-s.size,n.push(t.os.addEntry(e,a,u))}else if(r-=s.size,t.trackRemovals){var l=tS(t.os.serializer,o.convertToNoDocument(ak.min()));n.push(t.os.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.os.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.os.updateMetadata(e,r)),Sk.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.os.es(e,t).next((function(e){return n.us.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.os.ss(e,t).next((function(e){var t=e.documents;return e.rs.forEach((function(e,r){n.us.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(dE);function mE(e){return pb(e,"remoteDocumentGlobal")}function gE(e){return pb(e,"remoteDocumentsV14")}function kE(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function bE(e,t){var n=t.documentKey.path.toArray();return[e,nS(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function _E(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=tk(n[a],r[a]))return i;return(i=tk(n.length,r.length))||((i=tk(n[n.length-2],r[r.length-2]))||tk(n[n.length-1],r[r.length-1]))}var wE=vt((function e(t,n){ht(this,e),this.overlayedDocument=t,this.mutatedFields=n})),xE=function(){function e(t,n,r,i){ht(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return vt(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&Mw(r.mutation,e,Sb.empty(),ik.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,dw()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dw(),i=uw();return this.populateOverlays(e,i,t).next((function(){return n.computeViews(e,t,i,r).next((function(e){var t=ow();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=uw();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,dw())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=iw(),a=lw(),o=lw();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof zw)?i=i.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),Mw(o.mutation,t,o.mutation.getFieldMask(),ik.now())):a.set(t.key,Sb.empty())})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new wE(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=lw(),i=new gb((function(e,t){return e-t})),a=dw();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,a=Tt(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||Sb.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||dw()).add(n);i=i.insert(e.batchId,s)}}))};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}})).next((function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=cw();c.forEach((function(e){if(!a.has(e)){var n=jw(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return Sk.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return lk.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Z_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Sk.resolve(uw()),s=-1,u=a;return o.next((function(t){return Sk.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Sk.resolve():i.remoteDocumentCache.getEntry(e,t).next((function(e){u=u.insert(t,e)}))})).next((function(){return i.populateOverlays(e,t,a)})).next((function(){return i.computeViews(e,u,t,dw())})).next((function(e){return{batchId:s,changes:sw(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new lk(t)).next((function(e){var t=ow();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=ow();return this.indexManager.getCollectionParents(e,i).next((function(o){return Sk.forEach(o,(function(o){var s=function(e,t){return new M_(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(a){return r=a,i.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,a_.newInvalidDocument(r)))}));var n=ow();return e.forEach((function(e,i){var a=r.get(e);void 0!==a&&Mw(a.mutation,i,Sb.empty(),ik.now()),X_(t,i)&&(n=n.insert(e,i))})),n}))}}]),e}(),SE=function(){function e(t){ht(this,e),this.serializer=t,this.cs=new Map,this.hs=new Map}return vt(e,[{key:"getBundleMetadata",value:function(e,t){return Sk.resolve(this.cs.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Ix(n.createTime)}),Sk.resolve()}},{key:"getNamedQuery",value:function(e,t){return Sk.resolve(this.hs.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:uS(e.bundledQuery),readTime:Ix(e.readTime)}}(t)),Sk.resolve()}}]),e}(),EE=function(){function e(){ht(this,e),this.overlays=new gb(lk.comparator),this.ls=new Map}return vt(e,[{key:"getOverlay",value:function(e,t){return Sk.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=uw();return Sk.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.we(e,t,i)})),Sk.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.ls.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.ls.delete(n)),Sk.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=uw(),i=t.length+1,a=new lk(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Sk.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new gb((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=uw(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=uw(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return Sk.resolve(u)}},{key:"we",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Xw(t,n));var a=this.ls.get(t);void 0===a&&(a=dw(),this.ls.set(t,a)),this.ls.set(t,a.add(n.key))}}]),e}(),CE=function(){function e(){ht(this,e),this.fs=new _b(IE.ds),this.ws=new _b(IE._s)}return vt(e,[{key:"isEmpty",value:function(){return this.fs.isEmpty()}},{key:"addReference",value:function(e,t){var n=new IE(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}},{key:"gs",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.ys(new IE(e,t))}},{key:"ps",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Is",value:function(e){var t=this,n=new lk(new sk([])),r=new IE(n,e),i=new IE(n,e+1),a=[];return this.ws.forEachInRange([r,i],(function(e){t.ys(e),a.push(e.key)})),a}},{key:"Ts",value:function(){var e=this;this.fs.forEach((function(t){return e.ys(t)}))}},{key:"ys",value:function(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}},{key:"Es",value:function(e){var t=new lk(new sk([])),n=new IE(t,e),r=new IE(t,e+1),i=dw();return this.ws.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new IE(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),IE=function(){function e(t,n){ht(this,e),this.key=t,this.As=n}return vt(e,null,[{key:"ds",value:function(e,t){return lk.comparator(e.key,t.key)||tk(e.As,t.As)}},{key:"_s",value:function(e,t){return tk(e.As,t.As)||lk.comparator(e.key,t.key)}}]),e}(),TE=function(){function e(t,n){ht(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new _b(IE.ds)}return vt(e,[{key:"checkEmpty",value:function(e){return Sk.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Yw(i,t,n,r);this.mutationQueue.push(a);var o,s=Tt(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.Rs=this.Rs.add(new IE(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return Sk.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Sk.resolve(this.Ps(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.bs(n),i=r<0?0:r;return Sk.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Sk.resolve(0===this.mutationQueue.length?-1:this.vs-1)}},{key:"getAllMutationBatches",value:function(e){return Sk.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new IE(t,0),i=new IE(t,Number.POSITIVE_INFINITY),a=[];return this.Rs.forEachInRange([r,i],(function(e){var t=n.Ps(e.As);a.push(t)})),Sk.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new _b(tk);return t.forEach((function(e){var t=new IE(e,0),i=new IE(e,Number.POSITIVE_INFINITY);n.Rs.forEachInRange([t,i],(function(e){r=r.add(e.As)}))})),Sk.resolve(this.Vs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;lk.isDocumentKey(i)||(i=i.child(""));var a=new IE(new lk(i),0),o=new _b(tk);return this.Rs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)}),a),Sk.resolve(this.Vs(o))}},{key:"Vs",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Ps(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Bg(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();var r=this.Rs;return Sk.forEach(t.mutations,(function(i){var a=new IE(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.Rs=r}))}},{key:"Cn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new IE(t,0),r=this.Rs.firstAfterOrEqual(n);return Sk.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Sk.resolve()}},{key:"Ss",value:function(e,t){return this.bs(e)}},{key:"bs",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Ps",value:function(e){var t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),NE=function(){function e(t){ht(this,e),this.Ds=t,this.docs=new gb(lk.comparator),this.size=0}return vt(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Sk.resolve(n?n.document.mutableCopy():a_.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=iw();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():a_.newInvalidDocument(e))})),Sk.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=iw(),a=t.path,o=new lk(a.child("")),s=this.docs.getIteratorFrom(o);s.hasNext();){var u=s.getNext(),c=u.key,l=u.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||kk(mk(l),n)<=0||(r.has(l.key)||X_(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Sk.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Ug()}},{key:"Cs",value:function(e,t){return Sk.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new AE(this)}},{key:"getSize",value:function(e){return Sk.resolve(this.size)}}]),e}(),AE=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).os=e,r}return vt(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.os.addEntry(e,i)):t.os.removeEntry(r)})),Sk.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.os.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.os.getEntries(e,t)}}]),n}(dE),DE=function(){function e(t){ht(this,e),this.persistence=t,this.xs=new nw((function(e){return O_(e)}),R_),this.lastRemoteSnapshotVersion=ak.min(),this.highestTargetId=0,this.Ns=0,this.ks=new CE,this.targetCount=0,this.Ms=tE.kn()}return vt(e,[{key:"forEachTarget",value:function(e,t){return this.xs.forEach((function(e,n){return t(n)})),Sk.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Sk.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Sk.resolve(this.Ns)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ms.next(),Sk.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Sk.resolve()}},{key:"Fn",value:function(e){this.xs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ms=new tE(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Fn(t),this.targetCount+=1,Sk.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Fn(t),Sk.resolve()}},{key:"removeTargetData",value:function(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Sk.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.xs.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.xs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),Sk.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Sk.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.xs.get(t)||null;return Sk.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.ks.gs(t,n),Sk.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.ks.ps(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Sk.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.ks.Is(t),Sk.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.ks.Es(t);return Sk.resolve(n)}},{key:"containsKey",value:function(e,t){return Sk.resolve(this.ks.containsKey(t))}}]),e}(),OE=function(){function e(t,n){var r=this;ht(this,e),this.$s={},this.overlays={},this.Os=new jk(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new DE(this),this.indexManager=new FS,this.remoteDocumentCache=new NE((function(e){return r.referenceDelegate.Ls(e)})),this.serializer=new eS(n),this.qs=new SE(this.serializer)}return vt(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Fs=!1,Promise.resolve()}},{key:"started",get:function(){return this.Fs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new EE,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.$s[e.toKey()];return n||(n=new TE(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Lg("MemoryPersistence","Starting transaction:",e);var i=new RE(this.Os.next());return this.referenceDelegate.Us(),n(i).next((function(e){return r.referenceDelegate.Ks(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Gs",value:function(e,t){return Sk.or(Object.values(this.$s).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),RE=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return vt(n)}(_k),PE=function(){function e(t){ht(this,e),this.persistence=t,this.Qs=new CE,this.js=null}return vt(e,[{key:"Ws",get:function(){if(this.js)return this.js;throw Ug()}},{key:"addReference",value:function(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Sk.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Sk.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ws.add(t.toString()),Sk.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Qs.Is(t.targetId).forEach((function(e){return n.Ws.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ws.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Us",value:function(){this.js=new Set}},{key:"Ks",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Sk.forEach(this.Ws,(function(r){var i=lk.fromPath(r);return t.Hs(e,i).next((function(e){e||n.removeEntry(i,ak.min())}))})).next((function(){return t.js=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Hs(e,t).next((function(e){e?n.Ws.delete(t.toString()):n.Ws.add(t.toString())}))}},{key:"Ls",value:function(e){return 0}},{key:"Hs",value:function(e,t){var n=this;return Sk.or([function(){return Sk.resolve(n.Qs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Gs(e,t)}])}}],[{key:"zs",value:function(t){return new e(t)}}]),e}(),LE=function(){function e(t){ht(this,e),this.serializer=t}return vt(e,[{key:"O",value:function(e,t,n,r){var i=this,a=new Ek("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Zk,{unique:!0}),e.createObjectStore("documentMutations")}(e),jE(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Sk.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),jE(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ak.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").j().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Zk,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return Sk.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Ys(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Xs(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Zs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.ti(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.ei(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:ab});t.createIndex("collectionPathOverlayIndex",ob,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",sb,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:Gk});t.createIndex("documentKeyIndex",Qk),t.createIndex("collectionGroupIndex",Yk)}(e)})).next((function(){return i.ni(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.si(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:tb}).createIndex("sequenceNumberIndex",nb,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:rb}).createIndex("documentKeyIndex",ib,{unique:!1})}(e)}))),o}},{key:"Xs",value:function(e){var t=0;return e.store("remoteDocuments").X((function(e,n){t+=QS(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Ys",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next((function(n){return Sk.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",i).next((function(r){return Sk.forEach(r,(function(r){Bg(r.userId===n.userId);var i=aS(t.serializer,r);return GS(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"Zs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.X((function(n,i){var a=new sk(n),o=function(e){return[0,Bk(e)]}(a);r.push(t.get(o).next((function(n){return n?Sk.resolve():function(n){return t.put({targetId:0,path:Bk(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return Sk.waitFor(r)}))}))}},{key:"ti",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:eb});var n=t.store("collectionParents"),r=new MS,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Bk(i)})}};return t.store("remoteDocuments").X({Y:!0},(function(e,t){var n=new sk(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").X({Y:!0},(function(e,t){var n=(0,u.Z)(e,3),r=(n[0],n[1]),a=(n[2],qk(r));return i(a.popLast())}))}))}},{key:"ei",value:function(e){var t=this,n=e.store("targets");return n.X((function(e,r){var i=oS(r),a=sS(t.serializer,i);return n.put(a)}))}},{key:"ni",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.X((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new lk(sk.fromString(i.document.name).popFirst(5)):i.noDocument?lk.fromSegments(i.noDocument.path):i.unknownDocument?lk.fromSegments(i.unknownDocument.path):Ug()).path.toArray(),s={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(s))})).next((function(){return Sk.waitFor(r)}))}},{key:"si",value:function(e,t){var n=this,r=t.store("mutations"),i=vE(this.serializer),a=new OE(PE.zs,this.serializer.fe);return r.j().next((function(e){var r=new Map;return e.forEach((function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:dw();aS(n.serializer,e).keys().forEach((function(e){return i=i.add(e)})),r.set(e.userId,i)})),Sk.forEach(r,(function(e,r){var o=new Dg(r),s=vS.de(n.serializer,o),u=a.getIndexManager(o),c=YS.de(o,n.serializer,u,a.referenceDelegate);return new xE(i,c,s,u).recalculateAndSaveOverlaysForDocumentKeys(new db(t,jk.ct),e).next()}))}))}}]),e}();function jE(e){e.createObjectStore("targetDocuments",{keyPath:Xk}).createIndex("documentTargetsIndex",Jk,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",$k,{unique:!0}),e.createObjectStore("targetGlobal")}var FE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ME=function(){function e(t,n,r,i,a,o,s,u,c,l){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(ht(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.ii=a,this.window=o,this.document=s,this.ri=c,this.oi=l,this.ui=f,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=function(e){return Promise.resolve()},!e.D())throw new qg(zg.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new fE(this,i),this.di=n+"main",this.serializer=new eS(u),this.wi=new Ck(this.di,this.ui,new LE(this.serializer)),this.Bs=new nE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vE(this.serializer),this.qs=new hS,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===l&&jg("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return vt(e,[{key:"start",value:function(){var e=this;return this.mi().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new qg(zg.FAILED_PRECONDITION,FE);return e.gi(),e.yi(),e.pi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Bs.getHighestSequenceNumber(t)}))})).then((function(t){e.Os=new jk(t,e.ri)})).then((function(){e.Fs=!0})).catch((function(t){return e.wi&&e.wi.close(),Promise.reject(t)}))}},{key:"Ii",value:function(e){var t=this;return this.fi=function(){var n=(0,s.Z)((0,o.Z)().mark((function n(r){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.wi.B(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.mi();case 4:case"end":return e.stop()}}),e)})))))}},{key:"mi",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return BE(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.Ti(t).next((function(t){t||(e.isPrimary=!1,e.ii.enqueueRetryable((function(){return e.fi(!1)})))}))})).next((function(){return e.Ei(t)})).next((function(n){return e.isPrimary&&!n?e.Ai(t).next((function(){return!1})):!!n&&e.vi(t).next((function(){return!0}))}))})).catch((function(t){if(Nk(t))return Lg("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Lg("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.ii.enqueueRetryable((function(){return e.fi(t)})),e.isPrimary=t}))}},{key:"Ti",value:function(e){var t=this;return UE(e).get("owner").next((function(e){return Sk.resolve(t.Ri(e))}))}},{key:"Pi",value:function(e){return BE(e).delete(this.clientId)}},{key:"bi",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.Vi(this.li,18e5)){e.next=6;break}return this.li=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=pb(e,"clientMetadata");return t.j().next((function(e){var n=a.Si(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return Sk.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this._i){n=Tt(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this._i.removeItem(this.Di(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pi",value:function(){var e=this;this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.mi().then((function(){return e.bi()})).then((function(){return e.pi()}))}))}},{key:"Ri",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"Ei",value:function(e){var t=this;return this.oi?Sk.resolve(!0):UE(e).get("owner").next((function(n){if(null!==n&&t.Vi(n.leaseTimestampMs,5e3)&&!t.Ci(n.ownerId)){if(t.Ri(n)&&t.networkEnabled)return!0;if(!t.Ri(n)){if(!n.allowTabSynchronization)throw new qg(zg.FAILED_PRECONDITION,FE);return!1}}return!(!t.networkEnabled||!t.inForeground)||BE(e).j().next((function(e){return void 0===t.Si(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Lg("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),e.next=7,this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new db(e,jk.ct);return t.Ai(n).next((function(){return t.Pi(n)}))}));case 7:this.wi.close(),this.Mi();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Si",value:function(e,t){var n=this;return e.filter((function(e){return n.Vi(e.updateTimeMs,t)&&!n.Ci(e.clientId)}))}},{key:"$i",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return BE(t).j().next((function(t){return e.Si(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Fs}},{key:"getMutationQueue",value:function(e,t){return YS.de(e,this.serializer,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new BS(e,this.serializer.fe.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return vS.de(this.serializer,e)}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Lg("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",s=15===(i=this.ui)?hb:14===i?fb:13===i?lb:12===i?cb:11===i?ub:void Ug();return this.wi.runTransaction(e,o,s,(function(i){return a=new db(i,r.Os?r.Os.next():jk.ct),"readwrite-primary"===t?r.Ti(a).next((function(e){return!!e||r.Ei(a)})).next((function(t){if(!t)throw jg("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.ii.enqueueRetryable((function(){return r.fi(!1)})),new qg(zg.FAILED_PRECONDITION,bk);return n(a)})).next((function(e){return r.vi(a).next((function(){return e}))})):r.Oi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Oi",value:function(e){var t=this;return UE(e).get("owner").next((function(e){if(null!==e&&t.Vi(e.leaseTimestampMs,5e3)&&!t.Ci(e.ownerId)&&!t.Ri(e)&&!(t.oi||t.allowTabSynchronization&&e.allowTabSynchronization))throw new qg(zg.FAILED_PRECONDITION,FE)}))}},{key:"vi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return UE(e).put("owner",t)}},{key:"Ai",value:function(e){var t=this,n=UE(e);return n.get("owner").next((function(e){return t.Ri(e)?(Lg("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Sk.resolve()}))}},{key:"Vi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(jg("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"gi",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=function(){e.ii.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.mi()}))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ni",value:function(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}},{key:"yi",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=function(){t.xi();var e=/(?:Version|Mobile)\/1[456]/;!Or()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&t.ii.enterRestrictedMode(!0),t.ii.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.ci))}},{key:"ki",value:function(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}},{key:"Ci",value:function(e){var t;try{var n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Lg("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return jg("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"xi",value:function(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){jg("Failed to set zombie client id.",e)}}},{key:"Mi",value:function(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch(e){}}},{key:"Di",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"D",value:function(){return Ck.D()}}]),e}();function UE(e){return pb(e,"owner")}function BE(e){return pb(e,"clientMetadata")}function VE(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var zE=function(){function e(t,n,r,i){ht(this,e),this.targetId=t,this.fromCache=n,this.Fi=r,this.Bi=i}return vt(e,null,[{key:"Li",value:function(t,n){var r,i=dw(),a=dw(),o=Tt(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),qE=function(){function e(){ht(this,e),this.qi=!1}return vt(e,[{key:"initialize",value:function(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ki(e,t).next((function(a){return a||i.Gi(e,t,r,n)})).next((function(n){return n||i.Qi(e,t)}))}},{key:"Ki",value:function(e,t){var n=this;if(V_(t))return Sk.resolve(null);var r=H_(t);return this.indexManager.getIndexType(e,r).next((function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=G_(t,null,"F"),r=H_(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(i){var a=dw.apply(void 0,ft(i));return n.Ui.getDocuments(e,a).next((function(i){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.ji(t,i);return n.zi(t,o,a,r.readTime)?n.Ki(e,G_(t,null,"F")):n.Wi(e,o,t,r)}))}))})))}))}},{key:"Gi",value:function(e,t,n,r){var i=this;return V_(t)||r.isEqual(ak.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((function(a){var o=i.ji(t,a);return i.zi(t,o,n,r)?i.Qi(e,t):(Pg()<=si.DEBUG&&Lg("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),$_(t)),i.Wi(e,o,t,yk(r,-1)))}))}},{key:"ji",value:function(e,t){var n=new _b(ew(e));return t.forEach((function(t,r){X_(e,r)&&(n=n.add(r))})),n}},{key:"zi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Qi",value:function(e,t){return Pg()<=si.DEBUG&&Lg("QueryEngine","Using full collection scan to execute query:",$_(t)),this.Ui.getDocumentsMatchingQuery(e,t,gk.min())}},{key:"Wi",value:function(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),ZE=function(){function e(t,n,r,i){ht(this,e),this.persistence=t,this.Hi=n,this.serializer=i,this.Ji=new gb(tk),this.Yi=new nw((function(e){return O_(e)}),R_),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(r)}return vt(e,[{key:"tr",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xE(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Ji)}))}}]),e}();function WE(e,t,n,r){return new ZE(e,t,n,r)}function HE(e,t){return KE.apply(this,arguments)}function KE(){return(KE=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(i){return t=i,r.tr(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],s=dw(),u=Tt(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=Tt(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,p=Tt(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var y,m=Tt(v.mutations);try{for(m.s();!(y=m.n()).done;){var g=y.value;s=s.add(g.key)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){p.e(k)}finally{p.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{er:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function GE(e,t){var n=Vg(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Sk.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);Bg(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=dw(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function QE(e){var t=Vg(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Bs.getLastRemoteSnapshotVersion(e)}))}function YE(e,t){var n=Vg(e),r=t.snapshotVersion,i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;var o=[];t.targetChanges.forEach((function(a,s){var u=i.get(s);if(u){o.push(n.Bs.removeMatchingKeys(e,a.removedDocuments,s).next((function(){return n.Bs.addMatchingKeys(e,a.addedDocuments,s)})));var c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?c=c.withResumeToken(Cb.EMPTY_BYTE_STRING,ak.min()).withLastLimboFreeSnapshotVersion(ak.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,a)&&o.push(n.Bs.updateTargetData(e,c))}}));var s=iw(),u=dw();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push($E(e,a,t.documentUpdates).next((function(e){s=e.nr,u=e.sr}))),!r.isEqual(ak.min())){var c=n.Bs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Sk.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.Ji=i,e}))}function $E(e,t,n){var r=dw(),i=dw();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=iw();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(ak.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Lg("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{nr:r,sr:i}}))}function XE(e,t){var n=Vg(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function JE(e,t){var n=Vg(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Bs.getTargetData(e,t).next((function(i){return i?(r=i,Sk.resolve(r)):n.Bs.allocateTargetId(e).next((function(i){return r=new Jx(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}function eC(e,t,n){return tC.apply(this,arguments)}function tC(){return(tC=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Vg(t),a=i.Ji.get(n),s=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",s,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Nk(e.t1)){e.next=12;break}throw e.t1;case 12:Lg("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.Ji=i.Ji.remove(n),i.Yi.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function nC(e,t,n){var r=Vg(e),i=ak.min(),a=dw();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Vg(e),i=r.Yi.get(n);return void 0!==i?Sk.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,H_(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Hi.getDocumentsMatchingQuery(e,t,n?i:ak.min(),n?a:dw())})).next((function(e){return aC(r,J_(t),e),{documents:e,ir:a}}))}))}function rC(e,t){var n=Vg(e),r=Vg(n.Bs),i=n.Ji.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.le(e,t).next((function(e){return e?e.target:null}))}))}function iC(e,t){var n=Vg(e),r=n.Xi.get(t)||ak.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Zi.getAllFromCollectionGroup(e,t,yk(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return aC(n,t,e),e}))}function aC(e,t,n){var r=e.Xi.get(t)||ak.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}function oC(e,t,n,r){return sC.apply(this,arguments)}function sC(){return sC=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){var a,s,u,c,l,f,h,d,p,v;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Vg(t),s=dw(),u=iw(),c=Tt(r);try{for(c.s();!(l=c.n()).done;)f=l.value,h=n.rr(f.metadata.name),f.document&&(s=s.add(h)),(d=n.ur(f)).setReadTime(n.cr(f.metadata.readTime)),u=u.insert(h,d)}catch(o){c.e(o)}finally{c.f()}return p=a.Zi.newChangeBuffer({trackRemovals:!0}),e.next=7,JE(a,function(e){return H_(B_(sk.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return v=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return $E(e,p,u).next((function(t){return p.apply(e),t})).next((function(t){return a.Bs.removeMatchingKeysForTargetId(e,v.targetId).next((function(){return a.Bs.addMatchingKeys(e,s,v.targetId)})).next((function(){return a.localDocuments.getLocalViewOfDocuments(e,t.nr,t.sr)})).next((function(){return t.nr}))}))})));case 9:case"end":return e.stop()}}),e)}))),sC.apply(this,arguments)}function uC(e,t){return cC.apply(this,arguments)}function cC(){return cC=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:dw(),e.next=3,JE(t,H_(uS(n.bundledQuery)));case 3:return i=e.sent,a=Vg(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Ix(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.qs.saveNamedQuery(e,n);var o=i.withResumeToken(Cb.EMPTY_BYTE_STRING,t);return a.Ji=a.Ji.insert(o.targetId,o),a.Bs.updateTargetData(e,o).next((function(){return a.Bs.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.Bs.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.qs.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),cC.apply(this,arguments)}function lC(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function fC(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function hC(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var dC=function(){function e(t,n,r,i){ht(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return vt(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new qg(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(jg("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),pC=function(){function e(t,n,r){ht(this,e),this.targetId=t,this.state=n,this.error=r}return vt(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new qg(i.error.code,i.error.message))),a?new e(t,i.state,r):(jg("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),vC=function(){function e(t,n){ht(this,e),this.clientId=t,this.activeTargetIds=n}return vt(e,null,[{key:"ar",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=vw(),o=0;i&&o<r.activeTargetIds.length;++o)i=Uk(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(jg("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),yC=function(){function e(t,n){ht(this,e),this.clientId=t,this.onlineState=n}return vt(e,null,[{key:"ar",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(jg("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),mC=function(){function e(){ht(this,e),this.activeTargetIds=vw()}return vt(e,[{key:"lr",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"dr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"hr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),gC=function(){function e(t,n,r,i,a){ht(this,e),this.window=t,this.ii=n,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new gb(tk),this.started=!1,this.yr=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.pr=lC(this.persistenceKey,this.wr),this.Ir=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new mC),this.Tr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.Er=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.Ar=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.vr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Rr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this._r)}return vt(e,[{key:"start",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a,s,u,c,l,f,h,d=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.$i();case 2:t=e.sent,n=Tt(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.wr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(lC(this.persistenceKey,i)))&&(s=vC.ar(i,a))&&(this.gr=this.gr.insert(s.clientId,s));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.Pr(),(u=this.storage.getItem(this.vr))&&(c=this.br(u))&&this.Vr(c),l=Tt(this.yr);try{for(l.s();!(f=l.n()).done;)h=f.value,this.mr(h)}catch(o){l.e(o)}finally{l.f()}this.yr=[],this.window.addEventListener("pagehide",(function(){return d.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.Ir,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Sr(this.gr)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.gr.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Dr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Dr(e,t,n),this.Cr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(hC(this.persistenceKey,e));if(n){var r=pC.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Nr.dr(e),this.Pr()}},{key:"isLocalQueryTarget",value:function(e){return this.Nr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(hC(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.kr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Cr(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.Mr(e)}},{key:"notifyBundleLoaded",value:function(e){this.$r(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Lg("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Lg("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Lg("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"mr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Lg("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void jg("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,s.Z)((0,o.Z)().mark((function e(){var r,i,a,s,u,c,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.Tr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Or(n.key),e.abrupt("return",t.Fr(r,null));case 6:if(!(i=t.Br(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Fr(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.Er.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Lr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.qr(a));case 16:e.next=41;break;case 18:if(!t.Ar.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(s=t.Ur(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Kr(s));case 23:e.next=41;break;case 25:if(n.key!==t.vr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.br(n.newValue))){e.next=30;break}return e.abrupt("return",t.Vr(u));case 30:e.next=41;break;case 32:if(n.key!==t.Ir){e.next=37;break}c=function(e){var t=jk.ct;if(null!=e)try{var n=JSON.parse(e);Bg("number"==typeof n),t=n}catch(e){jg("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),c!==jk.ct&&t.sequenceNumberHandler(c),e.next=41;break;case 37:if(n.key!==t.Rr){e.next=41;break}return l=t.Gr(n.newValue),e.next=41,Promise.all(l.map((function(e){return t.syncEngine.Qr(e)})));case 41:e.next=44;break;case 43:t.yr.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Nr",get:function(){return this.gr.get(this.wr)}},{key:"Pr",value:function(){this.setItem(this.pr,this.Nr.hr())}},{key:"Dr",value:function(e,t,n){var r=new dC(this.currentUser,e,t,n),i=fC(this.persistenceKey,this.currentUser,e);this.setItem(i,r.hr())}},{key:"Cr",value:function(e){var t=fC(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Mr",value:function(e){var t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}},{key:"kr",value:function(e,t,n){var r=hC(this.persistenceKey,e),i=new pC(e,t,n);this.setItem(r,i.hr())}},{key:"$r",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}},{key:"Or",value:function(e){var t=this.Tr.exec(e);return t?t[1]:null}},{key:"Br",value:function(e,t){var n=this.Or(e);return vC.ar(n,t)}},{key:"Lr",value:function(e,t){var n=this.Er.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return dC.ar(new Dg(i),r,t)}},{key:"Ur",value:function(e,t){var n=this.Ar.exec(e),r=Number(n[1]);return pC.ar(r,t)}},{key:"br",value:function(e){return yC.ar(e)}},{key:"Gr",value:function(e){return JSON.parse(e)}},{key:"qr",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.jr(t.batchId,t.state,t.error));case 2:Lg("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Kr",value:function(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}},{key:"Fr",value:function(e,t){var n=this,r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),a=this.Sr(r),o=[],s=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||s.push(e)})),this.syncEngine.Wr(o,s).then((function(){n.gr=r}))}},{key:"Vr",value:function(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Sr",value:function(e){var t=vw();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"D",value:function(e){return!(!e||!e.localStorage)}}]),e}(),kC=function(){function e(){ht(this,e),this.Hr=new mC,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return vt(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Jr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Hr.dr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Jr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Hr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Hr=new mC,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),bC=function(){function e(){ht(this,e)}return vt(e,[{key:"Yr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),_C=function(){function e(){var t=this;ht(this,e),this.Xr=function(){return t.Zr()},this.eo=function(){return t.no()},this.so=[],this.io()}return vt(e,[{key:"Yr",value:function(e){this.so.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}},{key:"io",value:function(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}},{key:"Zr",value:function(){Lg("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Tt(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"no",value:function(){Lg("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Tt(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),wC=null;function xC(){return null===wC?wC=268435456+Math.round(2147483648*Math.random()):wC++,"0x"+wC.toString(16)}var SC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},EC=function(){function e(t){ht(this,e),this.ro=t.ro,this.oo=t.oo}return vt(e,[{key:"uo",value:function(e){this.co=e}},{key:"ao",value:function(e){this.ho=e}},{key:"onMessage",value:function(e){this.lo=e}},{key:"close",value:function(){this.oo()}},{key:"send",value:function(e){this.ro(e)}},{key:"fo",value:function(){this.co()}},{key:"wo",value:function(e){this.ho(e)}},{key:"_o",value:function(e){this.lo(e)}}]),e}(),CC="WebChannelConnection",IC=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r.longPollingOptions=e.longPollingOptions,r}return vt(n,[{key:"Ao",value:function(e,t,n,r){var i=xC();return new Promise((function(a,o){var s=new Ig;s.setWithCredentials(!0),s.listenOnce(wg.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case _g.NO_ERROR:var t=s.getResponseJson();Lg(CC,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case _g.TIMEOUT:Lg(CC,"RPC '".concat(e,"' ").concat(i," timed out")),o(new qg(zg.DEADLINE_EXCEEDED,"Request time out"));break;case _g.HTTP_ERROR:var n=s.getStatus();if(Lg(CC,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var c=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(zg).indexOf(t)>=0?t:zg.UNKNOWN}(u.status);o(new qg(c,u.message))}else o(new qg(zg.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new qg(zg.UNAVAILABLE,"Connection failed."));break;default:Ug()}}finally{Lg(CC,"RPC '".concat(e,"' ").concat(i," completed."))}}));var u=JSON.stringify(r);Lg(CC,"RPC '".concat(e,"' ").concat(i," sending request:"),r),s.send(t,"POST",u,n,15)}))}},{key:"Ro",value:function(e,t,n){var r=xC(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=kg(),o=bg(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(s.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(s.xmlHttpFactory=new Eg({})),this.Eo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;var c=i.join("");Lg(CC,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);var l=a.createWebChannel(c,s),f=!1,h=!1,d=new EC({ro:function(t){h?Lg(CC,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(f||(Lg(CC,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),f=!0),Lg(CC,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},oo:function(){return l.close()}}),p=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return p(l,Cg.EventType.OPEN,(function(){h||Lg(CC,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(l,Cg.EventType.CLOSE,(function(){h||(h=!0,Lg(CC,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.wo())})),p(l,Cg.EventType.ERROR,(function(t){h||(h=!0,Fg(CC,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),d.wo(new qg(zg.UNAVAILABLE,"The operation could not be completed")))})),p(l,Cg.EventType.MESSAGE,(function(t){var n;if(!h){var i=t.data[0];Bg(!!i);var a=i,o=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(o){Lg(CC,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);var s=o.status,u=function(e){var t=Hw[e];if(void 0!==t)return tx(t)}(s),c=o.message;void 0===u&&(u=zg.INTERNAL,c="Unknown error status: "+s+" with message "+o.message),h=!0,d.wo(new qg(u,c)),l.close()}else Lg(CC,"RPC '".concat(e,"' stream ").concat(r," received:"),i),d._o(i)}})),p(o,xg.STAT_EVENT,(function(t){t.stat===Sg.PROXY?Lg(CC,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Sg.NOPROXY&&Lg(CC,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){d.fo()}),0),d}}]),n}(function(){function e(t){ht(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.mo=n+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return vt(e,[{key:"po",get:function(){return!1}},{key:"Io",value:function(e,t,n,r,i){var a=xC(),o=this.To(e,t);Lg("RestConnection","Sending RPC '".concat(e,"' ").concat(a,":"),o,n);var s={};return this.Eo(s,r,i),this.Ao(e,o,s,n).then((function(t){return Lg("RestConnection","Received RPC '".concat(e,"' ").concat(a,": "),t),t}),(function(t){throw Fg("RestConnection","RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",o,"request:",n),t}))}},{key:"vo",value:function(e,t,n,r,i,a){return this.Io(e,t,n,r,i)}},{key:"Eo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Og,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"To",value:function(e,t){var n=SC[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}]),e}());function TC(){return"undefined"!=typeof window?window:null}function NC(){return"undefined"!=typeof document?document:null}function AC(e){return new wx(e,!0)}var DC=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;ht(this,e),this.ii=t,this.timerId=n,this.Po=r,this.bo=i,this.Vo=a,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}return vt(e,[{key:"reset",value:function(){this.So=0}},{key:"xo",value:function(){this.So=this.Vo}},{key:"No",value:function(e){var t=this;this.cancel();var n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,n-r);i>0&&Lg("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(function(){return t.Co=Date.now(),e()})),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}},{key:"Mo",value:function(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}},{key:"cancel",value:function(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"ko",value:function(){return(Math.random()-.5)*this.So}}]),e}(),OC=function(){function e(t,n,r,i,a,o,s,u){ht(this,e),this.ii=t,this.$o=r,this.Oo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new DC(t,n)}return vt(e,[{key:"Uo",value:function(){return 1===this.state||5===this.state||this.Ko()}},{key:"Ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Go()}},{key:"stop",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Uo(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Qo",value:function(){this.state=0,this.qo.reset()}},{key:"jo",value:function(){var e=this;this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(function(){return e.zo()})))}},{key:"Wo",value:function(e){this.Ho(),this.stream.send(e)}},{key:"zo",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ho",value:function(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}},{key:"Jo",value:function(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}},{key:"close",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():n&&n.code===zg.RESOURCE_EXHAUSTED?(jg(n.toString()),jg("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===zg.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.ao(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Yo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=(0,u.Z)(t,2),i=r[0],a=r[1];e.Fo===n&&e.Zo(i,a)}),(function(n){t((function(){var t=new qg(zg.UNKNOWN,"Fetching auth token failed: "+n.message);return e.tu(t)}))}))}},{key:"Zo",value:function(e,t){var n=this,r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((function(){r((function(){return n.state=2,n.Lo=n.ii.enqueueAfterDelay(n.Oo,1e4,(function(){return n.Ko()&&(n.state=3),Promise.resolve()})),n.listener.uo()}))})),this.stream.ao((function(e){r((function(){return n.tu(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Go",value:function(){var e=this;this.state=5,this.qo.No((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"tu",value:function(e){return Lg("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Xo",value:function(e){var t=this;return function(n){t.ii.enqueueAndForget((function(){return t.Fo===e?n():(Lg("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),RC=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a,o,s){var u;return ht(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).serializer=o,u}return vt(n,[{key:"eu",value:function(e,t){return this.connection.Ro("Listen",e,t)}},{key:"onMessage",value:function(e){this.qo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ug()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Bg(void 0===t||"string"==typeof t),Cb.fromBase64String(t||"")):(Bg(void 0===t||t instanceof Uint8Array),Cb.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?zg.UNKNOWN:tx(e.code);return new qg(t,e.message||"")}(o);n=new px(r,i,a,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var c=Dx(e,u.document.name),l=Ix(u.document.updateTime),f=u.document.createTime?Ix(u.document.createTime):ak.min(),h=new r_({mapValue:{fields:u.document.fields}}),d=a_.newFoundDocument(c,l,f,h),p=u.targetIds||[],v=u.removedTargetIds||[];n=new hx(p,v,d.key,d)}else if("documentDelete"in t){t.documentDelete;var y=t.documentDelete;y.document;var m=Dx(e,y.document),g=y.readTime?Ix(y.readTime):ak.min(),k=a_.newNoDocument(m,g),b=y.removedTargetIds||[];n=new hx([],b,k.key,k)}else if("documentRemove"in t){t.documentRemove;var _=t.documentRemove;_.document;var w=Dx(e,_.document),x=_.removedTargetIds||[];n=new hx([],x,w,null)}else{if(!("filter"in t))return Ug();t.filter;var S=t.filter;S.targetId;var E=S.count,C=void 0===E?0:E,I=S.unchangedNames,T=new Jw(C,I),N=S.targetId;n=new dx(N,T)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ak.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?ak.min():t.readTime?Ix(t.readTime):ak.min()}(e);return this.listener.nu(t,n)}},{key:"su",value:function(e){var t={};t.database=Px(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=P_(r)?{documents:Vx(e,r)}:{query:zx(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ex(e,t.resumeToken);var i=xx(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(ak.min())>0){n.readTime=Sx(e,t.snapshotVersion.toTimestamp());var a=xx(e,t.expectedCount);null!==a&&(n.expectedCount=a)}return n}(this.serializer,e);var n=function(e,t){var n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ug()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}},{key:"iu",value:function(e){var t={};t.database=Px(this.serializer),t.removeTarget=e,this.Wo(t)}}]),n}(OC),PC=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a,o,s){var u;return ht(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).serializer=o,u.ru=!1,u}return vt(n,[{key:"ou",get:function(){return this.ru}},{key:"start",value:function(){this.ru=!1,this.lastStreamToken=void 0,sp(gt(n.prototype),"start",this).call(this)}},{key:"Yo",value:function(){this.ru&&this.uu([])}},{key:"eu",value:function(e,t){return this.connection.Ro("Write",e,t)}},{key:"onMessage",value:function(e){if(Bg(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();var t=function(e,t){return e&&e.length>0?(Bg(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Ix(e.updateTime):Ix(t);return n.isEqual(ak.min())&&(n=Ix(t)),new Ow(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Ix(e.commitTime);return this.listener.cu(n,t)}return Bg(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}},{key:"hu",value:function(){var e={};e.database=Px(this.serializer),this.Wo(e)}},{key:"uu",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Ux(t.serializer,e)}))};this.Wo(n)}}]),n}(OC),LC=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a){var o;return ht(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=i,o.serializer=a,o.lu=!1,o}return vt(n,[{key:"fu",value:function(){if(this.lu)throw new qg(zg.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Io",value:function(e,t,n){var r=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=(0,u.Z)(i,2),o=a[0],s=a[1];return r.connection.Io(e,t,n,o,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===zg.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new qg(zg.UNKNOWN,e.toString())}))}},{key:"vo",value:function(e,t,n,r){var i=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=(0,u.Z)(a,2),s=o[0],c=o[1];return i.connection.vo(e,t,n,s,c,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===zg.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new qg(zg.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.lu=!0}}]),n}(function(){return vt((function e(){ht(this,e)}))}());var jC=function(){function e(t,n){ht(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}return vt(e,[{key:"gu",value:function(){var e=this;0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e._u=null,e.pu("Backend didn't respond within 10 seconds."),e.yu("Offline"),Promise.resolve()})))}},{key:"Iu",value:function(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.yu("Offline")))}},{key:"set",value:function(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}},{key:"yu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"pu",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?(jg(t),this.mu=!1):Lg("OnlineStateTracker",t)}},{key:"Tu",value:function(){null!==this._u&&(this._u.cancel(),this._u=null)}}]),e}(),FC=vt((function e(t,n,r,i,a){var u=this;ht(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=a,this.Pu.Yr((function(e){r.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=GC(u),!e.t0){e.next=5;break}return Lg("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Vg(t)).vu.add(4),e.next=4,BC(n);case 4:return n.bu.set("Unknown"),n.vu.delete(4),e.next=8,MC(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(u);case 5:case"end":return e.stop()}}),e)}))))})),this.bu=new jC(r,i)}));function MC(e){return UC.apply(this,arguments)}function UC(){return(UC=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GC(t)){e.next=18;break}n=Tt(t.Ru),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))).apply(this,arguments)}function BC(e){return VC.apply(this,arguments)}function VC(){return(VC=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Tt(t.Ru),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}function zC(e,t){var n=Vg(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),KC(n)?HC(n):xI(n).Ko()&&ZC(n,t))}function qC(e,t){var n=Vg(e),r=xI(n);n.Au.delete(t),r.Ko()&&WC(n,t),0===n.Au.size&&(r.Ko()?r.jo():GC(n)&&n.bu.set("Unknown"))}function ZC(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ak.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}xI(e).su(t)}function WC(e,t){e.Vu.qt(t),xI(e).iu(t)}function HC(e){e.Vu=new yx({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},le:function(t){return e.Au.get(t)||null},ue:function(){return e.datastore.serializer.databaseId}}),xI(e).start(),e.bu.gu()}function KC(e){return GC(e)&&!xI(e).Uo()&&e.Au.size>0}function GC(e){return 0===Vg(e).vu.size}function QC(e){e.Vu=void 0}function YC(e){return $C.apply(this,arguments)}function $C(){return($C=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.Au.forEach((function(e,n){ZC(t,e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function XC(e,t){return JC.apply(this,arguments)}function JC(){return(JC=(0,s.Z)((0,o.Z)().mark((function e(t,n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:QC(t),KC(t)?(t.bu.Iu(n),HC(t)):t.bu.set("Unknown");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eI(e,t,n){return tI.apply(this,arguments)}function tI(){return tI=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.bu.set("Online"),!(n instanceof px&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Tt(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(s=a.value,e.t0=t.Au.has(s),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(s,r);case 10:t.Au.delete(s),t.Vu.removeTarget(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Lg("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,nI(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof hx?t.Vu.Ht(n):n instanceof dx?t.Vu.ne(n):t.Vu.Xt(n),r.isEqual(ak.min())){e.next=29;break}return e.prev=14,e.next=17,QE(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Vu.ce(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t,n){var r=e.Au.get(t);if(r){e.Au.set(t,r.withResumeToken(Cb.EMPTY_BYTE_STRING,r.snapshotVersion)),WC(e,t);var i=new Jx(r.target,t,n,r.sequenceNumber);ZC(e,i)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Lg("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,nI(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),tI.apply(this,arguments)}function nI(e,t,n){return rI.apply(this,arguments)}function rI(){return(rI=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Nk(n)){e.next=2;break}throw n;case 2:return t.vu.add(1),e.next=5,BC(t);case 5:t.bu.set("Offline"),r||(r=function(){return QE(t.localStore)}),t.asyncQueue.enqueueRetryable((0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lg("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.vu.delete(1),e.next=6,MC(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function iI(e,t){return t().catch((function(n){return nI(e,n,t)}))}function aI(e){return oI.apply(this,arguments)}function oI(){return(oI=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Vg(t),r=SI(n),i=n.Eu.length>0?n.Eu[n.Eu.length-1].batchId:-1;case 2:if(!sI(n)){e.next=19;break}return e.prev=3,e.next=6,XE(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Eu.length&&r.jo(),e.abrupt("break",19);case 10:i=a.batchId,uI(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,nI(n,e.t0);case 17:e.next=2;break;case 19:cI(n)&&lI(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function sI(e){return GC(e)&&e.Eu.length<10}function uI(e,t){e.Eu.push(t);var n=SI(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function cI(e){return GC(e)&&!SI(e).Uo()&&e.Eu.length>0}function lI(e){SI(e).start()}function fI(e){return hI.apply(this,arguments)}function hI(){return(hI=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:SI(t).hu();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dI(e){return pI.apply(this,arguments)}function pI(){return(pI=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=SI(t),r=Tt(t.Eu);try{for(r.s();!(i=r.n()).done;)a=i.value,n.uu(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vI(e,t,n){return yI.apply(this,arguments)}function yI(){return(yI=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Eu.shift(),a=$w.from(i,n,r),e.next=3,iI(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,aI(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mI(e,t){return gI.apply(this,arguments)}function gI(){return gI=(0,s.Z)((0,o.Z)().mark((function e(t,n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&SI(t).ou,!e.t0){e.next=4;break}return e.next=4,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ex(i=n.code)||i===zg.ABORTED){e.next=7;break}return r=t.Eu.shift(),SI(t).Qo(),e.next=5,iI(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,aI(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:cI(t)&&lI(t);case 5:case"end":return e.stop()}}),e)}))),gI.apply(this,arguments)}function kI(e,t){return bI.apply(this,arguments)}function bI(){return(bI=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Vg(t)).asyncQueue.verifyOperationInProgress(),Lg("RemoteStore","RemoteStore received new credentials"),i=GC(r),r.vu.add(3),e.next=6,BC(r);case 6:return i&&r.bu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.vu.delete(3),e.next=12,MC(r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _I(e,t){return wI.apply(this,arguments)}function wI(){return(wI=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vg(t),!n){e.next=7;break}return r.vu.delete(2),e.next=5,MC(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.vu.add(2),e.next=12,BC(r);case 12:r.bu.set("Unknown");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xI(e){return e.Su||(e.Su=function(e,t,n){var r=Vg(e);return r.fu(),new RC(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:YC.bind(null,e),ao:XC.bind(null,e),nu:eI.bind(null,e)}),e.Ru.push(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Su.Qo(),KC(e)?HC(e):e.bu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Su.stop();case 6:QC(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Su}function SI(e){return e.Du||(e.Du=function(e,t,n){var r=Vg(e);return r.fu(),new PC(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:fI.bind(null,e),ao:mI.bind(null,e),au:dI.bind(null,e),cu:vI.bind(null,e)}),e.Ru.push(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Du.Qo(),t.next=4,aI(e);case 4:t.next=9;break;case 6:return t.next=8,e.Du.stop();case 8:e.Eu.length>0&&(Lg("RemoteStore","Stopping write stream with ".concat(e.Eu.length," pending writes")),e.Eu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Du}var EI=function(){function e(t,n,r,i,a){ht(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Zg,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return vt(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qg(zg.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function CI(e,t){if(jg("AsyncQueue","".concat(t,": ").concat(e)),Nk(e))return new qg(zg.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var II=function(){function e(t){ht(this,e),this.comparator=t?function(e,n){return t(e,n)||lk.comparator(e.key,n.key)}:function(e,t){return lk.comparator(e.key,t.key)},this.keyedMap=ow(),this.sortedSet=new gb(this.comparator)}return vt(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),TI=function(){function e(){ht(this,e),this.Cu=new gb(lk.comparator)}return vt(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Ug():this.Cu=this.Cu.insert(t,e)}},{key:"xu",value:function(){var e=[];return this.Cu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),NI=function(){function e(t,n,r,i,a,o,s,u,c){ht(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=c}return vt(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Q_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,II.emptySet(n),o,r,i,!0,!1,a)}}]),e}(),AI=vt((function e(){ht(this,e),this.Nu=void 0,this.listeners=[]})),DI=vt((function e(){ht(this,e),this.queries=new nw((function(e){return Y_(e)}),Q_),this.onlineState="Unknown",this.ku=new Set}));function OI(e,t){return RI.apply(this,arguments)}function RI(){return(RI=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vg(t),i=n.query,a=!1,(s=r.queries.get(i))||(a=!0,s=new AI),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:s.Nu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=CI(e.t0,"Initialization of query '".concat($_(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,s),s.listeners.push(n),n.Mu(r.onlineState),s.Nu&&n.$u(s.Nu)&&MI(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function PI(e,t){return LI.apply(this,arguments)}function LI(){return(LI=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vg(t),i=n.query,a=!1,(s=r.queries.get(i))&&(u=s.listeners.indexOf(n))>=0&&(s.listeners.splice(u,1),a=0===s.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jI(e,t){var n,r=Vg(e),i=!1,a=Tt(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.query,u=r.queries.get(s);if(u){var c,l=Tt(u.listeners);try{for(l.s();!(c=l.n()).done;){c.value.$u(o)&&(i=!0)}}catch(f){l.e(f)}finally{l.f()}u.Nu=o}}}catch(f){a.e(f)}finally{a.f()}i&&MI(r)}function FI(e,t,n){var r=Vg(e),i=r.queries.get(t);if(i){var a,o=Tt(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function MI(e){e.ku.forEach((function(e){e.next()}))}var UI=function(){function e(t,n,r){ht(this,e),this.query=t,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}return vt(e,[{key:"$u",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Tt(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new NI(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),a=!0):this.qu(e,this.onlineState)&&(this.Uu(e),a=!0),this.Bu=e,a}},{key:"onError",value:function(e){this.Ou.error(e)}},{key:"Mu",value:function(e){this.onlineState=e;var t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}},{key:"qu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Lu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Uu",value:function(e){e=NI.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}]),e}(),BI=function(){function e(t,n){ht(this,e),this.Gu=t,this.byteLength=n}return vt(e,[{key:"Qu",value:function(){return"metadata"in this.Gu}}]),e}(),VI=function(){function e(t){ht(this,e),this.serializer=t}return vt(e,[{key:"rr",value:function(e){return Dx(this.serializer,e)}},{key:"ur",value:function(e){return e.metadata.exists?Fx(this.serializer,e.document,!1):a_.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}},{key:"cr",value:function(e){return Ix(e)}}]),e}(),zI=function(){function e(t,n,r){ht(this,e),this.ju=t,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=qI(t)}return vt(e,[{key:"zu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;var n=sk.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"Wu",value:function(e){var t,n=new Map,r=new VI(this.serializer),i=Tt(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,s=r.rr(a.metadata.name),u=Tt(a.metadata.queries);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=(n.get(c)||dw()).add(s);n.set(c,l)}}catch(f){u.e(f)}finally{u.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oC(this.localStore,new VI(this.serializer),this.documents,this.ju.id);case 2:t=e.sent,n=this.Wu(this.documents),r=Tt(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,uC(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function qI(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var ZI=vt((function e(t){ht(this,e),this.key=t})),WI=vt((function e(t){ht(this,e),this.key=t})),HI=function(){function e(t,n){ht(this,e),this.query=t,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=dw(),this.mutatedKeys=dw(),this.tc=ew(t),this.ec=new II(this.tc)}return vt(e,[{key:"nc",get:function(){return this.Yu}},{key:"sc",value:function(e,t){var n=this,r=t?t.ic:new TI,i=t?t.ec:this.ec,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),f=X_(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),p=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),p=!0):n.rc(l,f)||(r.track({type:2,doc:f}),p=!0,(u&&n.tc(f,u)>0||c&&n.tc(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),p=!0):l&&!f&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{ec:o,ic:r,zi:s,mutatedKeys:a}}},{key:"rc",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;var a=e.ic.xu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ug()}};return n(e)-n(t)}(e.type,t.type)||r.tc(e.doc,t.doc)})),this.oc(n);var o=t?this.uc():[],s=0===this.Zu.size&&this.current?1:0,u=s!==this.Xu;return this.Xu=s,0!==a.length||u?{snapshot:new NI(this.query,e.ec,i,a,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}},{key:"Mu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new TI,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}},{key:"ac",value:function(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}},{key:"oc",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Yu=t.Yu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Yu=t.Yu.delete(e)})),this.current=e.current)}},{key:"uc",value:function(){var e=this;if(!this.current)return[];var t=this.Zu;this.Zu=dw(),this.ec.forEach((function(t){e.ac(t.key)&&(e.Zu=e.Zu.add(t.key))}));var n=[];return t.forEach((function(t){e.Zu.has(t)||n.push(new WI(t))})),this.Zu.forEach((function(e){t.has(e)||n.push(new ZI(e))})),n}},{key:"hc",value:function(e){this.Yu=e.ir,this.Zu=dw();var t=this.sc(e.documents);return this.applyChanges(t,!0)}},{key:"lc",value:function(){return NI.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}]),e}(),KI=vt((function e(t,n,r){ht(this,e),this.query=t,this.targetId=n,this.view=r})),GI=vt((function e(t){ht(this,e),this.key=t,this.fc=!1})),QI=function(){function e(t,n,r,i,a,o){ht(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new nw((function(e){return Y_(e)}),Q_),this._c=new Map,this.mc=new Set,this.gc=new gb(lk.comparator),this.yc=new Map,this.Ic=new CE,this.Tc={},this.Ec=new Map,this.Ac=tE.Mn(),this.onlineState="Unknown",this.vc=void 0}return vt(e,[{key:"isPrimaryClient",get:function(){return!0===this.vc}}]),e}();function YI(e,t){return $I.apply(this,arguments)}function $I(){return($I=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=qT(t),!(s=r.wc.get(n))){e.next=6;break}i=s.targetId,r.sharedClientState.addLocalQueryTarget(i),a=s.view.lc(),e.next=15;break;case 6:return e.next=8,JE(r.localStore,H_(n));case 8:return u=e.sent,c=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=13,XI(r,n,i,"current"===c,u.resumeToken);case 13:a=e.sent,r.isPrimaryClient&&zC(r.remoteStore,u);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function XI(e,t,n,r,i){return JI.apply(this,arguments)}function JI(){return JI=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i,a){var u,c,l,f,h,d;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Rc=function(e,n,r){return function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){var a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.sc(r),e.t0=a.zi,!e.t0){e.next=6;break}return e.next=5,nC(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.sc(t,a)}));case 5:a=e.sent;case 6:return s=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,s),e.abrupt("return",(kT(t,n.targetId,u.cc),u.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,nC(t.localStore,n,!0);case 3:return u=e.sent,c=new HI(n,u.ir),l=c.sc(u.documents),f=fx.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),h=c.applyChanges(l,t.isPrimaryClient,f),kT(t,r,h.cc),d=new KI(n,r,c),e.abrupt("return",(t.wc.set(n,d),t._c.has(r)?t._c.get(r).push(n):t._c.set(r,[n]),h.snapshot));case 11:case"end":return e.stop()}}),e)}))),JI.apply(this,arguments)}function eT(e,t){return tT.apply(this,arguments)}function tT(){return(tT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vg(t),i=r.wc.get(n),!((a=r._c.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r._c.set(i.targetId,a.filter((function(e){return!Q_(e,n)}))),void r.wc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,eC(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),qC(r.remoteStore,i.targetId),mT(r,i.targetId)})).catch(wk);case 9:e.next=14;break;case 11:return mT(r,i.targetId),e.next=14,eC(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nT(e,t,n){return rT.apply(this,arguments)}function rT(){return rT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ZT(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Vg(e),a=ik.now(),o=t.reduce((function(e,t){return e.add(t.key)}),dw());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=iw(),u=dw();return i.Zi.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],u=Tt(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Uw(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new zw(c.key,l,i_(l.value.mapValue),Rw.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:sw(n)}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.Tc[e.currentUser.toKey()];r||(r=new gb(tk)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,wT(i,a.changes);case 9:return e.next=11,aI(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),s=CI(e.t0,"Failed to persist write"),r.reject(s);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),rT.apply(this,arguments)}function iT(e,t){return aT.apply(this,arguments)}function aT(){return(aT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),e.prev=1,e.next=4,YE(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.yc.get(t);n&&(Bg(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.fc=!0:e.modifiedDocuments.size>0?Bg(n.fc):e.removedDocuments.size>0&&(Bg(n.fc),n.fc=!1))})),e.next=8,wT(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,wk(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function oT(e,t,n){var r=Vg(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.wc.forEach((function(e,n){var r=n.view.Mu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=Vg(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=Tt(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Mu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&MI(n)}(r.eventManager,t),i.length&&r.dc.nu(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function sT(e,t,n){return uT.apply(this,arguments)}function uT(){return(uT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,c,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Vg(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.yc.get(n),!(s=a&&a.key)){e.next=14;break}return u=(u=new gb(lk.comparator)).insert(s,a_.newNoDocument(s,ak.min())),c=dw().add(s),l=new lx(ak.min(),new Map,new gb(tk),u,c),e.next=9,iT(i,l);case 9:i.gc=i.gc.remove(s),i.yc.delete(n),_T(i),e.next=16;break;case 14:return e.next=16,eC(i.localStore,n,!1).then((function(){return mT(i,n,r)})).catch(wk);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cT(e,t){return lT.apply(this,arguments)}function lT(){return(lT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),i=n.batch.batchId,e.prev=1,e.next=4,GE(r.localStore,n);case 4:return a=e.sent,yT(r,i,null),vT(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,wT(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,wk(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function fT(e,t,n){return hT.apply(this,arguments)}function hT(){return(hT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Vg(t),e.prev=1,e.next=4,function(e,t){var n=Vg(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Bg(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,yT(i,n,r),vT(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,wT(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,wk(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function dT(e,t){return pT.apply(this,arguments)}function pT(){return(pT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return GC((r=Vg(t)).remoteStore)||Lg("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Vg(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.Ec.get(i)||[]).push(n),r.Ec.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),s=CI(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(s);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function vT(e,t){(e.Ec.get(t)||[]).forEach((function(e){e.resolve()})),e.Ec.delete(t)}function yT(e,t,n){var r=Vg(e),i=r.Tc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function mT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Tt(e._c.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.wc.delete(a),n&&e.dc.Pc(a,n)}}catch(o){i.e(o)}finally{i.f()}e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((function(t){e.Ic.containsKey(t)||gT(e,t)}))}function gT(e,t){e.mc.delete(t.path.canonicalString());var n=e.gc.get(t);null!==n&&(qC(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),_T(e))}function kT(e,t,n){var r,i=Tt(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof ZI?(e.Ic.addReference(a.key,t),bT(e,a)):a instanceof WI?(Lg("SyncEngine","Document no longer in limbo: "+a.key),e.Ic.removeReference(a.key,t),e.Ic.containsKey(a.key)||gT(e,a.key)):Ug()}}catch(o){i.e(o)}finally{i.f()}}function bT(e,t){var n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Lg("SyncEngine","New document in limbo: "+n),e.mc.add(r),_T(e))}function _T(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){var t=e.mc.values().next().value;e.mc.delete(t);var n=new lk(sk.fromString(t)),r=e.Ac.next();e.yc.set(r,new GI(n)),e.gc=e.gc.insert(n,r),zC(e.remoteStore,new Jx(H_(B_(n.path)),r,"TargetPurposeLimboResolution",jk.ct))}}function wT(e,t,n){return xT.apply(this,arguments)}function xT(){return xT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Vg(t),a=[],u=[],c=[],e.t0=i.wc.isEmpty(),e.t0){e.next=9;break}return i.wc.forEach((function(e,t){c.push(i.Rc(t,n,r).then((function(e){if((e||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){a.push(e);var n=zE.Li(t.targetId,e);u.push(n)}})))})),e.next=6,Promise.all(c);case 6:return i.dc.nu(a),e.next=9,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u,c,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Sk.forEach(n,(function(t){return Sk.forEach(t.Fi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Sk.forEach(t.Bi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Nk(e.t0)){e.next=10;break}throw e.t0;case 10:Lg("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Tt(n);try{for(i.s();!(a=i.n()).done;)s=a.value,u=s.targetId,s.fromCache||(c=r.Ji.get(u),l=c.snapshotVersion,f=c.withLastLimboFreeSnapshotVersion(l),r.Ji=r.Ji.insert(u,f))}catch(o){i.e(o)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,u);case 9:case"end":return e.stop()}}),e)}))),xT.apply(this,arguments)}function ST(e,t){return ET.apply(this,arguments)}function ET(){return(ET=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Vg(t)).currentUser.isEqual(n)){e.next=11;break}return Lg("SyncEngine","User change. New user:",n.toKey()),e.next=5,HE(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.Ec.forEach((function(e){e.forEach((function(e){e.reject(new qg(zg.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,wT(r,i.er);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CT(e,t){var n=Vg(e),r=n.yc.get(t);if(r&&r.fc)return dw().add(r.key);var i=dw(),a=n._c.get(t);if(!a)return i;var o,s=Tt(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.wc.get(u);i=i.unionWith(c.view.nc)}}catch(l){s.e(l)}finally{s.f()}return i}function IT(e,t){return TT.apply(this,arguments)}function TT(){return(TT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),e.next=3,nC(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.hc(i),e.abrupt("return",(r.isPrimaryClient&&kT(r,n.targetId,a.cc),a));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function NT(e,t){return AT.apply(this,arguments)}function AT(){return(AT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),e.abrupt("return",iC(r.localStore,n).then((function(e){return wT(r,e)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function DT(e,t,n,r){return OT.apply(this,arguments)}function OT(){return(OT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){var a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Vg(t),e.next=3,function(e,t){var n=Vg(e),r=Vg(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Sn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Sk.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(s=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,aI(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(yT(a,n,i||null),vT(a,n),function(e,t){Vg(Vg(e).mutationQueue).Cn(t)}(a.localStore,n)):Ug();case 11:return e.next=13,wT(a,s);case 13:e.next=16;break;case 15:Lg("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function RT(e,t){return PT.apply(this,arguments)}function PT(){return(PT=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u,c,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qT(r=Vg(t)),ZT(r),!0!==n||!0===r.vc){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,LT(r,i.toArray());case 5:return a=e.sent,r.vc=!0,e.next=9,_I(r.remoteStore,!0);case 9:s=Tt(a);try{for(s.s();!(u=s.n()).done;)c=u.value,zC(r.remoteStore,c)}catch(o){s.e(o)}finally{s.f()}e.next=25;break;case 13:if(!1!==n||!1===r.vc){e.next=25;break}return l=[],f=Promise.resolve(),r._c.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?l.push(t):f=f.then((function(){return mT(r,t),eC(r.localStore,t,!0)})),qC(r.remoteStore,t)})),e.next=19,f;case 19:return e.next=21,LT(r,l);case 21:return function(e){var t=Vg(e);t.yc.forEach((function(e,n){qC(t.remoteStore,n)})),t.Ic.Ts(),t.yc=new Map,t.gc=new gb(lk.comparator)}(r),r.vc=!1,e.next=25,_I(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function LT(e,t,n){return jT.apply(this,arguments)}function jT(){return(jT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,c,l,f,h,d,p,v,y,m,g;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Vg(t),a=[],s=[],u=Tt(n),e.prev=2,u.s();case 4:if((c=u.n()).done){e.next=45;break}if(l=c.value,f=void 0,!(h=i._c.get(l))||0===h.length){e.next=34;break}return e.next=11,JE(i.localStore,H_(h[0]));case 11:f=e.sent,d=Tt(h),e.prev=13,d.s();case 15:if((p=d.n()).done){e.next=24;break}return v=p.value,y=i.wc.get(v),e.next=20,IT(i,y);case 20:(m=e.sent).snapshot&&s.push(m.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),d.e(e.t0);case 29:return e.prev=29,d.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,rC(i.localStore,l);case 36:return g=e.sent,e.next=39,JE(i.localStore,g);case 39:return f=e.sent,e.next=42,XI(i,FT(g),l,!1,f.resumeToken);case 42:a.push(f);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),u.e(e.t1);case 50:return e.prev=50,u.f(),e.finish(50);case 53:return e.abrupt("return",(i.dc.nu(s),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])})))).apply(this,arguments)}function FT(e){return U_(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function MT(e){var t=Vg(e);return Vg(Vg(t.localStore).persistence).$i()}function UT(e,t,n,r){return BT.apply(this,arguments)}function BT(){return(BT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){var a,s,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Vg(t)).vc){e.next=3;break}return e.abrupt("return",void Lg("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((s=a._c.get(n))&&s.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,iC(a.localStore,J_(s[0]));case 10:return u=e.sent,c=lx.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,Cb.EMPTY_BYTE_STRING),e.next=14,wT(a,u,c);case 14:return e.abrupt("break",20);case 15:return e.next=17,eC(a.localStore,n,!0);case 17:return mT(a,n,i),e.abrupt("break",20);case 19:Ug();case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function VT(e,t,n){return zT.apply(this,arguments)}function zT(){return(zT=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,c,l,f,h,d;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=qT(t)).vc){e.next=45;break}a=Tt(n),e.prev=3,a.s();case 5:if((s=a.n()).done){e.next=21;break}if(u=s.value,!i._c.has(u)){e.next=10;break}return Lg("SyncEngine","Adding an already active target "+u),e.abrupt("continue",19);case 10:return e.next=12,rC(i.localStore,u);case 12:return c=e.sent,e.next=15,JE(i.localStore,c);case 15:return l=e.sent,e.next=18,XI(i,FT(c),l.targetId,!1,l.resumeToken);case 18:zC(i.remoteStore,l);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:f=Tt(r),e.prev=30,d=(0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=i._c.has(t),!e.t0){e.next=5;break}return e.next=5,eC(i.localStore,t,!1).then((function(){qC(i.remoteStore,t),mT(i,t)})).catch(wk);case 5:case"end":return e.stop()}}),e)})),f.s();case 33:if((h=f.n()).done){e.next=37;break}return e.delegateYield(d(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),f.e(e.t2);case 42:return e.prev=42,f.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])})))).apply(this,arguments)}function qT(e){var t=Vg(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=iT.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=CT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=sT.bind(null,t),t.dc.nu=jI.bind(null,t.eventManager),t.dc.Pc=FI.bind(null,t.eventManager),t}function ZT(e){var t=Vg(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=cT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=fT.bind(null,t),t}function WT(e,t,n){var r=Vg(e);(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=Vg(e),r=Ix(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.qs.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(qI(i)),a=new zI(i,t.localStore,n.serializer),e.next=15,n.bc();case 15:s=e.sent;case 16:if(!s){e.next=26;break}return e.next=19,a.zu(s);case 19:return(u=e.sent)&&r._updateProgress(u),e.next=23,n.bc();case 23:s=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return c=e.sent,e.next=31,wT(t,c.Ju,void 0);case 31:return e.next=33,function(e,t){var n=Vg(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.qs.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(c.progress),e.abrupt("return",Promise.resolve(c.Hu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Fg("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var HT=function(){function e(){ht(this,e),this.synchronizeTabs=!1}return vt(e,[{key:"initialize",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.serializer=AC(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),e.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return WE(this.persistence,new qE,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new OE(PE.zs,this.serializer)}},{key:"createSharedClientState",value:function(e){return new kC}},{key:"terminate",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),KT=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).Vc=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return vt(n,[{key:"initialize",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var r=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sp(gt(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Vc.initialize(this,t);case 4:return e.next=6,ZT(this.Vc.syncEngine);case 6:return e.next=8,aI(this.Vc.remoteStore);case 8:return e.next=10,this.persistence.Ii((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createLocalStore",value:function(e){return WE(this.persistence,new qE,e.initialUser,this.serializer)}},{key:"createGarbageCollectionScheduler",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new uE(n,e.asyncQueue,t)}},{key:"createIndexBackfillerScheduler",value:function(e,t){var n=new Lk(t,this.persistence);return new Pk(e.asyncQueue,n)}},{key:"createPersistence",value:function(e){var t=VE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?KS.withCacheSize(this.cacheSizeBytes):KS.DEFAULT;return new ME(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,TC(),NC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}},{key:"createSharedClientState",value:function(e){return new kC}}]),n}(HT),GT=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,r,!1)).Vc=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return vt(n,[{key:"initialize",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var r,i=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sp(gt(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Vc.syncEngine,e.t0=this.sharedClientState instanceof gC,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={jr:DT.bind(null,r),zr:UT.bind(null,r),Wr:VT.bind(null,r),$i:MT.bind(null,r),Qr:NT.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.Ii(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,RT(i.Vc.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSharedClientState",value:function(e){var t=TC();if(!gC.D(t))throw new qg(zg.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=VE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gC(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(KT),QT=function(){function e(){ht(this,e)}return vt(e,[{key:"initialize",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return oT(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ST.bind(null,this.syncEngine),e.next=12,_I(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new DI}},{key:"createDatastore",value:function(e){var t,n=AC(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new IC(t));return function(e,t,n,r){return new LC(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return oT(o.syncEngine,e,0)},a=_C.D()?new _C:new bC,new FC(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var s=new QI(e,t,n,r,i,a);return o&&(s.vc=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vg(t),Lg("RemoteStore","RemoteStore shutting down."),n.vu.add(5),e.next=5,BC(n);case 5:n.Pu.shutdown(),n.bu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function YT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return(0,s.Z)((0,o.Z)().mark((function r(){var i;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.resolve()}}var $T=function(){function e(t){ht(this,e),this.observer=t,this.muted=!1}return vt(e,[{key:"next",value:function(e){this.observer.next&&this.Sc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Sc(this.observer.error,e):jg("Uncaught Error in snapshot listener:",e.toString())}},{key:"Dc",value:function(){this.muted=!0}},{key:"Sc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),XT=function(){function e(t,n){var r=this;ht(this,e),this.Cc=t,this.serializer=n,this.metadata=new Zg,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then((function(e){e&&e.Qu()?r.metadata.resolve(e.Gu.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.Gu))))}),(function(e){return r.metadata.reject(e)}))}return vt(e,[{key:"close",value:function(){return this.Cc.cancel()}},{key:"getMetadata",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bc",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Nc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Nc",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.kc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.xc.decode(t),r=Number(n),isNaN(r)&&this.Mc("length string (".concat(n,") is not valid number")),e.next=9,this.$c(r);case 9:return i=e.sent,e.abrupt("return",new BI(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Oc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"kc",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Oc()<0)){e.next=7;break}return e.next=3,this.Fc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Oc())<0&&this.Mc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"$c",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Fc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Mc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.xc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Mc",value:function(e){throw this.Cc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Fc",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Cc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),JT=function(){function e(t){ht(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return vt(e,[{key:"lookup",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new qg(zg.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),i=Px(r.serializer)+"/documents",a={documents:n.map((function(e){return Ax(r.serializer,e)}))},e.next=5,r.vo("BatchGetDocuments",i,a,n.length);case 5:return s=e.sent,u=new Map,s.forEach((function(e){var t=Mx(r.serializer,e);u.set(t.key.toString(),t)})),c=[],e.abrupt("return",(n.forEach((function(e){var t=u.get(e.toString());Bg(!!t),c.push(t)})),c));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new Gw(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=lk.fromPath(t);n.mutations.push(new Qw(r,n.precondition(r)))})),e.next=7,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vg(t),i=Px(r.serializer)+"/documents",a={writes:n.map((function(e){return Ux(r.serializer,e)}))},e.next=3,r.Io("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ug();t=ak.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new qg(zg.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ak.min())?Rw.exists(!1):Rw.updateTime(t):Rw.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ak.min()))throw new qg(zg.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rw.updateTime(t)}return Rw.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),eN=function(){function e(t,n,r,i,a){ht(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.Bc=r.maxAttempts,this.qo=new DC(this.asyncQueue,"transaction_retry")}return vt(e,[{key:"run",value:function(){this.Bc-=1,this.Lc()}},{key:"Lc",value:function(){var e=this;this.qo.No((0,s.Z)((0,o.Z)().mark((function t(){var n,r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new JT(e.datastore),(r=e.qc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Uc(t)}))}))})).catch((function(t){e.Uc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"qc",value:function(e){try{var t=this.updateFunction(e);return!Fk(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Uc",value:function(e){var t=this;this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Lc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"Kc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!ex(t)}return!1}}]),e}(),tN=function(){function e(t,n,r,i){var a=this;ht(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Dg.UNAUTHENTICATED,this.clientId=ek.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lg("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Lg("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return vt(e,[{key:"getConfiguration",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new qg(zg.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Zg;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,s.Z)((0,o.Z)().mark((function n(){var r;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e._onlineComponents,!n.t0){n.next=5;break}return n.next=5,e._onlineComponents.terminate();case 5:if(n.t1=e._offlineComponents,!n.t1){n.next=9;break}return n.next=9,e._offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=CI(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function nN(e,t){return rN.apply(this,arguments)}function rN(){return rN=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Lg("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,HE(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t._offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),rN.apply(this,arguments)}function iN(e,t){return aN.apply(this,arguments)}function aN(){return(aN=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,sN(t);case 3:return r=e.sent,Lg("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return kI(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return kI(n.remoteStore,t)})),t._onlineComponents=n;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oN(e){return"FirebaseError"===e.name?e.code===zg.FAILED_PRECONDITION||e.code===zg.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function sN(e){return uN.apply(this,arguments)}function uN(){return(uN=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._offlineComponents){e.next=21;break}if(!t._uninitializedComponentsProvider){e.next=18;break}return Lg("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,nN(t,t._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),oN(n=e.t0)){e.next=13;break}throw n;case 13:return Fg("Error using user provided cache. Falling back to memory cache: "+n),e.next=16,nN(t,new HT);case 16:e.next=21;break;case 18:return Lg("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,nN(t,new HT);case 21:return e.abrupt("return",t._offlineComponents);case 22:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function cN(e){return lN.apply(this,arguments)}function lN(){return(lN=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t._onlineComponents,e.t0){e.next=11;break}if(!t._uninitializedComponentsProvider){e.next=8;break}return Lg("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,iN(t,t._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return Lg("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,iN(t,new QT);case 11:return e.abrupt("return",t._onlineComponents);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fN(e){return sN(e).then((function(e){return e.persistence}))}function hN(e){return sN(e).then((function(e){return e.localStore}))}function dN(e){return cN(e).then((function(e){return e.remoteStore}))}function pN(e){return cN(e).then((function(e){return e.syncEngine}))}function vN(e){return cN(e).then((function(e){return e.datastore}))}function yN(e){return mN.apply(this,arguments)}function mN(){return(mN=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cN(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=YI.bind(null,n.syncEngine),r.onUnlisten=eT.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function i(){return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new $T({next:function(a){t.enqueueAndForget((function(){return PI(e,o)}));var s=a.docs.has(n);!s&&a.fromCache?i.reject(new qg(zg.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new qg(zg.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new UI(B_(n.path),a,{includeMetadataChanges:!0,Ku:!0});return OI(e,o)},i.next=3,yN(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function kN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function i(){return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new $T({next:function(n){t.enqueueAndForget((function(){return PI(e,o)})),n.fromCache&&"server"===r.source?i.reject(new qg(zg.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new UI(n,a,{includeMetadataChanges:!0,Ku:!0});return OI(e,o)},i.next=3,yN(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function bN(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}var _N=new Map;function wN(e,t,n){if(!n)throw new qg(zg.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function xN(e,t,n,r){if(!0===t&&!0===r)throw new qg(zg.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function SN(e){if(!lk.isDocumentKey(e))throw new qg(zg.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function EN(e){if(lk.isDocumentKey(e))throw new qg(zg.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function CN(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Ug()}function IN(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new qg(zg.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=CN(e);throw new qg(zg.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function TN(e,t){if(t<=0)throw new qg(zg.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var NN=function(){function e(t){var n,r;if(ht(this,e),void 0===t.host){if(void 0!==t.ssl)throw new qg(zg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qg(zg.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}xN("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bN(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new qg(zg.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new qg(zg.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new qg(zg.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}return vt(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}]),e}(),AN=function(){function e(t,n,r,i){ht(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NN({}),this._settingsFrozen=!1}return vt(e,[{key:"app",get:function(){if(!this._app)throw new qg(zg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new qg(zg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NN(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Hg;switch(e.type){case"firstParty":return new Yg(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new qg(zg.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=_N.get(e);t&&(Lg("ComponentProvider","Removing Datastore"),_N.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function DN(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=IN(e,AN))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==o&&Fg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),i.mockUserToken){var s,u;if("string"==typeof i.mockUserToken)s=i.mockUserToken,u=Dg.MOCK_USER;else{s=Nr(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new qg(zg.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Dg(c)}e._authCredentials=new Kg(new Wg(s,u))}}var ON=function(){function e(t,n,r){ht(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return vt(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new PN(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),RN=function(){function e(t,n,r){ht(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return vt(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),PN=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this,e,r,B_(i)))._path=i,a.type="collection",a}return vt(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new ON(this.firestore,null,new lk(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(RN);function LN(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ni(e),wN("collection","path",t),e instanceof AN){var a=sk.fromString.apply(sk,[t].concat(r));return EN(a),new PN(e,null,a)}if(!(e instanceof ON||e instanceof PN))throw new qg(zg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(sk.fromString.apply(sk,[t].concat(r)));return EN(o),new PN(e.firestore,null,o)}function jN(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ni(e),1===arguments.length&&(t=ek.A()),wN("doc","path",t),e instanceof AN){var a=sk.fromString.apply(sk,[t].concat(r));return SN(a),new ON(e,null,new lk(a))}if(!(e instanceof ON||e instanceof PN))throw new qg(zg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(sk.fromString.apply(sk,[t].concat(r)));return SN(o),new ON(e.firestore,e instanceof PN?e.converter:null,new lk(o))}function FN(e,t){return e=ni(e),t=ni(t),(e instanceof ON||e instanceof PN)&&(t instanceof ON||t instanceof PN)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function MN(e,t){return e=ni(e),t=ni(t),e instanceof RN&&t instanceof RN&&e.firestore===t.firestore&&Q_(e._query,t._query)&&e.converter===t.converter}var UN=function(){function e(){var t=this;ht(this,e),this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new DC(this,"async_queue_retry"),this.Xc=function(){var e=NC();e&&Lg("AsyncQueue","Visibility state changed to "+e.visibilityState),t.qo.Mo()};var n=NC();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Xc)}return vt(e,[{key:"isShuttingDown",get:function(){return this.jc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Zc(),this.ta(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;var t=NC();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Zc(),this.jc)return new Promise((function(){}));var n=new Zg;return this.ta((function(){return t.jc&&t.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Qc.push(e),t.ea()}))}},{key:"ea",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Qc.length){e.next=14;break}return e.prev=1,e.next=4,this.Qc[0]();case 4:this.Qc.shift(),this.qo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),Nk(e.t0)){e.next=12;break}throw e.t0;case 12:Lg("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Qc.length>0&&this.qo.No((function(){return t.ea()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"ta",value:function(e){var t=this,n=this.Gc.then((function(){return t.Hc=!0,e().catch((function(e){t.Wc=e,t.Hc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw jg("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Hc=!1,e}))}));return this.Gc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);var i=EI.createAndSchedule(this,e,t,n,(function(e){return r.na(e)}));return this.zc.push(i),i}},{key:"Zc",value:function(){this.Wc&&Ug()}},{key:"verifyOperationInProgress",value:function(){}},{key:"sa",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Gc,e.next=3,t;case 3:if(t!==this.Gc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ia",value:function(e){var t,n=Tt(this.zc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ra",value:function(e){var t=this;return this.sa().then((function(){t.zc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=Tt(t.zc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.sa()}))}},{key:"oa",value:function(e){this.Yc.push(e)}},{key:"na",value:function(e){var t=this.zc.indexOf(e);this.zc.splice(t,1)}}]),e}();function BN(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=Tt(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var VN=function(){function e(){ht(this,e),this._progressObserver={},this._taskCompletionResolver=new Zg,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return vt(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),zN=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a){var o;return ht(this,n),(o=t.call(this,e,r,i,a)).type="firestore",o._queue=new UN,o._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]",o}return vt(n,[{key:"_terminate",value:function(){return this._firestoreClient||ZN(this),this._firestoreClient.terminate()}}]),n}(AN);function qN(e){return e._firestoreClient||ZN(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ZN(e){var t,n,r,i=e._freezeSettings(),a=function(e,t,n,r){return new Pb(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bN(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new tN(e._authCredentials,e._appCheckCredentials,e._queue,a),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function WN(e,t,n){var r=new Zg;return e.asyncQueue.enqueue((0,s.Z)((0,o.Z)().mark((function i(){var a;return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,nN(e,n);case 3:return i.next=5,iN(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),oN(a=i.t0)){i.next=13;break}throw a;case 13:Fg("Error enabling indexeddb cache. Falling back to memory cache: "+a),r.reject(a);case 14:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function HN(e){return function(e){return e.asyncQueue.enqueue((0,s.Z)((0,o.Z)().mark((function t(){var n,r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fN(e);case 2:return n=t.sent,t.next=5,dN(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Vg(e);return t.vu.delete(0),MC(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(qN(e=IN(e,zN)))}function KN(e){return function(e){return e.asyncQueue.enqueue((0,s.Z)((0,o.Z)().mark((function t(){var n,r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fN(e);case 2:return n=t.sent,t.next=5,dN(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Vg(t)).vu.add(0),e.next=4,BC(n);case 4:n.bu.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(qN(e=IN(e,zN)))}function GN(e,t){var n=qN(e=IN(e,zN)),r=new VN;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new XT(e,t)}(function(e,t){if(e instanceof Uint8Array)return YT(e,t);if(e instanceof ArrayBuffer)return YT(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?ix().encode(e):e),t)}(n,AC(t));e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=WT,t.next=3,pN(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function QN(e,t){return function(e,t){return e.asyncQueue.enqueue((0,s.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Vg(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.qs.getNamedQuery(e,t)}))},n.next=3,hN(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(qN(e=IN(e,zN)),t).then((function(t){return t?new RN(e,null,t.query):null}))}function YN(e){if(e._initialized||e._terminated)throw new qg(zg.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var $N=function(){function e(t){ht(this,e),this._byteString=t}return vt(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Cb.fromBase64String(t))}catch(t){throw new qg(zg.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Cb.fromUint8Array(t))}}]),e}(),XN=function(){function e(){ht(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new qg(zg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ck(n)}return vt(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var JN=vt((function e(t){ht(this,e),this._methodName=t})),eA=function(){function e(t,n){if(ht(this,e),!isFinite(t)||t<-90||t>90)throw new qg(zg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new qg(zg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return vt(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return tk(this._lat,e._lat)||tk(this._long,e._long)}}]),e}(),tA=/^__.*__$/,nA=function(){function e(t,n,r){ht(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return vt(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new zw(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vw(e,this.data,t,this.fieldTransforms)}}]),e}(),rA=function(){function e(t,n,r){ht(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return vt(e,[{key:"toMutation",value:function(e,t){return new zw(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function iA(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ug()}}var aA=function(){function e(t,n,r,i,a,o){ht(this,e),this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ua(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return vt(e,[{key:"path",get:function(){return this.settings.path}},{key:"ca",get:function(){return this.settings.ca}},{key:"aa",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ha",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}},{key:"da",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}},{key:"wa",value:function(e){return this.aa({path:void 0,la:!0})}},{key:"_a",value:function(e){return EA(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"ua",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.fa(this.path.get(e))}},{key:"fa",value:function(e){if(0===e.length)throw this._a("Document fields must not be empty");if(iA(this.ca)&&tA.test(e))throw this._a('Document fields cannot begin and end with "__"')}}]),e}(),oA=function(){function e(t,n,r){ht(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||AC(t)}return vt(e,[{key:"ya",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new aA({ca:e,methodName:t,ga:n,path:ck.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),e}();function sA(e){var t=e._freezeSettings(),n=AC(e._databaseId);return new oA(e._databaseId,!!t.ignoreUndefinedProperties,n)}function uA(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.ya(a.merge||a.mergeFields?2:0,t,n,i);_A("Data must be an object, but it was:",o,r);var s,u,c=kA(r,o);if(a.merge)s=new Sb(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=Tt(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=wA(t,l.value,n);if(!o.contains(d))throw new qg(zg.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));CA(f,d)||f.push(d)}}catch(p){h.e(p)}finally{h.f()}s=new Sb(f),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new nA(new r_(c),s,u)}var cA=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.ca)throw 1===e.ca?e._a("".concat(this._methodName,"() can only appear at the top level of your update data")):e._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(JN);function lA(e,t,n){return new aA({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var fA=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"_toFieldTransform",value:function(e){return new Dw(e.path,new xw)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(JN),hA=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e)).pa=r,i}return vt(n,[{key:"_toFieldTransform",value:function(e){var t=lA(this,e,!0),n=this.pa.map((function(e){return gA(e,t)})),r=new Sw(n);return new Dw(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(JN),dA=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e)).pa=r,i}return vt(n,[{key:"_toFieldTransform",value:function(e){var t=lA(this,e,!0),n=this.pa.map((function(e){return gA(e,t)})),r=new Cw(n);return new Dw(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(JN),pA=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e)).Ia=r,i}return vt(n,[{key:"_toFieldTransform",value:function(e){var t=new Tw(e.serializer,gw(e.serializer,this.Ia));return new Dw(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(JN);function vA(e,t,n,r){var i=e.ya(1,t,n);_A("Data must be an object, but it was:",i,r);var a=[],o=r_.empty();yb(r,(function(e,r){var s=SA(t,e,n);r=ni(r);var u=i.da(s);if(r instanceof cA)a.push(s);else{var c=gA(r,u);null!=c&&(a.push(s),o.set(s,c))}}));var s=new Sb(a);return new rA(o,s,i.fieldTransforms)}function yA(e,t,n,r,i,a){var o=e.ya(1,t,n),s=[wA(t,r,n)],u=[i];if(a.length%2!=0)throw new qg(zg.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(wA(t,a[c])),u.push(a[c+1]);for(var l=[],f=r_.empty(),h=s.length-1;h>=0;--h)if(!CA(l,s[h])){var d=s[h],p=u[h];p=ni(p);var v=o.da(d);if(p instanceof cA)l.push(d);else{var y=gA(p,v);null!=y&&(l.push(d),f.set(d,y))}}var m=new Sb(l);return new rA(f,m,o.fieldTransforms)}function mA(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return gA(n,e.ya(r?4:3,t))}function gA(e,t){if(bA(e=ni(e)))return _A("Unsupported field value:",t,e),kA(e,t);if(e instanceof JN)return function(e,t){if(!iA(t.ca))throw t._a("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t._a("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Tt(e);try{for(a.s();!(n=a.n()).done;){var o=gA(n.value,t.wa(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=ni(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return gw(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=ik.fromDate(e);return{timestampValue:Sx(t.serializer,n)}}if(e instanceof ik){var r=new ik(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Sx(t.serializer,r)}}if(e instanceof eA)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof $N)return{bytesValue:Ex(t.serializer,e._byteString)};if(e instanceof ON){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t._a("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:Tx(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a("Unsupported field value: ".concat(CN(e)))}(e,t)}function kA(e,t){var n={};return mb(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):yb(e,(function(e,r){var i=gA(r,t.ha(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function bA(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ik||e instanceof eA||e instanceof $N||e instanceof ON||e instanceof JN)}function _A(e,t,n){if(!bA(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=CN(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function wA(e,t,n){if((t=ni(t))instanceof XN)return t._internalPath;if("string"==typeof t)return SA(e,t);throw EA("Field path arguments must be of type string or ",e,!1,void 0,n)}var xA=new RegExp("[~\\*/\\[\\]]");function SA(e,t,n){if(t.search(xA)>=0)throw EA("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return xt(XN,ft(t.split(".")))._internalPath}catch(r){throw EA("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function EA(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new qg(zg.INVALID_ARGUMENT,s+e+u)}function CA(e,t){return e.some((function(e){return e.isEqual(t)}))}var IA=function(){function e(t,n,r,i,a){ht(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return vt(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new ON(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new TA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(NA("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),TA=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"data",value:function(){return sp(gt(n.prototype),"data",this).call(this)}}]),n}(IA);function NA(e,t){return"string"==typeof t?SA(e,t):t instanceof XN?t._internalPath:t._delegate._internalPath}function AA(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new qg(zg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var DA=vt((function e(){ht(this,e)})),OA=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n)}(DA);function RA(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof DA&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof LA})).length,n=e.filter((function(e){return e instanceof PA})).length;if(t>1||t>0&&n>0)throw new qg(zg.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var o,s=Tt(n);try{for(s.s();!(o=s.n()).done;){e=o.value._apply(e)}}catch(u){s.e(u)}finally{s.f()}return e}var PA=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this))._field=e,a._op=r,a._value=i,a.type="where",a}return vt(n,[{key:"_apply",value:function(e){var t=this._parse(e);return KA(e._query,t),new RN(e.firestore,e.converter,K_(e._query,t))}},{key:"_parse",value:function(e){var t=sA(e.firestore),n=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new qg(zg.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){HA(o,a);var u,c=[],l=Tt(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(WA(r,e,f))}}catch(h){l.e(h)}finally{l.f()}s={arrayValue:{values:c}}}else s=WA(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||HA(o,a),s=mA(n,"where",o,"in"===a||"not-in"===a);return h_.create(i,a,s)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(OA);var LA=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this)).type=e,i._queryConstraints=r,i}return vt(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:d_.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=Tt(t.getFlattenedFilters());try{for(i.s();!(n=i.n()).done;){var a=n.value;KA(r,a),r=K_(r,a)}}catch(o){i.e(o)}finally{i.f()}}(e._query,t),new RN(e.firestore,e.converter,K_(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(DA);var jA=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this))._field=e,i._direction=r,i.type="orderBy",i}return vt(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new qg(zg.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new qg(zg.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new c_(t,n);return function(e,t){if(null===z_(e)){var n=q_(e);null!==n&&GA(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new RN(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new M_(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(OA);var FA=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).type=e,a._limit=r,a._limitType=i,a}return vt(n,[{key:"_apply",value:function(e){return new RN(e.firestore,e.converter,G_(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(OA);var MA=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return vt(n,[{key:"_apply",value:function(e){var t=ZA(e,this.type,this._docOrFields,this._inclusive);return new RN(e.firestore,e.converter,function(e,t){return new M_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(OA);function UA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return MA._create("startAt",t,!0)}function BA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return MA._create("startAfter",t,!1)}var VA=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return vt(n,[{key:"_apply",value:function(e){var t=ZA(e,this.type,this._docOrFields,this._inclusive);return new RN(e.firestore,e.converter,function(e,t){return new M_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(OA);function zA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return VA._create("endBefore",t,!1)}function qA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return VA._create("endAt",t,!0)}function ZA(e,t,n,r){if(n[0]=ni(n[0]),n[0]instanceof IA)return function(e,t,n,r,i){if(!r)throw new qg(zg.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],s=Tt(W_(e));try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.field.isKeyField())o.push(Wb(t,r.key));else{var c=r.data.field(u.field);if(Db(c))throw new qg(zg.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new qg(zg.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(f){s.e(f)}finally{s.f()}return new o_(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=sA(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new qg(zg.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var s=[],u=0;u<i.length;u++){var c=i[u];if(o[u].field.isKeyField()){if("string"!=typeof c)throw new qg(zg.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!Z_(e)&&-1!==c.indexOf("/"))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(sk.fromString(c));if(!lk.isDocumentKey(l))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new lk(l);s.push(Wb(t,f))}else{var h=mA(n,r,c);s.push(h)}}return new o_(s,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function WA(e,t,n){if("string"==typeof(n=ni(n))){if(""===n)throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z_(t)&&-1!==n.indexOf("/"))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(sk.fromString(n));if(!lk.isDocumentKey(r))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Wb(e,new lk(r))}if(n instanceof ON)return Wb(e,n._key);throw new qg(zg.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(CN(n),"."))}function HA(e,t){if(!Array.isArray(e)||0===e.length)throw new qg(zg.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function KA(e,t){if(t.isInequality()){var n=q_(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=z_(e);null!==i&&GA(e,r,i)}var a=function(e,t){var n,r=Tt(e);try{for(r.s();!(n=r.n()).done;){var i,a=Tt(n.value.getFlattenedFilters());try{for(a.s();!(i=a.n()).done;){var o=i.value;if(t.indexOf(o.op)>=0)return o.op}}catch(s){a.e(s)}finally{a.f()}}}catch(s){r.e(s)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new qg(zg.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new qg(zg.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function GA(e,t,n){if(!n.isEqual(t))throw new qg(zg.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var QA=function(){function e(){ht(this,e)}return vt(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Mb(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nb(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ab(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ug()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return yb(e,(function(e,i){r[e]=t.convertValue(i,n)})),r}},{key:"convertGeoPoint",value:function(e){return new eA(Nb(e.latitude),Nb(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Ob(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Rb(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Tb(e);return new ik(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=sk.fromString(e);Bg(Xx(n));var r=new Lb(n.get(1),n.get(3)),i=new lk(n.popFirst(5));return r.isEqual(t)||jg("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function YA(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var $A=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).firestore=e,r}return vt(n,[{key:"convertBytes",value:function(e){return new $N(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ON(this.firestore,null,t)}}]),n}(QA);var XA=function(){function e(t,n){ht(this,e),this.hasPendingWrites=t,this.fromCache=n}return vt(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),JA=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a,o,s){var u;return ht(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return vt(n,[{key:"exists",value:function(){return sp(gt(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new eD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(NA("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(IA),eD=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sp(gt(n.prototype),"data",this).call(this,e)}}]),n}(JA),tD=function(){function e(t,n,r,i){ht(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new XA(i.hasPendingWrites,i.fromCache),this.query=r}return vt(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new eD(n._firestore,n._userDataWriter,r.key,r,new XA(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new qg(zg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new eD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new XA(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new eD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new XA(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:nD(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function nD(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ug()}}function rD(e,t){return e instanceof JA&&t instanceof JA?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof tD&&t instanceof tD&&e._firestore===t._firestore&&MN(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}var iD=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).firestore=e,r}return vt(n,[{key:"convertBytes",value:function(e){return new $N(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ON(this.firestore,null,t)}}]),n}(QA);function aD(e){e=IN(e,ON);var t=IN(e.firestore,zN),n=qN(t),r=new iD(t);return function(e,t){var n=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function r(){return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Vg(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new qg(zg.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=CI(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,hN(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new JA(t,r,e._key,n,new XA(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function oD(e){e=IN(e,RN);var t=IN(e.firestore,zN),n=qN(t),r=new iD(t);return function(e,t){var n=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function r(){return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nC(t,n,!0);case 3:i=e.sent,a=new HI(n,i.ir),s=a.sc(i.documents),u=a.applyChanges(s,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),c=CI(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(c);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,hN(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new tD(t,r,e,n)}))}function sD(e,t,n){e=IN(e,ON);var r=IN(e.firestore,zN),i=YA(e.converter,t,n);return fD(r,[uA(sA(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Rw.none())])}function uD(e,t,n){e=IN(e,ON);for(var r=IN(e.firestore,zN),i=sA(r),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return fD(r,[("string"==typeof(t=ni(t))||t instanceof XN?yA(i,"updateDoc",e._key,t,n,o):vA(i,"updateDoc",e._key,t)).toMutation(e._key,Rw.exists(!0))])}function cD(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,u;e=ni(e);var c={includeMetadataChanges:!1},l=0;"object"!=typeof n[l]||BN(n[l])||(c=n[l],l++);var f,h,d,p={includeMetadataChanges:c.includeMetadataChanges};if(BN(n[l])){var v=n[l];n[l]=null===(i=v.next)||void 0===i?void 0:i.bind(v),n[l+1]=null===(a=v.error)||void 0===a?void 0:a.bind(v),n[l+2]=null===(u=v.complete)||void 0===u?void 0:u.bind(v)}if(e instanceof ON)h=IN(e.firestore,zN),d=B_(e._key.path),f={next:function(t){n[l]&&n[l](hD(h,e,t))},error:n[l+1],complete:n[l+2]};else{var y=IN(e,RN);h=IN(y.firestore,zN),d=y._query;var m=new iD(h);f={next:function(e){n[l]&&n[l](new tD(h,m,y,e))},error:n[l+1],complete:n[l+2]},AA(e._query)}return function(e,t,n,r){var i=new $T(r),a=new UI(t,i,n);return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=OI,t.next=3,yN(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.Dc(),e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=PI,t.next=3,yN(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(qN(h),d,p,f)}function lD(e,t){return function(e,t){var n=new $T(t);return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Vg(e).ku.add(t),t.next()},t.next=3,yN(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.Dc(),e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Vg(e).ku.delete(t)},t.next=3,yN(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(qN(e=IN(e,zN)),BN(t)?t:{next:t})}function fD(e,t){return function(e,t){var n=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function r(){return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=nT,r.next=3,pN(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(qN(e),t)}function hD(e,t,n){var r=n.docs.get(t._key),i=new iD(e);return new JA(e,i,t._key,r,new XA(n.hasPendingWrites,n.fromCache),t.converter)}var dD={maxAttempts:5},pD=function(){function e(t,n){ht(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=sA(t)}return vt(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=vD(e,this._firestore),i=YA(r.converter,t,n),a=uA(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Rw.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=vD(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return r="string"==typeof(t=ni(t))||t instanceof XN?yA(this._dataReader,"WriteBatch.update",i._key,t,n,o):vA(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Rw.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=vD(e,this._firestore);return this._mutations=this._mutations.concat(new Gw(t._key,Rw.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new qg(zg.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function vD(e,t){if((e=ni(e)).firestore!==t)throw new qg(zg.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var yD=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,r))._firestore=e,i}return vt(n,[{key:"get",value:function(e){var t=this,r=vD(e,this._firestore),i=new iD(this._firestore);return sp(gt(n.prototype),"get",this).call(this,e).then((function(e){return new JA(t._firestore,i,r._key,e._document,new XA(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){ht(this,e),this._firestore=t,this._transaction=n,this._dataReader=sA(t)}return vt(e,[{key:"get",value:function(e){var t=this,n=vD(e,this._firestore),r=new $A(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Ug();var i=e[0];if(i.isFoundDocument())return new IA(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new IA(t._firestore,r,n._key,null,n.converter);throw Ug()}))}},{key:"set",value:function(e,t,n){var r=vD(e,this._firestore),i=YA(r.converter,t,n),a=uA(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=vD(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return r="string"==typeof(t=ni(t))||t instanceof XN?yA(this._dataReader,"Transaction.update",i._key,t,n,o):vA(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=vD(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function mD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hA("arrayUnion",t)}function gD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new dA("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Og=e}(Xi),Wi(new ri("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new zN(new Gg(e.getProvider("auth-internal")),new Xg(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new qg(zg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lb(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),ia(Ag,"3.12.2",e),ia(Ag,"3.12.2","esm2017")}();function kD(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new qg("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function bD(){if("undefined"===typeof Uint8Array)throw new qg("unimplemented","Uint8Arrays are not available in this environment.")}function _D(){if("undefined"==typeof atob)throw new qg("unimplemented","Blobs are unavailable in Firestore in this environment.")}var wD=function(){function e(t){ht(this,e),this._delegate=t}return vt(e,[{key:"toBase64",value:function(){return _D(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return bD(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return _D(),new e($N.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return bD(),new e($N.fromUint8Array(t))}}]),e}();function xD(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=Tt(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var SD=function(){function e(){ht(this,e)}return vt(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){YN(e=IN(e,zN));var n=qN(e);if(n._uninitializedComponentsProvider)throw new qg(zg.FAILED_PRECONDITION,"SDK cache is already specified.");Fg("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var r=e._freezeSettings(),i=new QT;return WN(n,i,new KT(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){YN(e=IN(e,zN));var t=qN(e);if(t._uninitializedComponentsProvider)throw new qg(zg.FAILED_PRECONDITION,"SDK cache is already specified.");Fg("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var n=e._freezeSettings(),r=new QT;return WN(t,r,new GT(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new qg(zg.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new Zg;return e._queue.enqueueAndForgetEvenWhileRestricted((0,s.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ck.D()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,Ck.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(VE(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),ED=function(){function e(t,n,r){var i=this;ht(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof Lb||(this._appCompat=t)}return vt(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Fg("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};DN(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return HN(this._delegate)}},{key:"disableNetwork",value:function(){return KN(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&xN("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){var t=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=dT,n.next=3,pN(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(qN(IN(this._delegate,zN)))}},{key:"onSnapshotsInSync",value:function(e){return lD(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new qg("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new UD(this,LN(this._delegate,e))}catch(t){throw DD(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new AD(this,jN(this._delegate,e))}catch(t){throw DD(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new jD(this,function(e,t){if(e=IN(e,AN),wN("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new qg(zg.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new RN(e,null,function(e){return new M_(sk.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw DD(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return function(e,t,n){e=IN(e,zN);var r=Object.assign(Object.assign({},dD),n);return function(e){if(e.maxAttempts<1)throw new qg(zg.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new Zg;return e.asyncQueue.enqueueAndForget((0,s.Z)((0,o.Z)().mark((function i(){var a;return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,vN(e);case 2:a=i.sent,new eN(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}}),i)})))),r.promise}(qN(e),(function(n){return t(new yD(e,n))}),r)}(this._delegate,(function(n){return e(new ID(t,n))}))}},{key:"batch",value:function(){var e=this;return qN(this._delegate),new TD(new pD(this._delegate,(function(t){return fD(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return GN(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return QN(this._delegate,e).then((function(e){return e?new jD(t,e):null}))}}]),e}(),CD=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).firestore=e,r}return vt(n,[{key:"convertBytes",value:function(e){return new wD(new $N(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return AD.forKey(t,this.firestore,null)}}]),n}(QA);var ID=function(){function e(t,n){ht(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new CD(t)}return vt(e,[{key:"get",value:function(e){var t=this,n=BD(e);return this._delegate.get(n).then((function(e){return new PD(t._firestore,new JA(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=BD(e);return n?(kD("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,s=BD(e);2===arguments.length?this._delegate.update(s,t):(o=this._delegate).update.apply(o,[s,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=BD(e);return this._delegate.delete(t),this}}]),e}(),TD=function(){function e(t){ht(this,e),this._delegate=t}return vt(e,[{key:"set",value:function(e,t,n){var r=BD(e);return n?(kD("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,s=BD(e);2===arguments.length?this._delegate.update(s,t):(o=this._delegate).update.apply(o,[s,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=BD(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),ND=function(){function e(t,n,r){ht(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return vt(e,[{key:"fromFirestore",value:function(e,t){var n=new eD(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new LD(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new CD(t),n),i.set(n,a)),a}}]),e}();ND.INSTANCES=new WeakMap;var AD=function(){function e(t,n){ht(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new CD(t)}return vt(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new UD(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new UD(this.firestore,LN(this._delegate,e))}catch(t){throw DD(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=ni(e))instanceof ON&&FN(this._delegate,e)}},{key:"set",value:function(e,t){t=kD("DocumentReference.set",t);try{return t?sD(this._delegate,e,t):sD(this._delegate,e)}catch(n){throw DD(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?uD(this._delegate,e):uD.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw DD(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return fD(IN((e=this._delegate).firestore,zN),[new Gw(e._key,Rw.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=OD(n),a=RD(n,(function(t){return new PD(e.firestore,new JA(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return cD(this._delegate,i,a)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?aD(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=IN(e,ON);var t=IN(e.firestore,zN);return gN(qN(t),e._key,{source:"server"}).then((function(n){return hD(t,e,n)}))}(this._delegate):function(e){e=IN(e,ON);var t=IN(e.firestore,zN);return gN(qN(t),e._key).then((function(n){return hD(t,e,n)}))}(this._delegate)).then((function(e){return new PD(t.firestore,new JA(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(ND.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new qg("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new ON(n._delegate,r,new lk(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new ON(n._delegate,r,t))}}]),e}();function DD(e,t,n){return e.message=e.message.replace(t,n),e}function OD(e){var t,n=Tt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!xD(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function RD(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=xD(e[0])?e[0]:xD(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var PD=function(){function e(t,n){ht(this,e),this._firestore=t,this._delegate=n}return vt(e,[{key:"ref",get:function(){return new AD(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return rD(this._delegate,e._delegate)}}]),e}(),LD=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||Ug(),t}}]),n}(PD),jD=function(){function e(t,n){ht(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new CD(t)}return vt(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,RA(this._delegate,function(e,t,n){var r=t,i=NA("where",e);return PA._create(i,r,n)}(t,n,r)))}catch(i){throw DD(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,RA(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=NA("orderBy",e);return jA._create(n,t)}(t,n)))}catch(r){throw DD(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,RA(this._delegate,(TN("limit",n=t),FA._create("limit",n,"F"))))}catch(r){throw DD(r,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,RA(this._delegate,(TN("limitToLast",n=t),FA._create("limitToLast",n,"L"))))}catch(r){throw DD(r,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){try{return new e(this.firestore,RA(this._delegate,UA.apply(void 0,arguments)))}catch(t){throw DD(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,RA(this._delegate,BA.apply(void 0,arguments)))}catch(t){throw DD(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,RA(this._delegate,zA.apply(void 0,arguments)))}catch(t){throw DD(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,RA(this._delegate,qA.apply(void 0,arguments)))}catch(t){throw DD(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return MN(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?oD(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=IN(e,RN);var t=IN(e.firestore,zN),n=qN(t),r=new iD(t);return kN(n,e._query,{source:"server"}).then((function(n){return new tD(t,r,e,n)}))}(this._delegate):function(e){e=IN(e,RN);var t=IN(e.firestore,zN),n=qN(t),r=new iD(t);return AA(e._query),kN(n,e._query).then((function(n){return new tD(t,r,e,n)}))}(this._delegate)).then((function(e){return new MD(t.firestore,new tD(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=OD(n),a=RD(n,(function(t){return new MD(e.firestore,new tD(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return cD(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(ND.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),FD=function(){function e(t,n){ht(this,e),this._firestore=t,this._delegate=n}return vt(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new LD(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),MD=function(){function e(t,n){ht(this,e),this._firestore=t,this._delegate=n}return vt(e,[{key:"query",get:function(){return new jD(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new LD(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new FD(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new LD(n._firestore,r))}))}},{key:"isEqual",value:function(e){return rD(this._delegate,e._delegate)}}]),e}(),UD=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return vt(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new AD(this.firestore,e):null}},{key:"doc",value:function(e){try{return new AD(this.firestore,void 0===e?jN(this._delegate):jN(this._delegate,e))}catch(t){throw DD(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=IN(e.firestore,zN),r=jN(e),i=YA(e.converter,t);return fD(n,[uA(sA(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Rw.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new AD(t.firestore,e)}))}},{key:"isEqual",value:function(e){return FN(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(ND.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(jD);function BD(e){return IN(e,ON)}var VD=function(){function e(){ht(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=xt(XN,n)}return vt(e,[{key:"isEqual",value:function(e){return(e=ni(e))instanceof XN&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(ck.keyField().canonicalString())}}]),e}(),zD=function(){function e(t){ht(this,e),this._delegate=t}return vt(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new fA("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new cA("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=mD.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=gD.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=new pA("increment",t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),qD={Firestore:ED,GeoPoint:eA,Timestamp:ik,Blob:wD,Transaction:ID,WriteBatch:TD,DocumentReference:AD,DocumentSnapshot:PD,Query:jD,QueryDocumentSnapshot:LD,QuerySnapshot:MD,CollectionReference:UD,FieldPath:VD,FieldValue:zD,setLogLevel:function(e){var t;t=e,Rg.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!function(e){!function(e,t){e.INTERNAL.registerComponent(new ri("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},qD)))}(e,(function(e,t){return new ED(e,t,new SD)})),e.registerVersion("@firebase/firestore-compat","0.3.11")}(Aa);Aa.initializeApp({apiKey:"AIzaSyCncHs0oDoCmDveoAMZvSkLXuc4syN2Mg4",authDomain:"facebugserver.firebaseapp.com",databaseURL:"https://facebugserver-default-rtdb.europe-west1.firebasedatabase.app",projectId:"facebugserver",storageBucket:"facebugserver.appspot.com",messagingSenderId:"915472090039",appId:"1:915472090039:web:532f827244997362d29e32"});Aa.firestore();var ZD=Aa.storage().ref(),WD=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function HD(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.split(/[:\/]/g).pop().toLowerCase()}HD.valid=function(e){return WD.test(e)};var KD=HD,GD=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n((function(e){return[t].concat(ft(e))}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function QD(e){var t=e.handleFileChange,n=(0,r.useState)(!1),i=(0,u.Z)(n,2),a=i[0],o=i[1],s=(0,r.useRef)(null),c=function(e){e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?o(!0):"dragleave"===e.type&&o(!1)};return(0,ot.jsxs)("form",{id:"form-file-upload",onDragEnter:c,onSubmit:function(e){return e.preventDefault()},children:[(0,ot.jsx)("input",{ref:s,type:"file",id:"input-file-upload",accept:".jpg,.jpeg,.png,.mp4",multiple:!0,onChange:function(e){if(e.preventDefault(),e.target.files&&e.target.files[0])for(var n=0;n<e.target.files.length;n++){var r=e.target.files[n];t(r)}}}),(0,ot.jsx)("label",{id:"label-file-upload",htmlFor:"input-file-upload",className:a?"drag-active":"",children:(0,ot.jsxs)("div",{children:[(0,ot.jsx)("p",{children:"Drag and drop your file here or"}),(0,ot.jsx)("button",{className:"upload-button",onClick:function(){s.current.click()},children:"Upload a file"})]})}),a&&(0,ot.jsx)("div",{id:"drag-file-element",onDragEnter:c,onDragLeave:c,onDragOver:c,onDrop:function(e){if(e.preventDefault(),e.stopPropagation(),o(!1),e.dataTransfer.files&&e.dataTransfer.files[0])for(var n=0;n<e.dataTransfer.files.length;n++){var r=e.dataTransfer.files[n];t(r)}}})]})}function YD(e){var t=e.handleFileChange,n=(0,r.useState)(null),i=(0,u.Z)(n,2);i[0],i[1];return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsx)("input",{className:"custom-file-input",type:"file",accept:".jpg,.jpeg,.png",multiple:!0,onChange:function(e){if(e.preventDefault(),e.target.files&&e.target.files[0])for(var n=0;n<e.target.files.length;n++){var r=e.target.files[n];t(r)}}})})}function $D(e){var t=e.setPosts,n=(0,r.useContext)(Xn).myProfile,i=(0,r.useState)(!1),a=(0,u.Z)(i,2),c=a[0],l=a[1],f=(0,r.useState)(""),h=(0,u.Z)(f,2),d=h[0],p=h[1],v=(0,r.useState)([]),y=(0,u.Z)(v,2),m=y[0],g=y[1];function k(e,t){t(!e)}var b=!d&&!m,_=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={AutorName:n.Email,TextContent:d,MediaFiles:[],Date:Date.now()},i=[],m.length>0&&(i=m.map(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,u.Z)(t,2),r=n[0],n[1],i=null!==r&&void 0!==r&&r.type.includes("image")?"Images":"Videos",a=ZD.child("/post".concat(i,"/").concat(null===r||void 0===r?void 0:r.name,"+").concat(KD())),e.next=5,a.put(r);case 5:return e.next=7,a.getDownloadURL();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.next=5,Promise.all(i);case 5:r.MediaFiles=e.sent,lr(r,"post-post").then((function(e){GD(e,t)}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(e){var t=new FileReader;t.onload=function(){var n=t.result;g((function(t){return[].concat(ft(t),[[e,n]])}))},e&&t.readAsDataURL(e)};return(0,ot.jsxs)("div",{className:"post-form ",children:[(0,ot.jsxs)("span",{className:"post-form-up shadow-around",children:[(0,ot.jsx)("img",{src:n.ProfileImage}),(0,ot.jsx)("div",{className:"post-form-up-placeholder",onClick:function(){k(c,l)},children:"What do you want to post?"}),(0,ot.jsx)(ur,{isOpen:c,toggleModal:function(){k(c,l),p(""),g([])},children:(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("div",{className:"modal-header",children:"Create post"}),(0,ot.jsxs)("div",{className:"modal-body",children:[(0,ot.jsxs)("span",{className:"modal-body-profile",children:[(0,ot.jsx)("img",{src:n.ProfileImage}),(0,ot.jsx)("span",{children:n.Email})]}),(0,ot.jsx)("div",{className:"modal-body-text",contentEditable:!0,placeholder:"Write something...",onInput:function(e){p(e.target.innerHTML)}}),m&&m.map((function(e,t){var n=(0,u.Z)(e,2),r=n[0],i=n[1],a=i&&i.includes("data:image")?"Images":"Videos";return(0,ot.jsxs)("div",{style:{width:"100%",aspectRatio:"1",position:"relative"},children:["Images"==a&&(0,ot.jsx)("img",{className:"modal-body-image",src:i}),"Videos"==a&&(0,ot.jsx)("video",{style:{width:"100%",aspectRatio:"1"},controls:!0,children:(0,ot.jsx)("source",{src:i,type:"video/mp4"})}),(0,ot.jsx)("img",{className:"erase-image",style:{height:"2rem"},src:"".concat(rr,"/redX.png"),onClick:function(){return function(e){var t=m.filter((function(t){var n=(0,u.Z)(t,2),r=n[0];return n[1],r.name!=e}));g(t)}(r.name)}})]},t)})),(0,ot.jsx)(QD,{handleFileChange:w})]}),(0,ot.jsx)("div",{className:"modal-image",children:(0,ot.jsx)(YD,{handleFileChange:w})})]}),disableSubmit:b,submitButtonText:"Submit post",onSubmit:_})]}),(0,ot.jsx)("span",{className:"post-form-down"})]})}function XD(e){var t=e.message,n=e.eventMessage;return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsxs)("div",{style:{margin:"0 auto",alignSelf:"center"},children:[(0,ot.jsxs)("div",{className:"loader",children:[(0,ot.jsx)("span",{className:"loader__element"}),(0,ot.jsx)("span",{className:"loader__element"}),(0,ot.jsx)("span",{className:"loader__element"})]}),t&&(0,ot.jsx)("h1",{children:t}),n&&(0,ot.jsx)("h2",{className:"event-message",children:n})]})})}function JD(e){return null!==e&&void 0!==e&&e.list?0===e.list.length?e.emptyListUI?e.emptyListUI:(0,ot.jsx)(ot.Fragment,{children:"There are no elements to display"}):e.children:(0,ot.jsx)(XD,{message:"Loading"})}function eO(e){var t=(0,r.useState)(!1),n=(0,u.Z)(t,2),i=n[0],a=n[1],o=(0,r.useState)(""),s=(0,u.Z)(o,2),c=s[0],l=s[1];(0,r.useEffect)((function(){e.TextContent.length>150&&(l(e.TextContent.slice(0,50)),a(!0))}),[]);var f=e.AutorProfileImage||"".concat(rr,"/noProfile.jpg");return(0,ot.jsxs)("div",{className:"comment",children:[(0,ot.jsxs)("div",{className:"comment-profile",children:[(0,ot.jsx)("img",{className:"comment-profile-image",src:f,alt:"profile"}),(0,ot.jsx)("span",{className:"comment-profile-name",children:e.AutorName})]}),(0,ot.jsx)("div",{className:"comment-text",children:i?(0,ot.jsxs)(ot.Fragment,{children:[c,(0,ot.jsx)("span",{className:"show-text",onClick:function(){a(!1)},children:"...Show more"})]}):e.TextContent})]})}function tO(e){var t=e.comments;return(0,ot.jsx)(JD,{list:t,emptyListUI:(0,ot.jsx)(ot.Fragment,{}),children:(0,ot.jsx)("span",{className:"post-comments-comments",children:t?null===t||void 0===t?void 0:t.map((function(e){return(0,ot.jsx)(eO,{Id:e.Id,PostId:e.PostId,AutorName:e.AutorName,TextContent:e.TextContent,AutorProfileImage:e.AutorProfileImage,Date:e.Date},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}function nO(e){var t=e.image,n=(0,r.useRef)(null),i=(0,r.useState)({}),a=(0,u.Z)(i,2),o=a[0],s=a[1];return(0,r.useEffect)((function(){if(n.current){var e=n.current.parentNode;!function(e,t){var n=new Image;n.onload=function(){return t(null,n)},n.onerror=function(e){return t(e)},n.src=e}(t,(function(t,n){var r=n.naturalWidth,i=n.naturalHeight,a=e.offsetWidth,o=e.offsetHeight;a<r?s({width:"".concat(a,"px"),height:"100%"}):o<i&&s({width:"100%",height:"".concat(o,"px")})}))}}),[n]),(0,ot.jsx)("img",{ref:n,style:o,src:t})}function rO(e){var t=e.mediaFiles,n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o=(0,r.useState)(!1),s=(0,u.Z)(o,2),c=s[0],l=s[1],f=(0,r.useState)(!1),h=(0,u.Z)(f,2),d=h[0],p=h[1];return(0,r.useEffect)((function(){p(!0)}),[]),(0,r.useEffect)((function(){if(n.current&&i.current&&a.current){i.current.addEventListener("click",(function(){n.current.scrollBy({left:-n.current.offsetWidth,behavior:"smooth"})})),a.current.addEventListener("click",(function(){n.current.scrollBy({left:n.current.offsetWidth,behavior:"smooth"})}));n.current.addEventListener("scroll",(function(){var e=n.current,t=e.scrollLeft,r=e.scrollWidth,i=e.clientWidth,a=Math.floor(t)+i>=r-10,o=0==t;l(a),p(o)}))}}),[n,i,a,c,d]),(0,ot.jsx)(ot.Fragment,{children:t&&(0,ot.jsxs)("div",{className:"box",children:[(0,ot.jsx)("div",{ref:n,className:"container",children:t.map((function(e){return(0,ot.jsxs)("span",{className:"element",children:[e.includes(".jpg")||e.includes(".jpeg")||e.includes(".png")&&(0,ot.jsx)(nO,{image:e}),e.includes(".mp4")&&(0,ot.jsx)("video",{controls:!0,children:(0,ot.jsx)("source",{src:e,type:"video/mp4"})})]},e)}))}),t.length>1&&(0,ot.jsxs)(ot.Fragment,{children:[!d&&(0,ot.jsx)("div",{ref:i,style:{backgroundImage:"url(".concat(rr,"/goBackArrow.png)")},className:"scroll scroll-left"}),!c&&(0,ot.jsx)("div",{ref:a,style:{backgroundImage:"url(".concat(rr,"/goBackArrow.png)")},className:"scroll scroll-right"})]})]})})}function iO(e){var t=e.post,n=(0,r.useContext)(Xn).myProfile,i=(0,r.useState)(),a=(0,u.Z)(i,2),c=a[0],l=a[1],f=(0,r.useState)(!1),h=(0,u.Z)(f,2),d=h[0],p=h[1],v=(0,r.useState)(t.AmountOfLikes),y=(0,u.Z)(v,2),m=y[0],g=y[1],k=(0,r.useState)(!1),b=(0,u.Z)(k,2),_=b[0],w=b[1],x=(0,r.useState)(t.AmountOfComments),S=(0,u.Z)(x,2),E=S[0],C=S[1],I=(0,r.useState)(""),T=(0,u.Z)(I,2),N=T[0],A=T[1],D=(0,r.useState)(!1),O=(0,u.Z)(D,2),R=O[0],P=O[1],L=(0,r.useState)(!1),j=(0,u.Z)(L,2),F=j[0],M=j[1],U=(0,r.useState)(!1),B=(0,u.Z)(U,2),V=B[0],z=B[1],q=(0,r.useState)(""),Z=(0,u.Z)(q,2),W=Z[0],H=Z[1];(0,r.useEffect)((function(){t.TextContent.length>100&&(H(t.TextContent.slice(0,50)),z(!0))}),[]);var K=function(e,t){var n=(0,r.useState)(e),i=(0,u.Z)(n,2),a=i[0],o=i[1];return(0,r.useEffect)((function(){var n=setTimeout((function(){o(e)}),t);return function(){clearTimeout(n)}}),[e,t]),a}(m,1e3),G=t.AutorProfileImage||"".concat(rr,"/noProfile.jpg");function Q(){return(Q=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=p,e.next=3,lr({postId:t.Id,userId:n.Id},"user-liked-post");case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fr({postId:t.Id,userId:n.Id},d?"like-post":"like-post-remove");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=(0,s.Z)((0,o.Z)().mark((function e(){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(E+1),e.next=3,lr({postId:t.Id,userId:n.Id,textContent:N,autorName:n.Email,date:Date.now()},"put-comment");case 3:(r=e.sent).AutorProfileImage=n.ProfileImage,GD(r,l),A("");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return J.apply(this,arguments)}function J(){return(J=(0,s.Z)((0,o.Z)().mark((function e(n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({postId:t.Id,numberOfComments:n},"get-comments");case 2:r=e.sent,(null===c||void 0===c?void 0:c.length)==r.length?M(!0):l(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,r.useEffect)((function(){!function(){Q.apply(this,arguments)}()}),[]),(0,r.useEffect)((function(){_&&function(){Y.apply(this,arguments)}()}),[K]);var ee=d?"#89CFF0":"",te=0==N.length;return(0,ot.jsxs)("div",{className:"post shadow-around",children:[(0,ot.jsxs)("div",{className:"post-profile",children:[(0,ot.jsx)("img",{src:G}),(0,ot.jsx)("span",{children:t.AutorName})]}),(0,ot.jsxs)("div",{className:"post-content",children:[t.TextContent&&(0,ot.jsx)("span",{className:"post-content-text",children:V?(0,ot.jsxs)(ot.Fragment,{children:[W,(0,ot.jsx)("span",{className:"show-text",onClick:function(){z(!1)},children:"...Show more"})]}):t.TextContent}),(0,ot.jsx)(rO,{mediaFiles:t.MediaFiles})]}),(0,ot.jsxs)("div",{className:"post-bottom",children:[(0,ot.jsxs)("div",{className:"post-bottom-up",children:[(0,ot.jsxs)("div",{className:"option",children:[(0,ot.jsx)("img",{src:"".concat(rr,"/like.png")}),(0,ot.jsx)("span",{className:"large-font",children:m})]}),(0,ot.jsx)("div",{className:"option",children:(0,ot.jsxs)("span",{className:"large-font",children:[E," comments"]})})]}),(0,ot.jsxs)("div",{className:"post-bottom-down",children:[(0,ot.jsx)("button",{style:{backgroundColor:ee},onClick:function(){d?(g(m-1),p(!1)):(g(m+1),p(!0)),w(!0)},children:"I like it!"}),(0,ot.jsx)("button",{onClick:function(){0==R&&(c||X(10)),P(!R)},children:"Comment it"})]})]}),R&&(0,ot.jsxs)("div",{className:"post-comments",children:[(0,ot.jsxs)("span",{className:"post-comments-input",children:[(0,ot.jsx)("textarea",{id:"comment-text/".concat(t.Id),value:N,onInput:function(e){return A(e.target.value)}}),(0,ot.jsx)("button",{disabled:te,type:"submit",onClick:function(){return $.apply(this,arguments)},children:"Post comment"})]}),c&&(0,ot.jsx)(tO,{comments:c}),0==(null===c||void 0===c?void 0:c.length)||F?(0,ot.jsx)("span",{children:"There are no more comments"}):(0,ot.jsx)("span",{className:"post-comments-more",onClick:function(){X((null===c||void 0===c?void 0:c.length)+10)},children:"Show more..."})]})]})}function aO(e){var t;return(0,ot.jsx)(JD,{list:e.posts,emptyListUI:(0,ot.jsx)(ot.Fragment,{}),children:(0,ot.jsx)("div",{className:"listOfPosts",children:e.posts?null===(t=e.posts)||void 0===t?void 0:t.map((function(e){return(0,ot.jsx)(iO,{post:e},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}var oO=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0px",n=(0,r.useState)(!1),i=(0,u.Z)(n,2),a=i[0],o=i[1],s=(0,r.useMemo)((function(){return new IntersectionObserver((function(e){var t=(0,u.Z)(e,1)[0];o(t.isIntersecting)}),{rootMargin:t})}),[]);return(0,r.useEffect)((function(){if(null!=e.current)return s.observe(e.current),function(){s.disconnect()}}),[e.current,s]),a},sO=n(77),uO=n.n(sO),cO=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===lO}(e)}(e)};var lO="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function fO(e,t){return!1!==t.clone&&t.isMergeableObject(e)?dO(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function hO(e,t,n){return e.concat(t).map((function(e){return fO(e,n)}))}function dO(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||hO,n.isMergeableObject=n.isMergeableObject||cO;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):function(e,t,n){var r={};return n.isMergeableObject(e)&&Object.keys(e).forEach((function(t){r[t]=fO(e[t],n)})),Object.keys(t).forEach((function(i){n.isMergeableObject(t[i])&&e[i]?r[i]=dO(e[i],t[i],n):r[i]=fO(t[i],n)})),r}(e,t,n):fO(t,n)}dO.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return dO(e,n,t)}),{})};var pO=dO,vO="object"==typeof global&&global&&global.Object===Object&&global,yO="object"==typeof self&&self&&self.Object===Object&&self,mO=vO||yO||Function("return this")(),gO=mO.Symbol,kO=Object.prototype,bO=kO.hasOwnProperty,_O=kO.toString,wO=gO?gO.toStringTag:void 0;var xO=function(e){var t=bO.call(e,wO),n=e[wO];try{e[wO]=void 0;var r=!0}catch(a){}var i=_O.call(e);return r&&(t?e[wO]=n:delete e[wO]),i},SO=Object.prototype.toString;var EO=function(e){return SO.call(e)},CO=gO?gO.toStringTag:void 0;var IO=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":CO&&CO in Object(e)?xO(e):EO(e)};var TO=function(e,t){return function(n){return e(t(n))}},NO=TO(Object.getPrototypeOf,Object);var AO=function(e){return null!=e&&"object"==typeof e},DO=Function.prototype,OO=Object.prototype,RO=DO.toString,PO=OO.hasOwnProperty,LO=RO.call(Object);var jO=function(e){if(!AO(e)||"[object Object]"!=IO(e))return!1;var t=NO(e);if(null===t)return!0;var n=PO.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&RO.call(n)==LO};var FO=function(){this.__data__=[],this.size=0};var MO=function(e,t){return e===t||e!==e&&t!==t};var UO=function(e,t){for(var n=e.length;n--;)if(MO(e[n][0],t))return n;return-1},BO=Array.prototype.splice;var VO=function(e){var t=this.__data__,n=UO(t,e);return!(n<0)&&(n==t.length-1?t.pop():BO.call(t,n,1),--this.size,!0)};var zO=function(e){var t=this.__data__,n=UO(t,e);return n<0?void 0:t[n][1]};var qO=function(e){return UO(this.__data__,e)>-1};var ZO=function(e,t){var n=this.__data__,r=UO(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function WO(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}WO.prototype.clear=FO,WO.prototype.delete=VO,WO.prototype.get=zO,WO.prototype.has=qO,WO.prototype.set=ZO;var HO=WO;var KO=function(){this.__data__=new HO,this.size=0};var GO=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var QO=function(e){return this.__data__.get(e)};var YO=function(e){return this.__data__.has(e)};var $O=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var XO=function(e){if(!$O(e))return!1;var t=IO(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},JO=mO["__core-js_shared__"],eR=function(){var e=/[^.]+$/.exec(JO&&JO.keys&&JO.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var tR=function(e){return!!eR&&eR in e},nR=Function.prototype.toString;var rR=function(e){if(null!=e){try{return nR.call(e)}catch(t){}try{return e+""}catch(t){}}return""},iR=/^\[object .+?Constructor\]$/,aR=Function.prototype,oR=Object.prototype,sR=aR.toString,uR=oR.hasOwnProperty,cR=RegExp("^"+sR.call(uR).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var lR=function(e){return!(!$O(e)||tR(e))&&(XO(e)?cR:iR).test(rR(e))};var fR=function(e,t){return null==e?void 0:e[t]};var hR=function(e,t){var n=fR(e,t);return lR(n)?n:void 0},dR=hR(mO,"Map"),pR=hR(Object,"create");var vR=function(){this.__data__=pR?pR(null):{},this.size=0};var yR=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},mR=Object.prototype.hasOwnProperty;var gR=function(e){var t=this.__data__;if(pR){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return mR.call(t,e)?t[e]:void 0},kR=Object.prototype.hasOwnProperty;var bR=function(e){var t=this.__data__;return pR?void 0!==t[e]:kR.call(t,e)};var _R=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=pR&&void 0===t?"__lodash_hash_undefined__":t,this};function wR(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}wR.prototype.clear=vR,wR.prototype.delete=yR,wR.prototype.get=gR,wR.prototype.has=bR,wR.prototype.set=_R;var xR=wR;var SR=function(){this.size=0,this.__data__={hash:new xR,map:new(dR||HO),string:new xR}};var ER=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var CR=function(e,t){var n=e.__data__;return ER(t)?n["string"==typeof t?"string":"hash"]:n.map};var IR=function(e){var t=CR(this,e).delete(e);return this.size-=t?1:0,t};var TR=function(e){return CR(this,e).get(e)};var NR=function(e){return CR(this,e).has(e)};var AR=function(e,t){var n=CR(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function DR(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}DR.prototype.clear=SR,DR.prototype.delete=IR,DR.prototype.get=TR,DR.prototype.has=NR,DR.prototype.set=AR;var OR=DR;var RR=function(e,t){var n=this.__data__;if(n instanceof HO){var r=n.__data__;if(!dR||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new OR(r)}return n.set(e,t),this.size=n.size,this};function PR(e){var t=this.__data__=new HO(e);this.size=t.size}PR.prototype.clear=KO,PR.prototype.delete=GO,PR.prototype.get=QO,PR.prototype.has=YO,PR.prototype.set=RR;var LR=PR;var jR=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},FR=function(){try{var e=hR(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();var MR=function(e,t,n){"__proto__"==t&&FR?FR(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},UR=Object.prototype.hasOwnProperty;var BR=function(e,t,n){var r=e[t];UR.call(e,t)&&MO(r,n)&&(void 0!==n||t in e)||MR(e,t,n)};var VR=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?MR(n,s,u):BR(n,s,u)}return n};var zR=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var qR=function(e){return AO(e)&&"[object Arguments]"==IO(e)},ZR=Object.prototype,WR=ZR.hasOwnProperty,HR=ZR.propertyIsEnumerable,KR=qR(function(){return arguments}())?qR:function(e){return AO(e)&&WR.call(e,"callee")&&!HR.call(e,"callee")},GR=KR,QR=Array.isArray;var YR=function(){return!1},$R="object"==typeof exports&&exports&&!exports.nodeType&&exports,XR=$R&&"object"==typeof module&&module&&!module.nodeType&&module,JR=XR&&XR.exports===$R?mO.Buffer:void 0,eP=(JR?JR.isBuffer:void 0)||YR,tP=/^(?:0|[1-9]\d*)$/;var nP=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&tP.test(e))&&e>-1&&e%1==0&&e<t};var rP=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},iP={};iP["[object Float32Array]"]=iP["[object Float64Array]"]=iP["[object Int8Array]"]=iP["[object Int16Array]"]=iP["[object Int32Array]"]=iP["[object Uint8Array]"]=iP["[object Uint8ClampedArray]"]=iP["[object Uint16Array]"]=iP["[object Uint32Array]"]=!0,iP["[object Arguments]"]=iP["[object Array]"]=iP["[object ArrayBuffer]"]=iP["[object Boolean]"]=iP["[object DataView]"]=iP["[object Date]"]=iP["[object Error]"]=iP["[object Function]"]=iP["[object Map]"]=iP["[object Number]"]=iP["[object Object]"]=iP["[object RegExp]"]=iP["[object Set]"]=iP["[object String]"]=iP["[object WeakMap]"]=!1;var aP=function(e){return AO(e)&&rP(e.length)&&!!iP[IO(e)]};var oP=function(e){return function(t){return e(t)}},sP="object"==typeof exports&&exports&&!exports.nodeType&&exports,uP=sP&&"object"==typeof module&&module&&!module.nodeType&&module,cP=uP&&uP.exports===sP&&vO.process,lP=function(){try{var e=uP&&uP.require&&uP.require("util").types;return e||cP&&cP.binding&&cP.binding("util")}catch(t){}}(),fP=lP&&lP.isTypedArray,hP=fP?oP(fP):aP,dP=Object.prototype.hasOwnProperty;var pP=function(e,t){var n=QR(e),r=!n&&GR(e),i=!n&&!r&&eP(e),a=!n&&!r&&!i&&hP(e),o=n||r||i||a,s=o?zR(e.length,String):[],u=s.length;for(var c in e)!t&&!dP.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||nP(c,u))||s.push(c);return s},vP=Object.prototype;var yP=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||vP)},mP=TO(Object.keys,Object),gP=Object.prototype.hasOwnProperty;var kP=function(e){if(!yP(e))return mP(e);var t=[];for(var n in Object(e))gP.call(e,n)&&"constructor"!=n&&t.push(n);return t};var bP=function(e){return null!=e&&rP(e.length)&&!XO(e)};var _P=function(e){return bP(e)?pP(e):kP(e)};var wP=function(e,t){return e&&VR(t,_P(t),e)};var xP=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},SP=Object.prototype.hasOwnProperty;var EP=function(e){if(!$O(e))return xP(e);var t=yP(e),n=[];for(var r in e)("constructor"!=r||!t&&SP.call(e,r))&&n.push(r);return n};var CP=function(e){return bP(e)?pP(e,!0):EP(e)};var IP=function(e,t){return e&&VR(t,CP(t),e)},TP="object"==typeof exports&&exports&&!exports.nodeType&&exports,NP=TP&&"object"==typeof module&&module&&!module.nodeType&&module,AP=NP&&NP.exports===TP?mO.Buffer:void 0,DP=AP?AP.allocUnsafe:void 0;var OP=function(e,t){if(t)return e.slice();var n=e.length,r=DP?DP(n):new e.constructor(n);return e.copy(r),r};var RP=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var PP=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a};var LP=function(){return[]},jP=Object.prototype.propertyIsEnumerable,FP=Object.getOwnPropertySymbols,MP=FP?function(e){return null==e?[]:(e=Object(e),PP(FP(e),(function(t){return jP.call(e,t)})))}:LP,UP=MP;var BP=function(e,t){return VR(e,UP(e),t)};var VP=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},zP=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)VP(t,UP(e)),e=NO(e);return t}:LP,qP=zP;var ZP=function(e,t){return VR(e,qP(e),t)};var WP=function(e,t,n){var r=t(e);return QR(e)?r:VP(r,n(e))};var HP=function(e){return WP(e,_P,UP)};var KP=function(e){return WP(e,CP,qP)},GP=hR(mO,"DataView"),QP=hR(mO,"Promise"),YP=hR(mO,"Set"),$P=hR(mO,"WeakMap"),XP="[object Map]",JP="[object Promise]",eL="[object Set]",tL="[object WeakMap]",nL="[object DataView]",rL=rR(GP),iL=rR(dR),aL=rR(QP),oL=rR(YP),sL=rR($P),uL=IO;(GP&&uL(new GP(new ArrayBuffer(1)))!=nL||dR&&uL(new dR)!=XP||QP&&uL(QP.resolve())!=JP||YP&&uL(new YP)!=eL||$P&&uL(new $P)!=tL)&&(uL=function(e){var t=IO(e),n="[object Object]"==t?e.constructor:void 0,r=n?rR(n):"";if(r)switch(r){case rL:return nL;case iL:return XP;case aL:return JP;case oL:return eL;case sL:return tL}return t});var cL=uL,lL=Object.prototype.hasOwnProperty;var fL=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&lL.call(e,"index")&&(n.index=e.index,n.input=e.input),n},hL=mO.Uint8Array;var dL=function(e){var t=new e.constructor(e.byteLength);return new hL(t).set(new hL(e)),t};var pL=function(e,t){var n=t?dL(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},vL=/\w*$/;var yL=function(e){var t=new e.constructor(e.source,vL.exec(e));return t.lastIndex=e.lastIndex,t},mL=gO?gO.prototype:void 0,gL=mL?mL.valueOf:void 0;var kL=function(e){return gL?Object(gL.call(e)):{}};var bL=function(e,t){var n=t?dL(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var _L=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return dL(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return pL(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return bL(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return yL(e);case"[object Symbol]":return kL(e)}},wL=Object.create,xL=function(){function e(){}return function(t){if(!$O(t))return{};if(wL)return wL(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),SL=xL;var EL=function(e){return"function"!=typeof e.constructor||yP(e)?{}:SL(NO(e))};var CL=function(e){return AO(e)&&"[object Map]"==cL(e)},IL=lP&&lP.isMap,TL=IL?oP(IL):CL;var NL=function(e){return AO(e)&&"[object Set]"==cL(e)},AL=lP&&lP.isSet,DL=AL?oP(AL):NL,OL="[object Arguments]",RL="[object Function]",PL="[object Object]",LL={};LL[OL]=LL["[object Array]"]=LL["[object ArrayBuffer]"]=LL["[object DataView]"]=LL["[object Boolean]"]=LL["[object Date]"]=LL["[object Float32Array]"]=LL["[object Float64Array]"]=LL["[object Int8Array]"]=LL["[object Int16Array]"]=LL["[object Int32Array]"]=LL["[object Map]"]=LL["[object Number]"]=LL[PL]=LL["[object RegExp]"]=LL["[object Set]"]=LL["[object String]"]=LL["[object Symbol]"]=LL["[object Uint8Array]"]=LL["[object Uint8ClampedArray]"]=LL["[object Uint16Array]"]=LL["[object Uint32Array]"]=!0,LL["[object Error]"]=LL[RL]=LL["[object WeakMap]"]=!1;var jL=function e(t,n,r,i,a,o){var s,u=1&n,c=2&n,l=4&n;if(r&&(s=a?r(t,i,a,o):r(t)),void 0!==s)return s;if(!$O(t))return t;var f=QR(t);if(f){if(s=fL(t),!u)return RP(t,s)}else{var h=cL(t),d=h==RL||"[object GeneratorFunction]"==h;if(eP(t))return OP(t,u);if(h==PL||h==OL||d&&!a){if(s=c||d?{}:EL(t),!u)return c?ZP(t,IP(s,t)):BP(t,wP(s,t))}else{if(!LL[h])return a?t:{};s=_L(t,h,u)}}o||(o=new LR);var p=o.get(t);if(p)return p;o.set(t,s),DL(t)?t.forEach((function(i){s.add(e(i,n,r,i,t,o))})):TL(t)&&t.forEach((function(i,a){s.set(a,e(i,n,r,a,t,o))}));var v=f?void 0:(l?c?KP:HP:c?CP:_P)(t);return jR(v||t,(function(i,a){v&&(i=t[a=i]),BR(s,a,e(i,n,r,a,t,o))})),s};var FL=function(e){return jL(e,4)};var ML=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var UL=function(e){return"symbol"==typeof e||AO(e)&&"[object Symbol]"==IO(e)};function BL(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(BL.Cache||OR),n}BL.Cache=OR;var VL=BL;var zL=function(e){var t=VL(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t},qL=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ZL=/\\(\\)?/g,WL=zL((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qL,(function(e,n,r,i){t.push(r?i.replace(ZL,"$1"):n||e)})),t})),HL=WL;var KL=function(e){if("string"==typeof e||UL(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},GL=gO?gO.prototype:void 0,QL=GL?GL.toString:void 0;var YL=function e(t){if("string"==typeof t)return t;if(QR(t))return ML(t,e)+"";if(UL(t))return QL?QL.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var $L=function(e){return null==e?"":YL(e)};var XL=function(e){return QR(e)?ML(e,KL):UL(e)?[e]:RP(HL($L(e)))};var JL=function(e,t){};var ej=function(e){return jL(e,5)};function tj(){return tj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tj.apply(this,arguments)}function nj(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function rj(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function ij(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var aj=function(e){return Array.isArray(e)&&0===e.length},oj=function(e){return"function"===typeof e},sj=function(e){return null!==e&&"object"===typeof e},uj=function(e){return String(Math.floor(Number(e)))===e},cj=function(e){return"[object String]"===Object.prototype.toString.call(e)},lj=function(e){return 0===r.Children.count(e)},fj=function(e){return sj(e)&&oj(e.then)};function hj(e,t,n,r){void 0===r&&(r=0);for(var i=XL(t);e&&r<i.length;)e=e[i[r++]];return r===i.length||e?void 0===e?n:e:n}function dj(e,t,n){for(var r=FL(e),i=r,a=0,o=XL(t);a<o.length-1;a++){var s=o[a],u=hj(e,o.slice(0,a+1));if(u&&(sj(u)||Array.isArray(u)))i=i[s]=FL(u);else{var c=o[a+1];i=i[s]=uj(c)&&Number(c)>=0?[]:{}}}return(0===a?e:i)[o[a]]===n?e:(void 0===n?delete i[o[a]]:i[o[a]]=n,0===a&&void 0===n&&delete r[o[a]],r)}function pj(e,t,n,r){void 0===n&&(n=new WeakMap),void 0===r&&(r={});for(var i=0,a=Object.keys(e);i<a.length;i++){var o=a[i],s=e[o];sj(s)?n.get(s)||(n.set(s,!0),r[o]=Array.isArray(s)?[]:{},pj(s,t,n,r[o])):r[o]=t}return r}var vj=(0,r.createContext)(void 0);vj.displayName="FormikContext";vj.Provider,vj.Consumer;function yj(){var e=(0,r.useContext)(vj);return e||JL(!1),e}function mj(e,t){switch(t.type){case"SET_VALUES":return tj({},e,{values:t.payload});case"SET_TOUCHED":return tj({},e,{touched:t.payload});case"SET_ERRORS":return uO()(e.errors,t.payload)?e:tj({},e,{errors:t.payload});case"SET_STATUS":return tj({},e,{status:t.payload});case"SET_ISSUBMITTING":return tj({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return tj({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return tj({},e,{values:dj(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return tj({},e,{touched:dj(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return tj({},e,{errors:dj(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return tj({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return tj({},e,{touched:pj(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return tj({},e,{isSubmitting:!1});default:return e}}var gj={},kj={};function bj(e){var t=e.validateOnChange,n=void 0===t||t,i=e.validateOnBlur,a=void 0===i||i,o=e.validateOnMount,s=void 0!==o&&o,u=e.isInitialValid,c=e.enableReinitialize,l=void 0!==c&&c,f=e.onSubmit,h=rj(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),d=tj({validateOnChange:n,validateOnBlur:a,validateOnMount:s,onSubmit:f},h),p=(0,r.useRef)(d.initialValues),v=(0,r.useRef)(d.initialErrors||gj),y=(0,r.useRef)(d.initialTouched||kj),m=(0,r.useRef)(d.initialStatus),g=(0,r.useRef)(!1),k=(0,r.useRef)({});(0,r.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]);var b=(0,r.useReducer)(mj,{values:d.initialValues,errors:d.initialErrors||gj,touched:d.initialTouched||kj,status:d.initialStatus,isSubmitting:!1,isValidating:!1,submitCount:0}),_=b[0],w=b[1],x=(0,r.useCallback)((function(e,t){return new Promise((function(n,r){var i=d.validate(e,t);null==i?n(gj):fj(i)?i.then((function(e){n(e||gj)}),(function(e){r(e)})):n(i)}))}),[d.validate]),S=(0,r.useCallback)((function(e,t){var n=d.validationSchema,r=oj(n)?n(t):n,i=t&&r.validateAt?r.validateAt(t,e):function(e,t,n,r){void 0===n&&(n=!1);var i=_j(e);return t[n?"validateSync":"validate"](i,{abortEarly:!1,context:r||i})}(e,r);return new Promise((function(e,t){i.then((function(){e(gj)}),(function(n){"ValidationError"===n.name?e(function(e){var t={};if(e.inner){if(0===e.inner.length)return dj(t,e.path,e.message);var n=e.inner,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var a;if(r){if(i>=n.length)break;a=n[i++]}else{if((i=n.next()).done)break;a=i.value}var o=a;hj(t,o.path)||(t=dj(t,o.path,o.message))}}return t}(n)):t(n)}))}))}),[d.validationSchema]),E=(0,r.useCallback)((function(e,t){return new Promise((function(n){return n(k.current[e].validate(t))}))}),[]),C=(0,r.useCallback)((function(e){var t=Object.keys(k.current).filter((function(e){return oj(k.current[e].validate)})),n=t.length>0?t.map((function(t){return E(t,hj(e,t))})):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(n).then((function(e){return e.reduce((function(e,n,r){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===n||n&&(e=dj(e,t[r],n)),e}),{})}))}),[E]),I=(0,r.useCallback)((function(e){return Promise.all([C(e),d.validationSchema?S(e):{},d.validate?x(e):{}]).then((function(e){var t=e[0],n=e[1],r=e[2];return pO.all([t,n,r],{arrayMerge:wj})}))}),[d.validate,d.validationSchema,C,x,S]),T=Sj((function(e){return void 0===e&&(e=_.values),w({type:"SET_ISVALIDATING",payload:!0}),I(e).then((function(e){return g.current&&(w({type:"SET_ISVALIDATING",payload:!1}),w({type:"SET_ERRORS",payload:e})),e}))}));(0,r.useEffect)((function(){s&&!0===g.current&&uO()(p.current,d.initialValues)&&T(p.current)}),[s,T]);var N=(0,r.useCallback)((function(e){var t=e&&e.values?e.values:p.current,n=e&&e.errors?e.errors:v.current?v.current:d.initialErrors||{},r=e&&e.touched?e.touched:y.current?y.current:d.initialTouched||{},i=e&&e.status?e.status:m.current?m.current:d.initialStatus;p.current=t,v.current=n,y.current=r,m.current=i;var a=function(){w({type:"RESET_FORM",payload:{isSubmitting:!!e&&!!e.isSubmitting,errors:n,touched:r,status:i,values:t,isValidating:!!e&&!!e.isValidating,submitCount:e&&e.submitCount&&"number"===typeof e.submitCount?e.submitCount:0}})};if(d.onReset){var o=d.onReset(_.values,G);fj(o)?o.then(a):a()}else a()}),[d.initialErrors,d.initialStatus,d.initialTouched]);(0,r.useEffect)((function(){!0!==g.current||uO()(p.current,d.initialValues)||l&&(p.current=d.initialValues,N(),s&&T(p.current))}),[l,d.initialValues,N,s,T]),(0,r.useEffect)((function(){l&&!0===g.current&&!uO()(v.current,d.initialErrors)&&(v.current=d.initialErrors||gj,w({type:"SET_ERRORS",payload:d.initialErrors||gj}))}),[l,d.initialErrors]),(0,r.useEffect)((function(){l&&!0===g.current&&!uO()(y.current,d.initialTouched)&&(y.current=d.initialTouched||kj,w({type:"SET_TOUCHED",payload:d.initialTouched||kj}))}),[l,d.initialTouched]),(0,r.useEffect)((function(){l&&!0===g.current&&!uO()(m.current,d.initialStatus)&&(m.current=d.initialStatus,w({type:"SET_STATUS",payload:d.initialStatus}))}),[l,d.initialStatus,d.initialTouched]);var A=Sj((function(e){if(k.current[e]&&oj(k.current[e].validate)){var t=hj(_.values,e),n=k.current[e].validate(t);return fj(n)?(w({type:"SET_ISVALIDATING",payload:!0}),n.then((function(e){return e})).then((function(t){w({type:"SET_FIELD_ERROR",payload:{field:e,value:t}}),w({type:"SET_ISVALIDATING",payload:!1})}))):(w({type:"SET_FIELD_ERROR",payload:{field:e,value:n}}),Promise.resolve(n))}return d.validationSchema?(w({type:"SET_ISVALIDATING",payload:!0}),S(_.values,e).then((function(e){return e})).then((function(t){w({type:"SET_FIELD_ERROR",payload:{field:e,value:hj(t,e)}}),w({type:"SET_ISVALIDATING",payload:!1})}))):Promise.resolve()})),D=(0,r.useCallback)((function(e,t){var n=t.validate;k.current[e]={validate:n}}),[]),O=(0,r.useCallback)((function(e){delete k.current[e]}),[]),R=Sj((function(e,t){return w({type:"SET_TOUCHED",payload:e}),(void 0===t?a:t)?T(_.values):Promise.resolve()})),P=(0,r.useCallback)((function(e){w({type:"SET_ERRORS",payload:e})}),[]),L=Sj((function(e,t){var r=oj(e)?e(_.values):e;return w({type:"SET_VALUES",payload:r}),(void 0===t?n:t)?T(r):Promise.resolve()})),j=(0,r.useCallback)((function(e,t){w({type:"SET_FIELD_ERROR",payload:{field:e,value:t}})}),[]),F=Sj((function(e,t,r){return w({type:"SET_FIELD_VALUE",payload:{field:e,value:t}}),(void 0===r?n:r)?T(dj(_.values,e,t)):Promise.resolve()})),M=(0,r.useCallback)((function(e,t){var n,r=t,i=e;if(!cj(e)){e.persist&&e.persist();var a=e.target?e.target:e.currentTarget,o=a.type,s=a.name,u=a.id,c=a.value,l=a.checked,f=(a.outerHTML,a.options),h=a.multiple;r=t||(s||u),i=/number|range/.test(o)?(n=parseFloat(c),isNaN(n)?"":n):/checkbox/.test(o)?function(e,t,n){if("boolean"===typeof e)return Boolean(t);var r=[],i=!1,a=-1;if(Array.isArray(e))r=e,i=(a=e.indexOf(n))>=0;else if(!n||"true"==n||"false"==n)return Boolean(t);if(t&&n&&!i)return r.concat(n);if(!i)return r;return r.slice(0,a).concat(r.slice(a+1))}(hj(_.values,r),l,c):f&&h?function(e){return Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value}))}(f):c}r&&F(r,i)}),[F,_.values]),U=Sj((function(e){if(cj(e))return function(t){return M(t,e)};M(e)})),B=Sj((function(e,t,n){return void 0===t&&(t=!0),w({type:"SET_FIELD_TOUCHED",payload:{field:e,value:t}}),(void 0===n?a:n)?T(_.values):Promise.resolve()})),V=(0,r.useCallback)((function(e,t){e.persist&&e.persist();var n=e.target,r=n.name,i=n.id,a=(n.outerHTML,t||(r||i));B(a,!0)}),[B]),z=Sj((function(e){if(cj(e))return function(t){return V(t,e)};V(e)})),q=(0,r.useCallback)((function(e){oj(e)?w({type:"SET_FORMIK_STATE",payload:e}):w({type:"SET_FORMIK_STATE",payload:function(){return e}})}),[]),Z=(0,r.useCallback)((function(e){w({type:"SET_STATUS",payload:e})}),[]),W=(0,r.useCallback)((function(e){w({type:"SET_ISSUBMITTING",payload:e})}),[]),H=Sj((function(){return w({type:"SUBMIT_ATTEMPT"}),T().then((function(e){var t=e instanceof Error;if(!t&&0===Object.keys(e).length){var n;try{if(void 0===(n=Q()))return}catch(Qa){throw Qa}return Promise.resolve(n).then((function(e){return g.current&&w({type:"SUBMIT_SUCCESS"}),e})).catch((function(e){if(g.current)throw w({type:"SUBMIT_FAILURE"}),e}))}if(g.current&&(w({type:"SUBMIT_FAILURE"}),t))throw e}))})),K=Sj((function(e){e&&e.preventDefault&&oj(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&oj(e.stopPropagation)&&e.stopPropagation(),H().catch((function(e){console.warn("Warning: An unhandled error was caught from submitForm()",e)}))})),G={resetForm:N,validateForm:T,validateField:A,setErrors:P,setFieldError:j,setFieldTouched:B,setFieldValue:F,setStatus:Z,setSubmitting:W,setTouched:R,setValues:L,setFormikState:q,submitForm:H},Q=Sj((function(){return f(_.values,G)})),Y=Sj((function(e){e&&e.preventDefault&&oj(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&oj(e.stopPropagation)&&e.stopPropagation(),N()})),$=(0,r.useCallback)((function(e){return{value:hj(_.values,e),error:hj(_.errors,e),touched:!!hj(_.touched,e),initialValue:hj(p.current,e),initialTouched:!!hj(y.current,e),initialError:hj(v.current,e)}}),[_.errors,_.touched,_.values]),X=(0,r.useCallback)((function(e){return{setValue:function(t,n){return F(e,t,n)},setTouched:function(t,n){return B(e,t,n)},setError:function(t){return j(e,t)}}}),[F,B,j]),J=(0,r.useCallback)((function(e){var t=sj(e),n=t?e.name:e,r=hj(_.values,n),i={name:n,value:r,onChange:U,onBlur:z};if(t){var a=e.type,o=e.value,s=e.as,u=e.multiple;"checkbox"===a?void 0===o?i.checked=!!r:(i.checked=!(!Array.isArray(r)||!~r.indexOf(o)),i.value=o):"radio"===a?(i.checked=r===o,i.value=o):"select"===s&&u&&(i.value=i.value||[],i.multiple=!0)}return i}),[z,U,_.values]),ee=(0,r.useMemo)((function(){return!uO()(p.current,_.values)}),[p.current,_.values]),te=(0,r.useMemo)((function(){return"undefined"!==typeof u?ee?_.errors&&0===Object.keys(_.errors).length:!1!==u&&oj(u)?u(d):u:_.errors&&0===Object.keys(_.errors).length}),[u,ee,_.errors,d]);return tj({},_,{initialValues:p.current,initialErrors:v.current,initialTouched:y.current,initialStatus:m.current,handleBlur:z,handleChange:U,handleReset:Y,handleSubmit:K,resetForm:N,setErrors:P,setFormikState:q,setFieldTouched:B,setFieldValue:F,setFieldError:j,setStatus:Z,setSubmitting:W,setTouched:R,setValues:L,submitForm:H,validateForm:T,validateField:A,isValid:te,dirty:ee,unregisterField:O,registerField:D,getFieldProps:J,getFieldMeta:$,getFieldHelpers:X,validateOnBlur:a,validateOnChange:n,validateOnMount:s})}function _j(e){var t=Array.isArray(e)?[]:{};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=String(n);!0===Array.isArray(e[r])?t[r]=e[r].map((function(e){return!0===Array.isArray(e)||jO(e)?_j(e):""!==e?e:void 0})):jO(e[r])?t[r]=_j(e[r]):t[r]=""!==e[r]?e[r]:void 0}return t}function wj(e,t,n){var r=e.slice();return t.forEach((function(t,i){if("undefined"===typeof r[i]){var a=!1!==n.clone&&n.isMergeableObject(t);r[i]=a?pO(Array.isArray(t)?[]:{},t,n):t}else n.isMergeableObject(t)?r[i]=pO(e[i],t,n):-1===e.indexOf(t)&&r.push(t)})),r}var xj="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;function Sj(e){var t=(0,r.useRef)(e);return xj((function(){t.current=e})),(0,r.useCallback)((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.current.apply(void 0,n)}),[])}(0,r.forwardRef)((function(e,t){var n=e.action,i=rj(e,["action"]),a=null!=n?n:"#",o=yj(),s=o.handleReset,u=o.handleSubmit;return(0,r.createElement)("form",Object.assign({onSubmit:u,ref:t,onReset:s,action:a},i))})).displayName="Form";var Ej=function(e,t,n){var r=Cj(e);return r.splice(t,0,n),r},Cj=function(e){if(e){if(Array.isArray(e))return[].concat(e);var t=Object.keys(e).map((function(e){return parseInt(e)})).reduce((function(e,t){return t>e?t:e}),0);return Array.from(tj({},e,{length:t+1}))}return[]},Ij=function(e,t){var n="function"===typeof e?e:t;return function(e){if(Array.isArray(e)||sj(e)){var t=Cj(e);return n(t)}return e}},Tj=function(e){function t(t){var n;return(n=e.call(this,t)||this).updateArrayField=function(e,t,r){var i=n.props,a=i.name;(0,i.formik.setFormikState)((function(n){var i=Ij(r,e),o=Ij(t,e),s=dj(n.values,a,e(hj(n.values,a))),u=r?i(hj(n.errors,a)):void 0,c=t?o(hj(n.touched,a)):void 0;return aj(u)&&(u=void 0),aj(c)&&(c=void 0),tj({},n,{values:s,errors:r?dj(n.errors,a,u):n.errors,touched:t?dj(n.touched,a,c):n.touched})}))},n.push=function(e){return n.updateArrayField((function(t){return[].concat(Cj(t),[ej(e)])}),!1,!1)},n.handlePush=function(e){return function(){return n.push(e)}},n.swap=function(e,t){return n.updateArrayField((function(n){return function(e,t,n){var r=Cj(e),i=r[t];return r[t]=r[n],r[n]=i,r}(n,e,t)}),!0,!0)},n.handleSwap=function(e,t){return function(){return n.swap(e,t)}},n.move=function(e,t){return n.updateArrayField((function(n){return function(e,t,n){var r=Cj(e),i=r[t];return r.splice(t,1),r.splice(n,0,i),r}(n,e,t)}),!0,!0)},n.handleMove=function(e,t){return function(){return n.move(e,t)}},n.insert=function(e,t){return n.updateArrayField((function(n){return Ej(n,e,t)}),(function(t){return Ej(t,e,null)}),(function(t){return Ej(t,e,null)}))},n.handleInsert=function(e,t){return function(){return n.insert(e,t)}},n.replace=function(e,t){return n.updateArrayField((function(n){return function(e,t,n){var r=Cj(e);return r[t]=n,r}(n,e,t)}),!1,!1)},n.handleReplace=function(e,t){return function(){return n.replace(e,t)}},n.unshift=function(e){var t=-1;return n.updateArrayField((function(n){var r=n?[e].concat(n):[e];return t<0&&(t=r.length),r}),(function(e){var n=e?[null].concat(e):[null];return t<0&&(t=n.length),n}),(function(e){var n=e?[null].concat(e):[null];return t<0&&(t=n.length),n})),t},n.handleUnshift=function(e){return function(){return n.unshift(e)}},n.handleRemove=function(e){return function(){return n.remove(e)}},n.handlePop=function(){return function(){return n.pop()}},n.remove=n.remove.bind(ij(n)),n.pop=n.pop.bind(ij(n)),n}nj(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.validateOnChange&&this.props.formik.validateOnChange&&!uO()(hj(e.formik.values,e.name),hj(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},n.remove=function(e){var t;return this.updateArrayField((function(n){var r=n?Cj(n):[];return t||(t=r[e]),oj(r.splice)&&r.splice(e,1),oj(r.every)&&r.every((function(e){return void 0===e}))?[]:r}),!0,!0),t},n.pop=function(){var e;return this.updateArrayField((function(t){var n=t.slice();return e||(e=n&&n.pop&&n.pop()),n}),!0,!0),e},n.render=function(){var e={push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},t=this.props,n=t.component,i=t.render,a=t.children,o=t.name,s=tj({},e,{form:rj(t.formik,["validate","validationSchema"]),name:o});return n?(0,r.createElement)(n,s):i?i(s):a?"function"===typeof a?a(s):lj(a)?null:r.Children.only(a):null},t}(r.Component);Tj.defaultProps={validateOnChange:!0};var Nj=n(758),Aj=n(564),Dj=n(514),Oj=n.n(Dj),Rj=Object.prototype.toString,Pj=Error.prototype.toString,Lj=RegExp.prototype.toString,jj="undefined"!==typeof Symbol?Symbol.prototype.toString:function(){return""},Fj=/^Symbol\((.*)\)(.*)$/;function Mj(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e||!0===e||!1===e)return""+e;var n=typeof e;if("number"===n)return function(e){return e!=+e?"NaN":0===e&&1/e<0?"-0":""+e}(e);if("string"===n)return t?'"'.concat(e,'"'):e;if("function"===n)return"[Function "+(e.name||"anonymous")+"]";if("symbol"===n)return jj.call(e).replace(Fj,"Symbol($1)");var r=Rj.call(e).slice(8,-1);return"Date"===r?isNaN(e.getTime())?""+e:e.toISOString(e):"Error"===r||e instanceof Error?"["+Pj.call(e)+"]":"RegExp"===r?Lj.call(e):null}function Uj(e,t){var n=Mj(e,t);return null!==n?n:JSON.stringify(e,(function(e,n){var r=Mj(this[e],t);return null!==r?r:n}),2)}function Bj(e){return null==e?[]:[].concat(e)}var Vj=/\$\{\s*(\w+)\s*\}/g,zj=function(e){mt(n,e);var t=wt(n);function n(e,r,i,a){var o;return ht(this,n),(o=t.call(this)).value=void 0,o.path=void 0,o.type=void 0,o.errors=void 0,o.params=void 0,o.inner=void 0,o.name="ValidationError",o.value=r,o.path=i,o.type=a,o.errors=[],o.inner=[],Bj(e).forEach((function(e){var t;n.isError(e)?((t=o.errors).push.apply(t,ft(e.errors)),o.inner=o.inner.concat(e.inner.length?e.inner:e)):o.errors.push(e)})),o.message=o.errors.length>1?"".concat(o.errors.length," errors occurred"):o.errors[0],Error.captureStackTrace&&Error.captureStackTrace(_t(o),n),o}return vt(n,null,[{key:"formatError",value:function(e,t){var n=t.label||t.path||"this";return n!==t.path&&(t=Object.assign({},t,{path:n})),"string"===typeof e?e.replace(Vj,(function(e,n){return Uj(t[n])})):"function"===typeof e?e(t):e}},{key:"isError",value:function(e){return e&&"ValidationError"===e.name}}]),n}(St(Error)),qj={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:function(e){var t=e.path,n=e.type,r=e.value,i=e.originalValue,a=null!=i&&i!==r?" (cast from the value `".concat(Uj(i,!0),"`)."):".";return"mixed"!==n?"".concat(t," must be a `").concat(n,"` type, ")+"but the final value was: `".concat(Uj(r,!0),"`")+a:"".concat(t," must match the configured type. ")+"The validated value was: `".concat(Uj(r,!0),"`")+a}},Zj={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Wj={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Hj={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},Kj={isValue:"${path} field must be ${value}"},Gj={noUnknown:"${path} field has unspecified keys: ${unknown}"},Qj={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},Yj=function(e){var t=e.path,n=e.value,r=e.spec.types.length;if(Array.isArray(n)){if(n.length<r)return"".concat(t," tuple value has too few items, expected a length of ").concat(r," but got ").concat(n.length," for value: `").concat(Uj(n,!0),"`");if(n.length>r)return"".concat(t," tuple value has too many items, expected a length of ").concat(r," but got ").concat(n.length," for value: `").concat(Uj(n,!0),"`")}return zj.formatError(qj.notType,e)},$j=(Object.assign(Object.create(null),{mixed:qj,string:Zj,number:Wj,date:Hj,object:Gj,array:Qj,boolean:Kj}),function(e){return e&&e.__isYupSchema__}),Xj=function(){function e(t,n){ht(this,e),this.fn=void 0,this.refs=t,this.refs=t,this.fn=n}return vt(e,[{key:"resolve",value:function(e,t){var n=this.refs.map((function(e){return e.getValue(null==t?void 0:t.value,null==t?void 0:t.parent,null==t?void 0:t.context)})),r=this.fn(n,e,t);if(void 0===r||r===e)return e;if(!$j(r))throw new TypeError("conditions must return a schema object");return r.resolve(t)}}],[{key:"fromOptions",value:function(t,n){if(!n.then&&!n.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");var r=n.is,i=n.then,a=n.otherwise,o="function"===typeof r?r:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return e===r}))};return new e(t,(function(e,t){var n,r=o.apply(void 0,ft(e))?i:a;return null!=(n=null==r?void 0:r(t))?n:t}))}}]),e}(),Jj="$",eF=".";var tF=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ht(this,e),this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,"string"!==typeof t)throw new TypeError("ref must be a string, got: "+t);if(this.key=t.trim(),""===t)throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Jj,this.isValue=this.key[0]===eF,this.isSibling=!this.isContext&&!this.isValue;var r=this.isContext?Jj:this.isValue?eF:"";this.path=this.key.slice(r.length),this.getter=this.path&&(0,Nj.getter)(this.path,!0),this.map=n.map}return vt(e,[{key:"getValue",value:function(e,t,n){var r=this.isContext?n:this.isValue?e:t;return this.getter&&(r=this.getter(r||{})),this.map&&(r=this.map(r)),r}},{key:"cast",value:function(e,t){return this.getValue(e,null==t?void 0:t.parent,null==t?void 0:t.context)}},{key:"resolve",value:function(){return this}},{key:"describe",value:function(){return{type:"ref",key:this.key}}},{key:"toString",value:function(){return"Ref(".concat(this.key,")")}}],[{key:"isRef",value:function(e){return e&&e.__isYupRef}}]),e}();tF.prototype.__isYupRef=!0;var nF=function(e){return null==e};function rF(e){function t(t,n,r){var i=t.value,a=t.path,o=void 0===a?"":a,s=t.options,u=t.originalValue,c=t.schema,l=e.name,f=e.test,h=e.params,d=e.message,p=e.skipAbsent,v=s.parent,y=s.context,m=s.abortEarly;function g(e){return tF.isRef(e)?e.getValue(i,v,y):e}function k(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({value:i,originalValue:u,label:c.spec.label,path:e.path||o,spec:c.spec},h,e.params),n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];t[a]=g(t[a])}var s=new zj(zj.formatError(e.message||d,t),i,t.path,e.type||l);return s.params=t,s}var b=(void 0===m?c.spec.abortEarly:m)?n:r,_={path:o,parent:v,type:l,from:s.from,createError:k,resolve:g,options:s,originalValue:u,schema:c},w=function(e){zj.isError(e)?b(e):e?r(null):b(k())},x=function(e){zj.isError(e)?b(e):n(e)},S=p&&nF(i);if(s.sync){var E;try{var C;if("function"===typeof(null==(C=E=!!S||f.call(_,i,_))?void 0:C.then))throw new Error('Validation test of type: "'.concat(_.type,'" returned a Promise during a synchronous validate. ')+"This test will finish after the validate call has returned")}catch(I){return void x(I)}w(E)}else try{Promise.resolve(!!S||f.call(_,i,_)).then(w,x)}catch(I){x(I)}}return t.OPTIONS=e,t}function iF(e,t,n){var r,i,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return t?((0,Nj.forEach)(t,(function(s,u,c){var l=u?s.slice(1,s.length-1):s,f="tuple"===(e=e.resolve({context:o,parent:r,value:n})).type,h=c?parseInt(l,10):0;if(e.innerType||f){if(f&&!c)throw new Error('Yup.reach cannot implicitly index into a tuple type. the path part "'.concat(a,'" must contain an index to the tuple element, e.g. "').concat(a,'[0]"'));if(n&&h>=n.length)throw new Error("Yup.reach cannot resolve an array item at index: ".concat(s,", in the path: ").concat(t,". ")+"because there is no value at that index. ");r=n,n=n&&n[h],e=f?e.spec.types[h]:e.innerType}if(!c){if(!e.fields||!e.fields[l])throw new Error("The schema does not contain the path: ".concat(t,". ")+"(failed at: ".concat(a,' which is a type: "').concat(e.type,'")'));r=n,n=n&&n[l],e=e.fields[l]}i=l,a=u?"["+s+"]":"."+s})),{schema:e,parent:r,parentPath:i}):{parent:r,parentPath:t,schema:e}}var aF=function(e){mt(n,e);var t=wt(n);function n(){return ht(this,n),t.apply(this,arguments)}return vt(n,[{key:"describe",value:function(){var e,t=[],n=Tt(this.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(tF.isRef(r)?r.describe():r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"resolveAll",value:function(e){var t,n=[],r=Tt(this.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(e(i))}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"clone",value:function(){return new n(this.values())}},{key:"merge",value:function(e,t){var n=this.clone();return e.forEach((function(e){return n.add(e)})),t.forEach((function(e){return n.delete(e)})),n}}]),n}(St(Set));function oF(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if($j(e)||!e||"object"!==typeof e)return e;if(n.has(e))return n.get(e);if(e instanceof Date)t=new Date(e.getTime()),n.set(e,t);else if(e instanceof RegExp)t=new RegExp(e),n.set(e,t);else if(Array.isArray(e)){t=new Array(e.length),n.set(e,t);for(var r=0;r<e.length;r++)t[r]=oF(e[r],n)}else if(e instanceof Map){t=new Map,n.set(e,t);var i,a=Tt(e.entries());try{for(a.s();!(i=a.n()).done;){var o=(0,u.Z)(i.value,2),s=o[0],c=o[1];t.set(s,oF(c,n))}}catch(g){a.e(g)}finally{a.f()}}else if(e instanceof Set){t=new Set,n.set(e,t);var l,f=Tt(e);try{for(f.s();!(l=f.n()).done;){var h=l.value;t.add(oF(h,n))}}catch(g){f.e(g)}finally{f.f()}}else{if(!(e instanceof Object))throw Error("Unable to clone ".concat(e));t={},n.set(e,t);for(var d=0,p=Object.entries(e);d<p.length;d++){var v=(0,u.Z)(p[d],2),y=v[0],m=v[1];t[y]=oF(m,n)}}return t}var sF=function(){function e(t){var n=this;ht(this,e),this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new aF,this._blacklist=new aF,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation((function(){n.typeError(qj.notType)})),this.type=t.type,this._typeCheck=t.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,nullable:!1,optional:!0,coerce:!0},null==t?void 0:t.spec),this.withMutation((function(e){e.nonNullable()}))}return vt(e,[{key:"_type",get:function(){return this.type}},{key:"clone",value:function(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;var t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=ft(this.deps),t.conditions=ft(this.conditions),t.tests=ft(this.tests),t.transforms=ft(this.transforms),t.spec=oF(Object.assign({},this.spec,e)),t}},{key:"label",value:function(e){var t=this.clone();return t.spec.label=e,t}},{key:"meta",value:function(){if(0===arguments.length)return this.spec.meta;var e=this.clone();return e.spec.meta=Object.assign(e.spec.meta||{},arguments.length<=0?void 0:arguments[0]),e}},{key:"withMutation",value:function(e){var t=this._mutate;this._mutate=!0;var n=e(this);return this._mutate=t,n}},{key:"concat",value:function(e){if(!e||e===this)return this;if(e.type!==this.type&&"mixed"!==this.type)throw new TypeError("You cannot `concat()` schema's of different types: ".concat(this.type," and ").concat(e.type));var t=this,n=e.clone(),r=Object.assign({},t.spec,n.spec);return n.spec=r,n.internalTests=Object.assign({},t.internalTests,n.internalTests),n._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),n._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),n.tests=t.tests,n.exclusiveTests=t.exclusiveTests,n.withMutation((function(t){e.tests.forEach((function(e){t.test(e.OPTIONS)}))})),n.transforms=[].concat(ft(t.transforms),ft(n.transforms)),n}},{key:"isType",value:function(e){return null==e?!(!this.spec.nullable||null!==e)||!(!this.spec.optional||void 0!==e):this._typeCheck(e)}},{key:"resolve",value:function(e){var t=this;if(t.conditions.length){var n=t.conditions;(t=t.clone()).conditions=[],t=(t=n.reduce((function(t,n){return n.resolve(t,e)}),t)).resolve(e)}return t}},{key:"resolveOptions",value:function(e){var t,n,r;return Object.assign({},e,{from:e.from||[],strict:null!=(t=e.strict)?t:this.spec.strict,abortEarly:null!=(n=e.abortEarly)?n:this.spec.abortEarly,recursive:null!=(r=e.recursive)?r:this.spec.recursive})}},{key:"cast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.resolve(Object.assign({value:e},t)),r="ignore-optionality"===t.assert,i=n._cast(e,t);if(!1!==t.assert&&!n.isType(i)){if(r&&nF(i))return i;var a=Uj(e),o=Uj(i);throw new TypeError("The value of ".concat(t.path||"field"," could not be cast to a value ")+'that satisfies the schema type: "'.concat(n.type,'". \n\n')+"attempted value: ".concat(a," \n")+(o!==a?"result of cast: ".concat(o):""))}return i}},{key:"_cast",value:function(e,t){var n=this,r=void 0===e?e:this.transforms.reduce((function(t,r){return r.call(n,t,e,n)}),e);return void 0===r&&(r=this.getDefault(t)),r}},{key:"_validate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=n.path,o=n.originalValue,s=void 0===o?e:o,u=n.strict,c=void 0===u?this.spec.strict:u,l=e;c||(l=this._cast(l,Object.assign({assert:!1},n)));for(var f=[],h=0,d=Object.values(this.internalTests);h<d.length;h++){var p=d[h];p&&f.push(p)}this.runTests({path:a,value:l,originalValue:s,options:n,tests:f},r,(function(e){if(e.length)return i(e,l);t.runTests({path:a,value:l,originalValue:s,options:n,tests:t.tests},r,i)}))}},{key:"runTests",value:function(e,t,n){var r=!1,i=e.tests,a=e.value,o=e.originalValue,s=e.path,u=e.options,c=function(e){r||(r=!0,t(e,a))},l=function(e){r||(r=!0,n(e,a))},f=i.length,h=[];if(!f)return l([]);for(var d={value:a,originalValue:o,path:s,options:u,schema:this},p=0;p<i.length;p++){(0,i[p])(d,c,(function(e){e&&(h=h.concat(e)),--f<=0&&l(h)}))}}},{key:"asNestedTest",value:function(e){var t,n=this,r=e.key,i=e.index,a=e.parent,o=e.parentPath,s=e.originalParent,u=e.options,c=null!=r?r:i;if(null==c)throw TypeError("Must include `key` or `index` for nested validations");var l="number"===typeof c,f=a[c],h=Object.assign({},u,(t={strict:!0,parent:a,value:f,originalValue:s[c],key:void 0},(0,hr.Z)(t,l?"index":"key",c),(0,hr.Z)(t,"path",l||c.includes(".")?"".concat(o||"","[").concat(f?c:'"'.concat(c,'"'),"]"):(o?"".concat(o,"."):"")+r),t));return function(e,t,r){return n.resolve(h)._validate(f,h,t,r)}}},{key:"validate",value:function(e,t){var n=this.resolve(Object.assign({},t,{value:e}));return new Promise((function(r,i){return n._validate(e,t,(function(e,t){zj.isError(e)&&(e.value=t),i(e)}),(function(e,t){e.length?i(new zj(e,t)):r(t)}))}))}},{key:"validateSync",value:function(e,t){var n;return this.resolve(Object.assign({},t,{value:e}))._validate(e,Object.assign({},t,{sync:!0}),(function(e,t){throw zj.isError(e)&&(e.value=t),e}),(function(t,r){if(t.length)throw new zj(t,e);n=r})),n}},{key:"isValid",value:function(e,t){return this.validate(e,t).then((function(){return!0}),(function(e){if(zj.isError(e))return!1;throw e}))}},{key:"isValidSync",value:function(e,t){try{return this.validateSync(e,t),!0}catch(n){if(zj.isError(n))return!1;throw n}}},{key:"_getDefault",value:function(e){var t=this.spec.default;return null==t?t:"function"===typeof t?t.call(this,e):oF(t)}},{key:"getDefault",value:function(e){return this.resolve(e||{})._getDefault(e)}},{key:"default",value:function(e){return 0===arguments.length?this._getDefault():this.clone({default:e})}},{key:"strict",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.clone({strict:e})}},{key:"nullability",value:function(e,t){var n=this.clone({nullable:e});return n.internalTests.nullable=rF({message:t,name:"nullable",test:function(e){return null!==e||this.schema.spec.nullable}}),n}},{key:"optionality",value:function(e,t){var n=this.clone({optional:e});return n.internalTests.optionality=rF({message:t,name:"optionality",test:function(e){return void 0!==e||this.schema.spec.optional}}),n}},{key:"optional",value:function(){return this.optionality(!0)}},{key:"defined",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qj.defined;return this.optionality(!1,e)}},{key:"nullable",value:function(){return this.nullability(!0)}},{key:"nonNullable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qj.notNull;return this.nullability(!1,e)}},{key:"required",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qj.required;return this.clone().withMutation((function(t){return t.nonNullable(e).defined(e)}))}},{key:"notRequired",value:function(){return this.clone().withMutation((function(e){return e.nullable().optional()}))}},{key:"transform",value:function(e){var t=this.clone();return t.transforms.push(e),t}},{key:"test",value:function(){var e;if(void 0===(e=1===arguments.length?"function"===typeof(arguments.length<=0?void 0:arguments[0])?{test:arguments.length<=0?void 0:arguments[0]}:arguments.length<=0?void 0:arguments[0]:2===arguments.length?{name:arguments.length<=0?void 0:arguments[0],test:arguments.length<=1?void 0:arguments[1]}:{name:arguments.length<=0?void 0:arguments[0],message:arguments.length<=1?void 0:arguments[1],test:arguments.length<=2?void 0:arguments[2]}).message&&(e.message=qj.default),"function"!==typeof e.test)throw new TypeError("`test` is a required parameters");var t=this.clone(),n=rF(e),r=e.exclusive||e.name&&!0===t.exclusiveTests[e.name];if(e.exclusive&&!e.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return e.name&&(t.exclusiveTests[e.name]=!!e.exclusive),t.tests=t.tests.filter((function(t){if(t.OPTIONS.name===e.name){if(r)return!1;if(t.OPTIONS.test===n.OPTIONS.test)return!1}return!0})),t.tests.push(n),t}},{key:"when",value:function(e,t){Array.isArray(e)||"string"===typeof e||(t=e,e=".");var n=this.clone(),r=Bj(e).map((function(e){return new tF(e)}));return r.forEach((function(e){e.isSibling&&n.deps.push(e.key)})),n.conditions.push("function"===typeof t?new Xj(r,t):Xj.fromOptions(r,t)),n}},{key:"typeError",value:function(e){var t=this.clone();return t.internalTests.typeError=rF({message:e,name:"typeError",skipAbsent:!0,test:function(e){return!!this.schema._typeCheck(e)||this.createError({params:{type:this.schema.type}})}}),t}},{key:"oneOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qj.oneOf,n=this.clone();return e.forEach((function(e){n._whitelist.add(e),n._blacklist.delete(e)})),n.internalTests.whiteList=rF({message:t,name:"oneOf",skipAbsent:!0,test:function(e){var t=this.schema._whitelist,n=t.resolveAll(this.resolve);return!!n.includes(e)||this.createError({params:{values:Array.from(t).join(", "),resolved:n}})}}),n}},{key:"notOneOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qj.notOneOf,n=this.clone();return e.forEach((function(e){n._blacklist.add(e),n._whitelist.delete(e)})),n.internalTests.blacklist=rF({message:t,name:"notOneOf",test:function(e){var t=this.schema._blacklist,n=t.resolveAll(this.resolve);return!n.includes(e)||this.createError({params:{values:Array.from(t).join(", "),resolved:n}})}}),n}},{key:"strip",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.clone();return t.spec.strip=e,t}},{key:"describe",value:function(e){var t=(e?this.resolve(e):this).clone(),n=t.spec,r=n.label,i={meta:n.meta,label:r,optional:n.optional,nullable:n.nullable,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map((function(e){return{name:e.OPTIONS.name,params:e.OPTIONS.params}})).filter((function(e,t,n){return n.findIndex((function(t){return t.name===e.name}))===t}))};return i}}]),e}();sF.prototype.__isYupSchema__=!0;for(var uF=function(){var e=lF[cF];sF.prototype["".concat(e,"At")]=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=iF(this,t,n,r.context),a=i.parent,o=i.parentPath;return i.schema[e](a&&a[o],Object.assign({},r,{parent:a,path:t}))}},cF=0,lF=["validate","validateSync"];cF<lF.length;cF++)uF();for(var fF=0,hF=["equals","is"];fF<hF.length;fF++){var dF=hF[fF];sF.prototype[dF]=sF.prototype.oneOf}for(var pF=0,vF=["not","nope"];pF<vF.length;pF++){var yF=vF[pF];sF.prototype[yF]=sF.prototype.notOneOf}var mF=function(){return!0};var gF=function(e){mt(n,e);var t=wt(n);function n(e){return ht(this,n),t.call(this,"function"===typeof e?{type:"mixed",check:e}:Object.assign({type:"mixed",check:mF},e))}return vt(n)}(sF);gF.prototype;var kF=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),e=t.call(this,{type:"boolean",check:function(e){return e instanceof Boolean&&(e=e.valueOf()),"boolean"===typeof e}}),e.withMutation((function(){e.transform((function(e,t,n){if(n.spec.coerce&&!n.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e}))})),e}return vt(n,[{key:"isTrue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kj.isValue;return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test:function(e){return nF(e)||!0===e}})}},{key:"isFalse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kj.isValue;return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test:function(e){return nF(e)||!1===e}})}},{key:"default",value:function(e){return sp(gt(n.prototype),"default",this).call(this,e)}},{key:"defined",value:function(e){return sp(gt(n.prototype),"defined",this).call(this,e)}},{key:"optional",value:function(){return sp(gt(n.prototype),"optional",this).call(this)}},{key:"required",value:function(e){return sp(gt(n.prototype),"required",this).call(this,e)}},{key:"notRequired",value:function(){return sp(gt(n.prototype),"notRequired",this).call(this)}},{key:"nullable",value:function(){return sp(gt(n.prototype),"nullable",this).call(this)}},{key:"nonNullable",value:function(e){return sp(gt(n.prototype),"nonNullable",this).call(this,e)}},{key:"strip",value:function(e){return sp(gt(n.prototype),"strip",this).call(this,e)}}]),n}(sF);kF.prototype;var bF=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,_F=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,wF=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,xF=function(e){return nF(e)||e===e.trim()},SF={}.toString();function EF(){return new CF}var CF=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),e=t.call(this,{type:"string",check:function(e){return e instanceof String&&(e=e.valueOf()),"string"===typeof e}}),e.withMutation((function(){e.transform((function(e,t,n){if(!n.spec.coerce||n.isType(e))return e;if(Array.isArray(e))return e;var r=null!=e&&e.toString?e.toString():e;return r===SF?e:r}))})),e}return vt(n,[{key:"required",value:function(e){return sp(gt(n.prototype),"required",this).call(this,e).withMutation((function(t){return t.test({message:e||qj.required,name:"required",skipAbsent:!0,test:function(e){return!!e.length}})}))}},{key:"notRequired",value:function(){return sp(gt(n.prototype),"notRequired",this).call(this).withMutation((function(e){return e.tests=e.tests.filter((function(e){return"required"!==e.OPTIONS.name})),e}))}},{key:"length",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zj.length;return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test:function(t){return t.length===this.resolve(e)}})}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zj.min;return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(t){return t.length>=this.resolve(e)}})}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zj.max;return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test:function(t){return t.length<=this.resolve(e)}})}},{key:"matches",value:function(e,t){var n,r,i=!1;if(t)if("object"===typeof t){var a=t.excludeEmptyString;i=void 0!==a&&a,n=t.message,r=t.name}else n=t;return this.test({name:r||"matches",message:n||Zj.matches,params:{regex:e},skipAbsent:!0,test:function(t){return""===t&&i||-1!==t.search(e)}})}},{key:"email",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.email;return this.matches(bF,{name:"email",message:e,excludeEmptyString:!0})}},{key:"url",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.url;return this.matches(_F,{name:"url",message:e,excludeEmptyString:!0})}},{key:"uuid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.uuid;return this.matches(wF,{name:"uuid",message:e,excludeEmptyString:!1})}},{key:"ensure",value:function(){return this.default("").transform((function(e){return null===e?"":e}))}},{key:"trim",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.trim;return this.transform((function(e){return null!=e?e.trim():e})).test({message:e,name:"trim",test:xF})}},{key:"lowercase",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.lowercase;return this.transform((function(e){return nF(e)?e:e.toLowerCase()})).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(e){return nF(e)||e===e.toLowerCase()}})}},{key:"uppercase",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zj.uppercase;return this.transform((function(e){return nF(e)?e:e.toUpperCase()})).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(e){return nF(e)||e===e.toUpperCase()}})}}]),n}(sF);EF.prototype=CF.prototype;var IF=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),e=t.call(this,{type:"number",check:function(e){return e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&!function(e){return e!=+e}(e)}}),e.withMutation((function(){e.transform((function(e,t,n){if(!n.spec.coerce)return e;var r=e;if("string"===typeof r){if(""===(r=r.replace(/\s/g,"")))return NaN;r=+r}return n.isType(r)||null===r?r:parseFloat(r)}))})),e}return vt(n,[{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.min;return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(t){return t>=this.resolve(e)}})}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.max;return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(t){return t<=this.resolve(e)}})}},{key:"lessThan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.lessThan;return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test:function(t){return t<this.resolve(e)}})}},{key:"moreThan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.moreThan;return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test:function(t){return t>this.resolve(e)}})}},{key:"positive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wj.positive;return this.moreThan(0,e)}},{key:"negative",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wj.negative;return this.lessThan(0,e)}},{key:"integer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wj.integer;return this.test({name:"integer",message:e,skipAbsent:!0,test:function(e){return Number.isInteger(e)}})}},{key:"truncate",value:function(){return this.transform((function(e){return nF(e)?e:0|e}))}},{key:"round",value:function(e){var t,n=["ceil","floor","round","trunc"];if("trunc"===(e=(null==(t=e)?void 0:t.toLowerCase())||"round"))return this.truncate();if(-1===n.indexOf(e.toLowerCase()))throw new TypeError("Only valid options for round() are: "+n.join(", "));return this.transform((function(t){return nF(t)?t:Math[e](t)}))}}]),n}(sF);IF.prototype;var TF=/^(\d{4}|[+\-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;var NF=new Date("");function AF(){return new DF}var DF=function(e){mt(n,e);var t=wt(n);function n(){var e;return ht(this,n),e=t.call(this,{type:"date",check:function(e){return t=e,"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(e.getTime());var t}}),e.withMutation((function(){e.transform((function(e,t,r){return!r.spec.coerce||r.isType(e)||null===e?e:(e=function(e){var t,n,r=[1,4,5,6,7,10,11],i=0;if(n=TF.exec(e)){for(var a,o=0;a=r[o];++o)n[a]=+n[a]||0;n[2]=(+n[2]||1)-1,n[3]=+n[3]||1,n[7]=n[7]?String(n[7]).substr(0,3):0,void 0!==n[8]&&""!==n[8]||void 0!==n[9]&&""!==n[9]?("Z"!==n[8]&&void 0!==n[9]&&(i=60*n[10]+n[11],"+"===n[9]&&(i=0-i)),t=Date.UTC(n[1],n[2],n[3],n[4],n[5]+i,n[6],n[7])):t=+new Date(n[1],n[2],n[3],n[4],n[5],n[6],n[7])}else t=Date.parse?Date.parse(e):NaN;return t}(e),isNaN(e)?n.INVALID_DATE:new Date(e))}))})),e}return vt(n,[{key:"prepareParam",value:function(e,t){var n;if(tF.isRef(e))n=e;else{var r=this.cast(e);if(!this._typeCheck(r))throw new TypeError("`".concat(t,"` must be a Date or a value that can be `cast()` to a Date"));n=r}return n}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hj.min,n=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(e){return e>=this.resolve(n)}})}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hj.max,n=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(e){return e<=this.resolve(n)}})}}]),n}(sF);function OF(e,t){var n=1/0;return e.some((function(e,r){var i;if(null!=(i=t.path)&&i.includes(e))return n=r,!0})),n}function RF(e){return function(t,n){return OF(e,t)-OF(e,n)}}DF.INVALID_DATE=NF,AF.prototype=DF.prototype,AF.INVALID_DATE=NF;var PF=function(e,t,n){if("string"!==typeof e)return e;var r=e;try{r=JSON.parse(e)}catch(i){}return n.isType(r)?r:e};function LF(e){if("fields"in e){for(var t={},n=0,r=Object.entries(e.fields);n<r.length;n++){var i=(0,u.Z)(r[n],2),a=i[0],o=i[1];t[a]=LF(o)}return e.setFields(t)}if("array"===e.type){var s=e.optional();return s.innerType&&(s.innerType=LF(s.innerType)),s}return"tuple"===e.type?e.optional().clone({types:e.spec.types.map(LF)}):"optional"in e?e.optional():e}var jF=function(e){return"[object Object]"===Object.prototype.toString.call(e)};var FF=RF([]);function MF(e){return new UF(e)}var UF=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),r=t.call(this,{type:"object",check:function(e){return jF(e)||"function"===typeof e}}),r.fields=Object.create(null),r._sortErrors=FF,r._nodes=[],r._excludedEdges=[],r.withMutation((function(){e&&r.shape(e)})),r}return vt(n,[{key:"_cast",value:function(e){var t,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=sp(gt(n.prototype),"_cast",this).call(this,e,i);if(void 0===a)return this.getDefault(i);if(!this._typeCheck(a))return a;var o,s=this.fields,u=null!=(t=i.stripUnknown)?t:this.spec.noUnknown,c=[].concat(this._nodes,Object.keys(a).filter((function(e){return!r._nodes.includes(e)}))),l={},f=Object.assign({},i,{parent:l,__validating:i.__validating||!1}),h=!1,d=Tt(c);try{for(d.s();!(o=d.n()).done;){var p=o.value,v=s[p],y=p in a;if(v){var m,g=a[p];f.path=(i.path?"".concat(i.path,"."):"")+p;var k=(v=v.resolve({value:g,context:i.context,parent:l}))instanceof sF?v.spec:void 0,b=null==k?void 0:k.strict;if(null!=k&&k.strip){h=h||p in a;continue}void 0!==(m=i.__validating&&b?a[p]:v.cast(a[p],f))&&(l[p]=m)}else y&&!u&&(l[p]=a[p]);y===p in l&&l[p]===a[p]||(h=!0)}}catch(_){d.e(_)}finally{d.f()}return h?l:a}},{key:"_validate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=r.from,s=void 0===o?[]:o,u=r.originalValue,c=void 0===u?e:u,l=r.recursive,f=void 0===l?this.spec.recursive:l;r.from=[{schema:this,value:c}].concat(ft(s)),r.__validating=!0,r.originalValue=c,sp(gt(n.prototype),"_validate",this).call(this,e,r,i,(function(e,n){if(f&&jF(n)){c=c||n;var o,s=[],u=Tt(t._nodes);try{for(u.s();!(o=u.n()).done;){var l=o.value,h=t.fields[l];h&&!tF.isRef(h)&&s.push(h.asNestedTest({options:r,key:l,parent:n,parentPath:r.path,originalParent:c}))}}catch(d){u.e(d)}finally{u.f()}t.runTests({tests:s,value:n,originalValue:c,options:r},i,(function(r){a(r.sort(t._sortErrors).concat(e),n)}))}else a(e,n)}))}},{key:"clone",value:function(e){var t=sp(gt(n.prototype),"clone",this).call(this,e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}},{key:"concat",value:function(e){for(var t=this,r=sp(gt(n.prototype),"concat",this).call(this,e),i=r.fields,a=0,o=Object.entries(this.fields);a<o.length;a++){var s=(0,u.Z)(o[a],2),c=s[0],l=s[1],f=i[c];i[c]=void 0===f?l:f}return r.withMutation((function(n){return n.setFields(i,[].concat(ft(t._excludedEdges),ft(e._excludedEdges)))}))}},{key:"_getDefault",value:function(e){var t=this;if("default"in this.spec)return sp(gt(n.prototype),"_getDefault",this).call(this,e);if(this._nodes.length){var r={};return this._nodes.forEach((function(n){var i,a=t.fields[n],o=e;null!=(i=o)&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),r[n]=a&&"getDefault"in a?a.getDefault(o):void 0})),r}}},{key:"setFields",value:function(e,t){var n=this.clone();return n.fields=e,n._nodes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=new Set,i=new Set(t.map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return"".concat(n,"-").concat(r)})));function a(e,t){var a=(0,Nj.split)(e)[0];r.add(a),i.has("".concat(t,"-").concat(a))||n.push([t,a])}for(var o=function(){var t=c[s],n=e[t];r.add(t),tF.isRef(n)&&n.isSibling?a(n.path,t):$j(n)&&"deps"in n&&n.deps.forEach((function(e){return a(e,t)}))},s=0,c=Object.keys(e);s<c.length;s++)o();return Oj().array(Array.from(r),n).reverse()}(e,t),n._sortErrors=RF(Object.keys(e)),t&&(n._excludedEdges=t),n}},{key:"shape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.clone().withMutation((function(n){var r=n._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),r=[].concat(ft(n._excludedEdges),ft(t))),n.setFields(Object.assign(n.fields,e),r)}))}},{key:"partial",value:function(){for(var e={},t=0,n=Object.entries(this.fields);t<n.length;t++){var r=(0,u.Z)(n[t],2),i=r[0],a=r[1];e[i]="optional"in a&&a.optional instanceof Function?a.optional():a}return this.setFields(e)}},{key:"deepPartial",value:function(){return LF(this)}},{key:"pick",value:function(e){var t,n={},r=Tt(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.fields[i]&&(n[i]=this.fields[i])}}catch(a){r.e(a)}finally{r.f()}return this.setFields(n)}},{key:"omit",value:function(e){var t,n=Object.assign({},this.fields),r=Tt(e);try{for(r.s();!(t=r.n()).done;){delete n[t.value]}}catch(i){r.e(i)}finally{r.f()}return this.setFields(n)}},{key:"from",value:function(e,t,n){var r=(0,Nj.getter)(e,!0);return this.transform((function(i){if(!i)return i;var a=i;return function(e,t){var n=ft((0,Nj.normalizePath)(t));if(1===n.length)return n[0]in e;var r=n.pop(),i=(0,Nj.getter)((0,Nj.join)(n),!0)(e);return!(!i||!(r in i))}(i,e)&&(a=Object.assign({},i),n||delete a[e],a[t]=r(i)),a}))}},{key:"json",value:function(){return this.transform(PF)}},{key:"noUnknown",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gj.noUnknown;"boolean"!==typeof e&&(t=e,e=!0);var n=this.test({name:"noUnknown",exclusive:!0,message:t,test:function(t){if(null==t)return!0;var n=function(e,t){var n=Object.keys(e.fields);return Object.keys(t).filter((function(e){return-1===n.indexOf(e)}))}(this.schema,t);return!e||0===n.length||this.createError({params:{unknown:n.join(", ")}})}});return n.spec.noUnknown=e,n}},{key:"unknown",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gj.noUnknown;return this.noUnknown(!e,t)}},{key:"transformKeys",value:function(e){return this.transform((function(t){if(!t)return t;for(var n={},r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];n[e(a)]=t[a]}return n}))}},{key:"camelCase",value:function(){return this.transformKeys(Aj.camelCase)}},{key:"snakeCase",value:function(){return this.transformKeys(Aj.snakeCase)}},{key:"constantCase",value:function(){return this.transformKeys((function(e){return(0,Aj.snakeCase)(e).toUpperCase()}))}},{key:"describe",value:function(e){var t=sp(gt(n.prototype),"describe",this).call(this,e);t.fields={};for(var r=0,i=Object.entries(this.fields);r<i.length;r++){var a,o=(0,u.Z)(i[r],2),s=o[0],c=o[1],l=e;null!=(a=l)&&a.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[s]})),t.fields[s]=c.describe(l)}return t}}]),n}(sF);MF.prototype=UF.prototype;var BF=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),r=t.call(this,{type:"array",spec:{types:e},check:function(e){return Array.isArray(e)}}),r.innerType=void 0,r.innerType=e,r}return vt(n,[{key:"_cast",value:function(e,t){var r=this,i=sp(gt(n.prototype),"_cast",this).call(this,e,t);if(!this._typeCheck(i)||!this.innerType)return i;var a=!1,o=i.map((function(e,n){var i=r.innerType.cast(e,Object.assign({},t,{path:"".concat(t.path||"","[").concat(n,"]")}));return i!==e&&(a=!0),i}));return a?o:i}},{key:"_validate",value:function(e){var t,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=this.innerType,u=null!=(t=i.recursive)?t:this.spec.recursive;null!=i.originalValue&&i.originalValue,sp(gt(n.prototype),"_validate",this).call(this,e,i,a,(function(t,n){var c;if(u&&s&&r._typeCheck(n)){for(var l=new Array(n.length),f=0;f<n.length;f++){var h;l[f]=s.asNestedTest({options:i,index:f,parent:n,parentPath:i.path,originalParent:null!=(h=i.originalValue)?h:e})}r.runTests({value:n,tests:l,originalValue:null!=(c=i.originalValue)?c:e,options:i},a,(function(e){return o(e.concat(t),n)}))}else o(t,n)}))}},{key:"clone",value:function(e){var t=sp(gt(n.prototype),"clone",this).call(this,e);return t.innerType=this.innerType,t}},{key:"json",value:function(){return this.transform(PF)}},{key:"concat",value:function(e){var t=sp(gt(n.prototype),"concat",this).call(this,e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}},{key:"of",value:function(e){var t=this.clone();if(!$j(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+Uj(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}},{key:"length",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qj.length;return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test:function(t){return t.length===this.resolve(e)}})}},{key:"min",value:function(e,t){return t=t||Qj.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(t){return t.length>=this.resolve(e)}})}},{key:"max",value:function(e,t){return t=t||Qj.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(t){return t.length<=this.resolve(e)}})}},{key:"ensure",value:function(){var e=this;return this.default((function(){return[]})).transform((function(t,n){return e._typeCheck(t)?t:null==n?[]:[].concat(n)}))}},{key:"compact",value:function(e){var t=e?function(t,n,r){return!e(t,n,r)}:function(e){return!!e};return this.transform((function(e){return null!=e?e.filter(t):e}))}},{key:"describe",value:function(e){var t=sp(gt(n.prototype),"describe",this).call(this,e);if(this.innerType){var r,i=e;null!=(r=i)&&r.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[0]})),t.innerType=this.innerType.describe(i)}return t}}]),n}(sF);BF.prototype;var VF=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),r=t.call(this,{type:"tuple",spec:{types:e},check:function(e){var t=this.spec.types;return Array.isArray(e)&&e.length===t.length}}),r.withMutation((function(){r.typeError(Yj)})),r}return vt(n,[{key:"_cast",value:function(e,t){var r=this.spec.types,i=sp(gt(n.prototype),"_cast",this).call(this,e,t);if(!this._typeCheck(i))return i;var a=!1,o=r.map((function(e,n){var r=e.cast(i[n],Object.assign({},t,{path:"".concat(t.path||"","[").concat(n,"]")}));return r!==i[n]&&(a=!0),r}));return a?o:i}},{key:"_validate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=this.spec.types;sp(gt(n.prototype),"_validate",this).call(this,e,r,i,(function(n,s){var c;if(t._typeCheck(s)){var l,f=[],h=Tt(o.entries());try{for(h.s();!(l=h.n()).done;){var d,p=(0,u.Z)(l.value,2),v=p[0],y=p[1];f[v]=y.asNestedTest({options:r,index:v,parent:s,parentPath:r.path,originalParent:null!=(d=r.originalValue)?d:e})}}catch(m){h.e(m)}finally{h.f()}t.runTests({value:s,tests:f,originalValue:null!=(c=r.originalValue)?c:e,options:r},i,(function(e){return a(e.concat(n),s)}))}else a(n,s)}))}},{key:"describe",value:function(e){var t=sp(gt(n.prototype),"describe",this).call(this,e);return t.innerType=this.spec.types.map((function(t,n){var r,i=e;return null!=(r=i)&&r.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[n]})),t.describe(i)})),t}}]),n}(sF);VF.prototype;var zF=MF().shape({email:EF().email("Enter valid email").required("Required"),password:EF().min(5).max(20).matches(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{5,20}$/,{message:"Create stronger password"}).required("Required")});function qF(e,t){var n=(0,r.useState)(!1),i=(0,u.Z)(n,2),a=i[0],o=i[1],s=bj({initialValues:{email:"",password:""},validationSchema:zF,onSubmit:function(t,n){e.onSubmit(t),o(!0),setTimeout((function(){o(!1)}),3e3)}}),c=s.values,l=s.errors,f=s.touched,h=s.handleBlur,d=s.handleChange,p=s.handleSubmit;return(0,ot.jsxs)("form",{onSubmit:p,style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,ot.jsx)("label",{htmlFor:"email",children:"Email"}),(0,ot.jsx)("input",{style:{textAlign:"left"},className:"my-input",value:c.email,onChange:d,onBlur:h,id:"email",type:"email",placeholder:"Enter your email"}),f.email&&l.email&&(0,ot.jsx)("div",{className:"error",children:l.email}),(0,ot.jsx)("label",{htmlFor:"password",children:"Password"}),(0,ot.jsx)("input",{style:{textAlign:"left"},className:"my-input",value:c.password,onChange:d,onBlur:h,id:"password",type:"password",placeholder:"Enter your password"}),f.password&&l.password&&(0,ot.jsx)("div",{className:"error",children:l.password}),(0,ot.jsx)("button",{disabled:a,type:"submit",style:{marginTop:"50px"},children:"Submit"})]})}function ZF(e,t,n){localStorage.setItem("id",e),localStorage.setItem("email",t),localStorage.setItem("profileImage",n)}function WF(){var e=localStorage.getItem("id"),t=localStorage.getItem("email"),n=localStorage.getItem("profileImage"),r={Id:e,Email:t};return r.ProfileImage=n||"".concat(rr,"/noProfile.jpg"),r}var HF=function(e,t){var n=new Request("".concat(cr,"/").concat(t),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST","Access-Control-Allow-Headers":"Content-Type"},mode:"cors",body:JSON.stringify({credentials:e})});return fetch(n).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.error("Error:",e)}))};function KF(){var e=(0,r.useState)([]),t=(0,u.Z)(e,2),n=t[0],i=t[1],a=(0,r.useContext)(nt).update,c=xn();function l(e){return f.apply(this,arguments)}function f(){return(f=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i([]),e.next=4,HF(t,"login");case 4:it((n=e.sent).token),a(at()),ZF(n.user.id,n.user.email,n.user.profileImage),n&&(c("/"),c(0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),i(["Your login or password was wrong!"]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}return(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("h1",{style:{fontSize:"3em"},children:"Login"}),(0,ot.jsx)(qF,{model:{email:"",password:""},onSubmit:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),submitButtonName:"Login"}),(0,ot.jsx)("span",{style:{color:"red"},children:n})]})}function GF(){var e=xn(),t=(0,r.useState)(window.innerWidth),n=(0,u.Z)(t,2),i=n[0],a=n[1],c=(0,r.useState)(),l=(0,u.Z)(c,2),f=l[0],h=l[1],d=(0,r.useState)(!1),p=(0,u.Z)(d,2),v=p[0],y=p[1],m=(0,r.useRef)(null),g=10;(0,r.useEffect)((function(){b()}),[]);var k=oO(m,"1000px");function b(){return _.apply(this,arguments)}function _(){return(_=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f?(null===f||void 0===f?void 0:f.length)+g:g,e.next=3,lr({numberOfPosts:t},"get-posts");case 3:0!=(n=e.sent).length&&(f&&n.length==f.length?y(!0):h(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,r.useEffect)((function(){k&&b()}),[k]),(0,r.useEffect)((function(){window.addEventListener("resize",(function(){a(window.innerWidth)}))}),[]),(0,r.useEffect)((function(){a(window.innerWidth)}),[window.innerWidth]);var w=i>700;return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsx)(Yn,{isAuthorized:(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsxs)("div",{className:"middle-content",children:[(0,ot.jsx)($D,{setPosts:h}),(0,ot.jsx)(aO,{posts:f}),(0,ot.jsx)("span",{ref:m}),v&&(0,ot.jsx)("h2",{children:"You have reached end of internet."})]}),w&&(0,ot.jsx)(ar,{})]}),notAuthorized:(0,ot.jsxs)("div",{className:"notLogged",children:[(0,ot.jsx)("img",{src:"".concat(rr,"/logo.png")}),(0,ot.jsxs)("span",{className:"notLogged-logging",children:[(0,ot.jsx)(KF,{}),(0,ot.jsxs)("div",{children:["No account?"," ",(0,ot.jsx)("span",{className:"link",onClick:function(){return e("/register")},children:"Register here!"})]})]})]})})})}var QF={borderRadius:"1rem",margin:"0 auto",padding:"0.1rem"};function YF(e){var t=e.listOfData,n=e.handleSearch,i=e.itemChildren,a=e.bonusClassName,o=(0,r.useState)(t),s=(0,u.Z)(o,2),c=s[0],l=s[1],f=c.length>0?"flex":"none";return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsxs)("div",{className:"typeaheadContainer ".concat(a),style:QF,onBlur:function(){setTimeout((function(){l([])}),100)},children:[(0,ot.jsx)("input",{id:"user-search-typeahead",onChange:function(e){return n(e.target.value,l)},onFocus:function(e){return n(e.target.value,l)}}),c&&c.length>0&&(0,ot.jsx)("div",{className:"typeahead-options big-shadow-around",style:{display:f},children:c.map((function(e){return(0,ot.jsx)("span",{onClick:function(){return l([])},children:i(e)})}))})]})})}function $F(e){var t=e.profile,n=e.setChoosenFriend,i=(0,r.useContext)(Xn).myProfile;return(0,ot.jsx)(ot.Fragment,{children:i.Email!=t.Email&&(0,ot.jsx)("div",{className:"data-option medium-font",onClick:function(){n(t),document.getElementById("user-search-typeahead").value=""},children:(0,ot.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,ot.jsx)("img",{className:"data-option-part image",src:t.ProfileImage||"".concat(rr,"/noProfile.jpg")}),(0,ot.jsx)("span",{className:"data-option-part",children:t.Email})]})},t.Id)})}function XF(e){var t=e.setChoosenFriend,n=(0,r.useContext)(Xn).myProfile;function i(){return i=(0,s.Z)((0,o.Z)().mark((function e(t,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,lr({userId:n.Id,searchQuery:t},"search-friends");case 3:i=e.sent,r(i),e.next=8;break;case 7:r([]);case 8:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}return(0,ot.jsx)(YF,{listOfData:[],itemChildren:function(e){return(0,ot.jsx)($F,{profile:e,setChoosenFriend:t})},handleSearch:function(e,t){return i.apply(this,arguments)},bonusClassName:"messager-typeahead"})}function JF(e){var t=e.children;return"undefined"==typeof document?(0,ot.jsx)(ot.Fragment,{children:t}):Ue.createPortal(t,document.body)}function eM(e){var t=e.appName,n=xn();return(0,ot.jsx)("button",{className:"go-back-button",style:{height:"fit-content"},onClick:function(){n("/")},children:t})}var tM,nM=function(e){e.current&&Array.from(e.current.childNodes).forEach((function(e){e.nodeType===Node.TEXT_NODE&&(e.textContent=" ")}))};function rM(e,t,n,r){var i=window.innerWidth/4,a=window.innerHeight/4,o="width=600,height=600,left="+(window.innerWidth-i)/10+",top="+(window.innerHeight-a)/10;window.open("".concat(rr,"/#/call/").concat(r,"/").concat(e.Id,"/").concat(t.Id,"/").concat(n),"_blank",o)}var iM=tt.styled(tM||(tM=or(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  background-color: #ffffff;\n  flex-direction: column;\n"])));function aM(e){var t=e.isOpen,n=e.toggleModal,r=e.children;return(0,ot.jsx)(iM,{isOpen:t,onBackgroundClick:n,onEscapeKeydown:n,children:r})}function oM(e){var t=e.message,n=(0,r.useContext)(Xn).myProfile,i=(0,r.useState)({}),a=(0,u.Z)(i,2),o=a[0],s=a[1],c=(0,r.useState)(!1),l=(0,u.Z)(c,2),f=l[0],h=l[1],d=(0,r.useState)(!1),p=(0,u.Z)(d,2),v=p[0],y=p[1];function m(e,t){t(!e)}(0,r.useEffect)((function(){n&&(n.Id==t.SenderId?s({alignSelf:"flex-end"}):(s({alignSelf:"flex-start"}),h(!0)))}),[n]);var g=f?{}:{backgroundColor:"#0084ff",color:"white"},k=t.MediaFiles.length<4?t.MediaFiles.length:4;return(0,ot.jsxs)("div",{className:"message",style:o,children:[(0,ot.jsx)(aM,{isOpen:v,toggleModal:m,children:(0,ot.jsxs)("div",{className:"full-container flex-column-center",style:{height:"100vh"},children:[(0,ot.jsx)("span",{className:"header",children:(0,ot.jsx)("img",{className:"pointer",src:"".concat(rr,"/goBackArrow.png"),onClick:function(){return m(v,y)}})}),(0,ot.jsx)("span",{className:"body",style:{height:"90%"},children:(0,ot.jsx)(rO,{mediaFiles:t.MediaFiles})})]})}),(0,ot.jsxs)("div",{className:"message-content medium-font",style:g,children:[t.TextContent,t.MediaFiles.length>0&&(0,ot.jsx)("div",{className:"message-content-media",onClick:function(){y(!0)},style:{gridTemplateColumns:"repeat(".concat(k,", 1fr)")},children:t.MediaFiles.map((function(e){return(0,ot.jsx)("img",{src:e})}))}),t.VoiceFile&&(0,ot.jsx)("audio",{className:"message-content-audio",src:t.VoiceFile,controls:!0})]})]})}function sM(e){var t=e.messages;return(0,ot.jsx)("div",{className:"listOfMessages",children:t?t.map((function(e){return(0,ot.jsx)(ot.Fragment,{children:e.Id?(0,ot.jsx)(oM,{message:e},e.Id):(0,ot.jsx)("span",{id:"scrollable-span"})})})):(0,ot.jsx)("span",{style:{padding:"0.5rem"},children:"Loading messages..."})})}!function(e){try{if(typeof window>"u")return;var t=document.createElement("style");t.appendChild(document.createTextNode(".audio-recorder{background-color:#ebebeb;box-shadow:0 2px 5px #bebebe;border-radius:20px;box-sizing:border-box;color:#000;width:40px;display:flex;align-items:center;transition:all .2s ease-in;-webkit-tap-highlight-color:transparent}.audio-recorder-mic{box-sizing:content-box;cursor:pointer;height:16px;color:#000;padding:12px}.audio-recorder .audio-recorder-mic{border-radius:20px}.audio-recorder.recording .audio-recorder-mic{border-radius:0}.audio-recorder-timer,.audio-recorder-status{color:#000;margin-left:10px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;font-size:14px;font-weight:400;line-height:1}.audio-recorder-status{margin-left:15px;display:flex;align-items:baseline;flex-grow:1;animation-name:fading-ar-status;animation-duration:2s;animation-iteration-count:infinite}.audio-recorder-status-dot{background-color:#d00;border-radius:50%;height:10px;width:9px;margin-right:5px}.audio-recorder-options{box-sizing:content-box;height:16px;cursor:pointer;padding:12px 6px 12px 12px}.audio-recorder-options~.audio-recorder-options{padding:12px 12px 12px 6px;border-radius:0 5px 5px 0}.recording{border-radius:12px;width:300px;transition:all .2s ease-out}.display-none{display:none}.audio-recorder-visualizer{margin-left:15px;flex-grow:1;align-self:center;display:flex;align-items:center}@keyframes fading-ar-status{0%{opacity:1}50%{opacity:0}to{opacity:1}}")),document.head.appendChild(t)}catch(n){console.error("vite-plugin-css-injected-by-js",n)}}();var uM,cM=function(e,t){var n=(0,r.useState)(!1),i=(0,u.Z)(n,2),a=i[0],o=i[1],s=(0,r.useState)(!1),c=(0,u.Z)(s,2),l=c[0],f=c[1],h=(0,r.useState)(0),d=(0,u.Z)(h,2),p=d[0],v=d[1],y=(0,r.useState)(),m=(0,u.Z)(y,2),g=m[0],k=m[1],b=(0,r.useState)(),_=(0,u.Z)(b,2),w=_[0],x=_[1],S=(0,r.useState)(),E=(0,u.Z)(S,2),C=E[0],I=E[1],T=(0,r.useCallback)((function(){var e=setInterval((function(){v((function(e){return e+1}))}),1e3);x(e)}),[v,x]),N=(0,r.useCallback)((function(){null!=w&&clearInterval(w),x(void 0)}),[w,x]),A=(0,r.useCallback)((function(){null==w&&navigator.mediaDevices.getUserMedia({audio:null==e||e}).then((function(e){o(!0);var t=new MediaRecorder(e);k(t),t.start(),T(),t.addEventListener("dataavailable",(function(e){I(e.data),t.stream.getTracks().forEach((function(e){return e.stop()})),k(void 0)}))})).catch((function(e){console.log(e.name,e.message,e.cause),null==t||t(e)}))}),[w,o,k,T,I,t]);return{startRecording:A,stopRecording:(0,r.useCallback)((function(){null==g||g.stop(),N(),v(0),o(!1),f(!1)}),[g,v,o,f,N]),togglePauseResume:(0,r.useCallback)((function(){l?(f(!1),null==g||g.resume(),T()):(f(!0),N(),null==g||g.pause())}),[g,f,T,N]),recordingBlob:C,isRecording:a,isPaused:l,recordingTime:p,mediaRecorder:g}},lM=r.lazy((0,s.Z)((0,o.Z)().mark((function e(){var t,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(890).then(n.bind(n,890));case 2:return t=e.sent,r=t.LiveAudioVisualizer,e.abrupt("return",{default:r});case 5:case"end":return e.stop()}}),e)})))),fM=function(e){var t,n,i,a,o,s,c=e.onRecordingComplete,l=e.onNotAllowedOrFound,f=e.recorderControls,h=e.audioTrackConstraints,d=e.downloadOnSavePress,p=void 0!==d&&d,v=e.downloadFileExtension,y=void 0===v?"mp3":v,m=e.showVisualizer,g=void 0!==m&&m,k=e.classes,b=null!=f?f:cM(h,l),_=b.startRecording,w=b.stopRecording,x=b.togglePauseResume,S=b.recordingBlob,E=b.isRecording,C=b.isPaused,I=b.recordingTime,T=b.mediaRecorder,N=(0,r.useState)(!1),A=(0,u.Z)(N,2),D=A[0],O=A[1],R=function(){O(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),w()};return(0,r.useEffect)((function(){(D||f)&&null!=S&&null!=c&&(c(S),p&&function(e){var t=new Blob([e],{type:"audio/".concat(y)}),n=URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=n,r.download="audio.".concat(y),document.body.appendChild(r),r.click(),r.remove()}(S))}),[S]),r.createElement("div",{className:"audio-recorder ".concat(E?"recording":""," ").concat(null!=(t=null==k?void 0:k.AudioRecorderClass)?t:""),"data-testid":"audio_recorder"},r.createElement("img",{src:E?"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0xNy44NSAzLjE1bC0yLjk5LTNBLjUwOC41MDggMCAwIDAgMTQuNSAwSDEuNEExLjQxNyAxLjQxNyAwIDAgMCAwIDEuNDN2MTUuMTRBMS40MTcgMS40MTcgMCAwIDAgMS40IDE4aDE1LjJhMS40MTcgMS40MTcgMCAwIDAgMS40LTEuNDNWMy41YS40Ny40NyAwIDAgMC0uMTUtLjM1ek0yIDVWM2ExIDEgMCAwIDEgMS0xaDhhMSAxIDAgMCAxIDEgMXYyYTEgMSAwIDAgMS0xIDFIM2ExIDEgMCAwIDEtMS0xem03IDExYTQgNCAwIDEgMSA0LTQgNCA0IDAgMCAxLTQgNHoiLz4NCjwvc3ZnPg0K":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDQ3MCA0NzAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ3MCA0NzA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCgk8Zz4NCgkJPHBhdGggZD0iTTIzNSwzMDIuMjk2YzQ3LjE3NywwLDg1LjQyMy0zOC4yNDUsODUuNDIzLTg1LjQyM1Y4NS40MjNDMzIwLjQyMywzOC4yNDUsMjgyLjE3NywwLDIzNSwwcy04NS40MjMsMzguMjQ1LTg1LjQyMyw4NS40MjMNCgkJCXYxMzEuNDUxQzE0OS41NzcsMjY0LjA1MSwxODcuODIzLDMwMi4yOTYsMjM1LDMwMi4yOTZ6Ii8+DQoJCTxwYXRoIGQ9Ik0zNTAuNDIzLDEzNi4xNDh2MzBoMTV2NTAuNzI2YzAsNzEuOTE1LTU4LjUwOCwxMzAuNDIzLTEzMC40MjMsMTMwLjQyM3MtMTMwLjQyMy01OC41MDctMTMwLjQyMy0xMzAuNDIzdi01MC43MjZoMTV2LTMwDQoJCQloLTQ1djgwLjcyNkM3NC41NzcsMzAwLjI3MywxMzguNTUxLDM2OSwyMjAsMzc2LjU4OVY0NDBoLTkwLjQ0NHYzMGgyMTAuODg5di0zMEgyNTB2LTYzLjQxMQ0KCQkJYzgxLjQ0OS03LjU4OSwxNDUuNDIzLTc2LjMxNywxNDUuNDIzLTE1OS43MTZ2LTgwLjcyNkgzNTAuNDIzeiIvPg0KCTwvZz4NCjwvc3ZnPg0K",className:"audio-recorder-mic ".concat(null!=(n=null==k?void 0:k.AudioRecorderStartSaveClass)?n:""),onClick:E?function(){return R()}:_,"data-testid":"ar_mic",title:E?"Save recording":"Start recording"}),r.createElement("span",{className:"audio-recorder-timer ".concat(E?"":"display-none"," ").concat(null!=(i=null==k?void 0:k.AudioRecorderTimerClass)?i:""),"data-testid":"ar_timer"},Math.floor(I/60),":",String(I%60).padStart(2,"0")),g?r.createElement("span",{className:"audio-recorder-visualizer ".concat(E?"":"display-none")},T&&r.createElement(r.Suspense,{fallback:r.createElement(r.Fragment,null)},r.createElement(lM,{mediaRecorder:T,barWidth:2,gap:2,width:140,height:30,fftSize:512,maxDecibels:-10,minDecibels:-80,smoothingTimeConstant:.4}))):r.createElement("span",{className:"audio-recorder-status ".concat(E?"":"display-none"," ").concat(null!=(a=null==k?void 0:k.AudioRecorderStatusClass)?a:"")},r.createElement("span",{className:"audio-recorder-status-dot"}),"Recording"),r.createElement("img",{src:C?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDQ5NC4xNDggNDk0LjE0OCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDk0LjE0OCA0OTQuMTQ4OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQoJPGc+DQoJCTxnPg0KCQkJPHBhdGggZD0iTTQwNS4yODQsMjAxLjE4OEwxMzAuODA0LDEzLjI4QzExOC4xMjgsNC41OTYsMTA1LjM1NiwwLDk0Ljc0LDBDNzQuMjE2LDAsNjEuNTIsMTYuNDcyLDYxLjUyLDQ0LjA0NHY0MDYuMTI0DQoJCQkJYzAsMjcuNTQsMTIuNjgsNDMuOTgsMzMuMTU2LDQzLjk4YzEwLjYzMiwwLDIzLjItNC42LDM1LjkwNC0xMy4zMDhsMjc0LjYwOC0xODcuOTA0YzE3LjY2LTEyLjEwNCwyNy40NC0yOC4zOTIsMjcuNDQtNDUuODg0DQoJCQkJQzQzMi42MzIsMjI5LjU3Miw0MjIuOTY0LDIxMy4yODgsNDA1LjI4NCwyMDEuMTg4eiIvPg0KCQk8L2c+DQoJPC9nPg0KPC9zdmc+DQo=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDcuNjA3IDQ3LjYwNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDcuNjA3IDQ3LjYwNzsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KCTxnPg0KCQk8cGF0aCBkPSJNMTcuOTkxLDQwLjk3NmMwLDMuNjYyLTIuOTY5LDYuNjMxLTYuNjMxLDYuNjMxbDAsMGMtMy42NjIsMC02LjYzMS0yLjk2OS02LjYzMS02LjYzMVY2LjYzMUM0LjcyOSwyLjk2OSw3LjY5OCwwLDExLjM2LDANCgkJCWwwLDBjMy42NjIsMCw2LjYzMSwyLjk2OSw2LjYzMSw2LjYzMVY0MC45NzZ6Ii8+DQoJCTxwYXRoIGQ9Ik00Mi44NzcsNDAuOTc2YzAsMy42NjItMi45NjksNi42MzEtNi42MzEsNi42MzFsMCwwYy0zLjY2MiwwLTYuNjMxLTIuOTY5LTYuNjMxLTYuNjMxVjYuNjMxDQoJCQlDMjkuNjE2LDIuOTY5LDMyLjU4NSwwLDM2LjI0NiwwbDAsMGMzLjY2MiwwLDYuNjMxLDIuOTY5LDYuNjMxLDYuNjMxVjQwLjk3NnoiLz4NCgk8L2c+DQo8L3N2Zz4NCg==",className:"audio-recorder-options ".concat(E?"":"display-none"," ").concat(null!=(o=null==k?void 0:k.AudioRecorderPauseResumeClass)?o:""),onClick:x,title:C?"Resume recording":"Pause recording","data-testid":"ar_pause"}),r.createElement("img",{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDYuNzM0IDQ2LjczNCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDYuNzM0IDQ2LjczNDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPHBhdGggZD0iTTQxLjM0NiwwSDUuMzg4QzIuNDE3LDAsMCwyLjQxNywwLDUuMzg4djM1Ljk1OGMwLDIuOTcxLDIuNDE3LDUuMzg4LDUuMzg4LDUuMzg4aDM1Ljk1OGMyLjk3MSwwLDUuMzg4LTIuNDE3LDUuMzg4LTUuMzg4DQoJCVY1LjM4OEM0Ni43MzMsMi40MTcsNDQuMzE2LDAsNDEuMzQ2LDB6Ii8+DQo8L2c+DQo8L3N2Zz4NCg==",className:"audio-recorder-options ".concat(E?"":"display-none"," ").concat(null!=(s=null==k?void 0:k.AudioRecorderDiscardClass)?s:""),onClick:function(){return R(!1)},title:"Discard Recording","data-testid":"ar_cancel"}))};function hM(e){var t=e.setVoiceMessage,n=e.setAudioURL,i=e.voiceMessage,a=e.removedVoiceMes,o=e.setRemovedVoiceMes,s=(0,r.useState)(!1),c=(0,u.Z)(s,2),l=c[0],f=c[1],h=cM();var d="".concat(rr,l?"/stop-record.png":"/micro-on.png");return(0,ot.jsx)("div",{className:"recordMessager",children:i?(0,ot.jsx)("img",{src:"".concat(rr,"/redX.png"),onClick:function(){o(!0),t(void 0),n("")}}):(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("img",{src:d,onClick:function(){l?(h.stopRecording(),f(!1)):(o(!1),h.startRecording(),f(!0))}}),(0,ot.jsx)(fM,{onRecordingComplete:function(e){return function(e){if(!a){var r=URL.createObjectURL(e);n(r),t(e)}}(e)},recorderControls:h})]})})}function dM(e){var t=e.friend,n=e.setChoosenFriend,i=e.fullScreen,a=(0,r.useContext)(Xn).myProfile,c=(xn(),(0,r.useState)([])),l=(0,u.Z)(c,2),f=l[0],h=l[1],d=(0,r.useState)(""),p=(0,u.Z)(d,2),v=p[0],y=p[1],m=(0,r.useState)(""),g=(0,u.Z)(m,2),k=g[0],b=g[1],_=(0,r.useState)(),w=(0,u.Z)(_,2),x=w[0],S=w[1],E=(0,r.useState)(!1),C=(0,u.Z)(E,2),I=C[0],T=C[1],N=(0,r.useState)(!1),A=(0,u.Z)(N,2),D=A[0],O=A[1],R=(0,r.useState)(!1),P=(0,u.Z)(R,2),L=P[0],j=P[1],F=(0,r.useState)([]),M=(0,u.Z)(F,2),U=M[0],B=M[1],V=t.ProfileImage||"".concat(rr,"/noProfile.jpg"),z=10,q=(0,r.useRef)(null),Z=(0,r.useRef)(null),W=(0,r.useRef)(null),H=(0,r.useRef)(null);(0,r.useEffect)((function(){Z.current&&Z.current.scrollIntoView()}),[Z,D]);var K=oO(q,"400px");function G(){return Q.apply(this,arguments)}function Q(){return(Q=(0,s.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L!=t.Id){e.next=2;break}return e.abrupt("return");case 2:n=(null===f||void 0===f?void 0:f.length)+z,lr({userId:a.Id,friendId:t.Id,numberOfMessages:n},"get-chat-messages").then((function(e){e&&f&&e.length==f.length&&j(t.Id),O(!0);var n=[];e.forEach((function(e,t){(null===f||void 0===f?void 0:f.length)==t+1&&n.push("empty"),n.push(e)})),h(n.reverse())}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return Y=(0,s.Z)((0,o.Z)().mark((function e(){var n,r,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={SenderId:a.Id,ReceiverId:t.Id,TextContent:v,MediaFiles:[],VoiceFile:"",Date:Date.now()},r=[],U.length>0&&(r=U.map(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,u.Z)(t,2),r=n[0],n[1],i=ZD.child("/messageImages/".concat(null===r||void 0===r?void 0:r.name,"+").concat(KD())),e.next=4,i.put(r);case 4:return e.next=6,i.getDownloadURL();case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.next=5,Promise.all(r);case 5:if(n.MediaFiles=e.sent,!x){e.next=14;break}return i=ZD.child("/messageVoices/".concat(KD())),e.next=10,i.put(x);case 10:return e.next=12,i.getDownloadURL();case 12:c=e.sent,n.VoiceFile=c;case 14:uB.emit("send-message",n),setTimeout((function(){B([]),S(void 0),b(""),T(!0),y(""),nM(W),Z.current&&Z.current.scrollIntoView()}),500);case 16:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}(0,r.useEffect)((function(){K&&G()}),[K]),(0,r.useEffect)((function(){a.Id&&Z&&t.Id&&(G(),uB.on("receive-message/".concat(a.Id,"/").concat(t.Id),(function(e){f.includes(e)||(h((function(t){return[].concat(ft(t),[e])})),setTimeout((function(){Z.current&&Z.current.scrollIntoView()}),1e3))})))}),[a,Z,t.Id]),(0,r.useEffect)((function(){if(t.Id){var e=document.getElementById("scrollable-span");e&&e.scrollIntoView()}}),[f,t.Id]);var $=""!=v||U.length>0||""!=k?"80%":"30%",X=function(e){var t=new FileReader;t.onload=function(){var n=t.result;B((function(t){return[].concat(ft(t),[[e,n]])}))},e&&t.readAsDataURL(e)};var J=i?{width:"100%"}:{};return(0,ot.jsxs)("section",{className:"messager-chat",style:J,children:[(0,ot.jsxs)("div",{className:"messager-chat-header shadow-beneath",children:[(0,ot.jsxs)("span",{className:"messager-chat-header-userProfile",children:[i&&(0,ot.jsx)("img",{className:"messager-chat-header-userProfile-image",style:{marginRight:"1rem"},src:"".concat(rr,"/goBackArrow.png"),onClick:function(){return n(void 0)}}),(0,ot.jsx)("img",{className:"messager-chat-header-userProfile-image",src:V}),t.Email]}),(0,ot.jsx)("img",{className:"messager-chat-header-call",src:"".concat(rr,"/video-call.png"),onClick:function(){var e=KD();uB.emit("create-join-room",{myId:a.Id,friendId:t.Id,roomId:e}),rM(a,t,e,"caller")}})]}),(0,ot.jsxs)("div",{id:"chat-body/".concat(t.Id),className:"messager-chat-body",children:[(0,ot.jsxs)("div",{className:"messager-chat-body-start",children:[(0,ot.jsx)("img",{src:V}),(0,ot.jsx)("h5",{children:t.Email})]}),(0,ot.jsx)("span",{ref:q}),(0,ot.jsx)(sM,{messages:f}),(0,ot.jsx)("span",{ref:Z})]}),(0,ot.jsxs)("div",{className:"messager-chat-footer shadow-above",children:[(0,ot.jsxs)("span",{style:{display:"flex",height:"80%",alignItems:"center",gap:"0.5rem"},children:[""==v&&!x&&U.length<=0&&(0,ot.jsx)(YD,{handleFileChange:X}),(0,ot.jsx)(hM,{setVoiceMessage:S,setAudioURL:b,voiceMessage:x,removedVoiceMes:I,setRemovedVoiceMes:T})]}),(0,ot.jsx)("div",{className:"messager-chat-footer-container",style:{width:$},children:(0,ot.jsxs)("div",{ref:H,className:"messager-chat-footer-input",children:[(0,ot.jsx)("div",{ref:W,style:{height:"100%",width:"100%",outline:"none"},contentEditable:!0,onInput:function(e){return y(e.target.innerText)}}),U&&U.length>0&&(0,ot.jsxs)("span",{className:"messager-chat-footer-input-images-container",children:[(0,ot.jsx)("div",{style:{width:"5rem",height:"5rem"},children:(0,ot.jsx)(YD,{handleFileChange:X})}),U.map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return(0,ot.jsxs)("div",{className:"messager-chat-footer-input-image",children:[(0,ot.jsx)("img",{style:{height:"100%",width:"100%",outline:"none"},src:r}),(0,ot.jsx)("img",{className:"erase-image",src:"".concat(rr,"/redX.png"),onClick:function(){return function(e){var t=U.filter((function(t){var n=(0,u.Z)(t,2),r=n[0];return n[1],r.name!=e}));B(t)}(n.name)}})]})}))]}),x&&k&&(0,ot.jsx)("audio",{style:{width:"100%"},src:k,controls:!0})]})}),(0,ot.jsx)("img",{className:"messager-chat-footer-send",src:v||0!=U.length||x?"".concat(rr,"/sendBtn.png"):"".concat(rr,"/like.png"),onClick:function(){return Y.apply(this,arguments)}})]})]})}function pM(e){var t=e.profile,n=e.setChoosenFriend,r=t.ProfileImage||"".concat(rr,"/noProfile.jpg");return(0,ot.jsxs)("div",{className:"messager-mobile-icon flex-center",onClick:function(){n(t)},children:[(0,ot.jsx)("img",{className:"messager-mobile-icon-image",src:r}),(0,ot.jsx)("span",{className:"messager-mobile-icon-name medium-font",children:t.Email})]})}function vM(e){var t=e.profile,n=e.setChoosenFriend,r=t.ProfileImage||"".concat(rr,"/noProfile.jpg");return(0,ot.jsxs)("div",{className:"mobile-friend messager-friend",onClick:function(){n(t)},children:[(0,ot.jsx)("img",{className:"messager-friend-image",src:r}),(0,ot.jsx)("div",{children:(0,ot.jsx)("span",{className:"messager-friend-name",style:{fontSize:"2rem"},children:t.Email})})]})}function yM(e){var t=e.setChoosenFriend,n=e.choosenFriend,i=xn(),a=(0,r.useContext)(Jn).myFriends;return(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsxs)("div",{className:"messager-mobile-header flex-center",children:[(0,ot.jsx)("img",{src:"".concat(rr,"/goBackArrow.png"),onClick:function(){return i("/")}}),(0,ot.jsx)("h3",{children:"Chats"})]}),(0,ot.jsxs)("div",{className:"messager-mobile-options",children:[(0,ot.jsx)(XF,{setChoosenFriend:t}),a&&(0,ot.jsx)("div",{className:"messager-mobile-options-friends",children:a.map((function(e){return(0,ot.jsx)(pM,{profile:e,setChoosenFriend:t},e.Id)}))})]}),(0,ot.jsx)("div",{className:"messager-mobile-body",children:a&&a.map((function(e){return(0,ot.jsx)(vM,{profile:e,setChoosenFriend:t},e.Id)}))}),(0,ot.jsx)("div",{className:"messager-mobile-footer"}),n&&(0,ot.jsx)("div",{className:"whole-page",children:(0,ot.jsx)(dM,{friend:n,fullScreen:!0,setChoosenFriend:t})})]})}function mM(e){var t=e.profile,n=e.setChoosenFriend,r=t.ProfileImage||"".concat(rr,"/noProfile.jpg");return(0,ot.jsxs)("div",{className:"messager-friend",onClick:function(){n(t)},children:[(0,ot.jsx)("img",{className:"messager-friend-image",src:r}),(0,ot.jsx)("span",{className:"messager-friend-name",children:t.Email})]})}function gM(e){var t=e.friends,n=e.setChoosenFriend;return(0,ot.jsx)(JD,{list:t,emptyListUI:(0,ot.jsx)(ot.Fragment,{}),children:(0,ot.jsx)(ot.Fragment,{children:t?t.map((function(e){return(0,ot.jsx)(mM,{profile:e,setChoosenFriend:n},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}function kM(e){var t=e.friend,n=e.sent,i=(0,r.useContext)(Xn).myProfile,a=(0,r.useContext)(Jn),u=a.myFriends,c=a.updateFriends,l=(0,r.useContext)(er),f=l.myFriendRequests,h=l.updateFriendRequests,d=(0,r.useContext)(tr),p=d.mySentRequests,v=d.updateSentFriendRequests;function y(){return(y=(0,s.Z)((0,o.Z)().mark((function e(){var n,r,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:i.Id,friendId:t.Id},"accept-friend-request");case 2:n=e.sent,r=f.filter((function(e){return e.Id!=t.Id})),h(r),(a=ft(u)).push(n),c(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,s.Z)((0,o.Z)().mark((function e(){var r,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=9;break}return console.log(i.Id),e.next=4,lr({userId:i.Id,friendId:t.Id},"cancel-friend-request/user");case 4:r=e.sent,a=p.filter((function(e){return e.Id!=r.Id})),v(a),e.next=14;break;case 9:return e.next=11,lr({userId:t.Id,friendId:i.Id},"cancel-friend-request/friend");case 11:s=e.sent,u=f.filter((function(e){return e.Id!=s.Id})),h(u);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,ot.jsxs)("div",{className:"friend-request",children:[(0,ot.jsxs)("span",{className:"friend-request-profile",children:[(0,ot.jsx)("img",{src:t.ProfileImage||"".concat(rr,"/noProfile.jpg")}),(0,ot.jsx)("span",{className:"large-font",children:t.Email})]}),(0,ot.jsxs)("span",{className:"friend-request-options",children:[!n&&(0,ot.jsx)("button",{onClick:function(){return y.apply(this,arguments)},children:"Accept request"}),(0,ot.jsx)("button",{onClick:function(){return m.apply(this,arguments)},children:"Cancel request"})]})]})}function bM(e){var t=e.friends,n=e.sent;return(0,ot.jsx)(JD,{list:t,emptyListUI:(0,ot.jsx)(ot.Fragment,{children:"You don't have friend requests"}),children:(0,ot.jsx)("div",{className:"listOfFriendRequests",children:t?t.map((function(e){return(0,ot.jsx)(kM,{sent:n,friend:e},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}function _M(e){var t=e.friend,n=xn(),i=(0,r.useContext)(Xn).myProfile,a=(0,r.useContext)(Jn),u=a.myFriends,c=a.updateFriends;function l(){return(l=(0,s.Z)((0,o.Z)().mark((function e(){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:i.Id,friendId:t.Id},"remove-friend");case 2:n=e.sent,r=u.filter((function(e){return e.Id!=n.Id})),c(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,ot.jsxs)("div",{className:"friend",children:[(0,ot.jsx)("img",{src:t.ProfileImage||"".concat(rr,"/noProfile.jpg"),onClick:function(){return n("/user-profile/".concat(t.Id))}}),(0,ot.jsxs)("span",{className:"friend-info",children:[(0,ot.jsx)("span",{className:"large-font",children:t.Email}),(0,ot.jsx)("button",{className:"friend-remove medium-font",onClick:function(){return l.apply(this,arguments)},children:"Remove friend"})]})]})}function wM(e){var t=e.friends,n=t&&t.length<3?t.length:3;return(0,ot.jsx)(JD,{list:t,emptyListUI:(0,ot.jsx)(ot.Fragment,{children:"You don't have friends"}),children:(0,ot.jsx)("div",{className:"listOfFriends",style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)")},children:t?t.map((function(e){return(0,ot.jsx)(_M,{friend:e},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}function xM(e){var t=e.imageFunction,n=e.fileFunction,i=e.callback,a=(0,r.useState)(null),o=(0,u.Z)(a,2),s=(o[0],o[1]);return(0,ot.jsx)(ot.Fragment,{children:(0,ot.jsx)("input",{className:"custom-file-input",type:"file",accept:".jpg,.jpeg,.png",onChange:function(e){var r=e.target.files[0],a=new FileReader;a.onload=function(){var e=a.result;n(r),t(e),s(e)},r&&a.readAsDataURL(r),i()}})})}var SM=tt.styled(uM||(uM=or(["\n  position: absolute;\n  top: 0;\n  width: 60vw;\n  height: 13vh;\n  display: flex;\n  align-items: center;\n  background-color: #ffffff;\n  justify-content: space-between;\n"])));function EM(e){var t=e.isOpen,n=e.toggleModal,r=e.children,i=e.submitButtonText,a=e.onSubmit,o=e.onClose,s=e.disableSubmit;return(0,ot.jsxs)(SM,{isOpen:t,onBackgroundClick:n,onEscapeKeydown:n,children:[r,(0,ot.jsxs)("div",{children:[(0,ot.jsx)("button",{disabled:s,onClick:function(){n(),a()},children:i}),(0,ot.jsx)("button",{onClick:function(){o(),n()},children:"Close"})]})]})}function CM(e){var t=e.friend,n=xn(),r=t.ProfileImage||"".concat(rr,"/noProfile.jpg");return(0,ot.jsxs)("div",{className:"friend-profile",onClick:function(){return n("/user-profile/".concat(t.Id))},children:[(0,ot.jsx)("img",{src:r}),(0,ot.jsx)("span",{className:"large-font",style:{wordBreak:"break-all",padding:"0.5rem"},children:t.Email})]})}function IM(e){var t=e.friends;return(0,ot.jsx)(JD,{list:t,emptyListUI:(0,ot.jsx)(ot.Fragment,{children:"You don't have friends."}),children:(0,ot.jsx)("div",{className:"listOfPosts",style:{gap:"1rem",flexDirection:"row"},children:t?t.map((function(e){return(0,ot.jsx)(CM,{friend:e},e.Id)})):(0,ot.jsx)(XD,{message:"Loading"})})})}var TM=new RTCPeerConnection({});var NM=[{path:"/login",component:KF},{path:"/register",component:function(){var e=(0,r.useState)([]),t=(0,u.Z)(e,2),n=(t[0],t[1]),i=(0,r.useContext)(nt).update,a=xn();function c(e){return l.apply(this,arguments)}function l(){return(l=(0,s.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n([]),e.next=4,HF(t,"register");case 4:it((r=e.sent).token),i(at()),ZF(r.user.id,r.user.email,r.user.profileImage),r&&(a("/"),a(0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),n(["The name is already taken"]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}return(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("h1",{children:"Register"}),(0,ot.jsx)(qF,{model:{email:"",password:""},onSubmit:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),submitButtonName:"Register"})]})}},{path:"/user-profile/:id",component:function(){var e=En().id,t=(0,r.useContext)(Xn),n=t.myProfile,i=t.updateProfile,a=(0,r.useContext)(Jn),c=a.myFriends,l=a.updateFriends,f=(0,r.useContext)(er),h=f.myFriendRequests,d=f.updateFriendRequests,p=(0,r.useContext)(tr),v=p.mySentRequests,y=p.updateSentFriendRequests,m=(0,r.useState)(),g=(0,u.Z)(m,2),k=g[0],b=g[1],_=(0,r.useState)("posts"),w=(0,u.Z)(_,2),x=w[0],S=w[1],E=(0,r.useState)(),C=(0,u.Z)(E,2),I=C[0],T=C[1],N=(0,r.useState)((null===k||void 0===k?void 0:k.ProfileImage)||"".concat(rr,"/noProfile.jpg")),A=(0,u.Z)(N,2),D=A[0],O=A[1],R=(0,r.useState)(),P=(0,u.Z)(R,2),L=P[0],j=P[1],F=(0,r.useState)(!1),M=(0,u.Z)(F,2),U=M[0],B=M[1],V=(0,r.useState)([]),z=(0,u.Z)(V,2),q=z[0],Z=z[1],W=(0,r.useState)([]),H=(0,u.Z)(W,2),K=H[0],G=H[1],Q=(0,r.useState)(!1),Y=(0,u.Z)(Q,2),$=Y[0],X=Y[1],J=(0,r.useRef)(null),ee=10,te=oO(J,"1000px");function ne(){B(!U)}function re(e){return ie.apply(this,arguments)}function ie(){return(ie=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=K.length+ee,e.next=3,lr({name:t,numberOfPosts:n},"get-user-posts");case 3:(r=e.sent)&&(r.length==K.length?X(!0):G(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(){return ae=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T("inFriendRequests"),e.next=3,lr({userId:n.Id,friendId:k.Id},"send-friend-request");case 3:t=e.sent,y((function(e){return[t].concat(ft(e))}));case 5:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}function oe(){return oe=(0,s.Z)((0,o.Z)().mark((function e(){var t,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T("stranger"),e.next=3,lr({userId:n.Id,friendId:k.Id},"cancel-friend-request/user");case 3:t=e.sent,r=t.Id,i=v.filter((function(e){return e.Id!=r})),y(i);case 7:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function se(){return(se=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(k&&k.Id&&n&&n.Id)){e.next=5;break}return e.next=3,lr({userId:n.Id,friendId:k.Id},"check-if-in-friends");case 3:t=e.sent,T(t.relation);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(){return ue=(0,s.Z)((0,o.Z)().mark((function e(){var t,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!L){e.next=7;break}return r=ZD.child("/profileImages/".concat(null===L||void 0===L?void 0:L.name,"+").concat(KD())),e.next=4,r.put(L);case 4:return e.next=6,r.getDownloadURL();case 6:t=e.sent;case 7:O(t),fr({userId:n.Id,fileUrl:t},"change-profile-image"),localStorage.setItem("profileImage",t),i({Id:n.Id,Email:n.Email,ProfileImage:t});case 11:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}function ce(){return(ce=(0,s.Z)((0,o.Z)().mark((function e(){var t,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:n.Id,friendId:k.Id},"accept-friend-request");case 2:t=e.sent,r=h.filter((function(e){return e.Id!=k.Id})),d(r),(i=ft(c)).push(t),l(i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.useEffect)((function(){te&&re(k.Email)}),[te]),(0,r.useEffect)((function(){var t=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,lr({name:e},"get-user");case 2:return n=t.sent,b(n),O(n.ProfileImage||"".concat(rr,"/noProfile.jpg")),re(n.Email),t.t0=Z,t.next=9,lr({userId:n.Id},"get-friends");case 9:t.t1=t.sent,(0,t.t0)(t.t1);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]),(0,r.useEffect)((function(){!function(){se.apply(this,arguments)}()}),[n,k]),(0,ot.jsx)(ot.Fragment,{children:k?(0,ot.jsxs)("div",{className:"profile",children:[(0,ot.jsxs)("div",{className:"profile-up",children:[(0,ot.jsx)(EM,{isOpen:U,toggleModal:ne,children:(0,ot.jsx)("span",{style:{padding:"0.4rem",color:"green"},children:"Do you want to set this image?"}),submitButtonText:"Submit",onSubmit:function(){return ue.apply(this,arguments)},onClose:function(){return O(localStorage.getItem("profileImage"))}}),(0,ot.jsx)("div",{className:"profile-up-image",style:{backgroundImage:"url(".concat(D,")")},children:"me"==I&&(0,ot.jsx)("span",{className:"profile-up-image-input",children:(0,ot.jsx)(xM,{imageFunction:O,fileFunction:j,callback:ne})})}),(0,ot.jsxs)("span",{className:"profile-up-options",children:[(0,ot.jsxs)("span",{className:"profile-up-options-up",children:[(0,ot.jsx)("img",{src:D||"".concat(rr,"/noProfile.jpg")}),(0,ot.jsx)("h4",{children:k.Email})]}),(0,ot.jsxs)("span",{className:"profile-up-options-down",children:[(0,ot.jsx)("button",{className:"large-font",onClick:function(){return S("posts")},children:"Posts"}),(0,ot.jsx)("button",{className:"large-font",onClick:function(){return S("friends")},children:"Friends"}),"stranger"==I&&(0,ot.jsx)("button",{className:"large-font",onClick:function(){return ae.apply(this,arguments)},children:"Add friend"}),"inFriendRequests"==I&&(0,ot.jsx)("button",{className:"large-font",style:{backgroundColor:"#89CFF0"},onClick:function(){return oe.apply(this,arguments)},children:"Cancel request"}),"pendingRequest"==I&&(0,ot.jsx)("button",{className:"large-font",style:{backgroundColor:"#89CFF0"},onClick:function(){return ce.apply(this,arguments)},children:"Accept request"})]})]})]}),(0,ot.jsxs)("div",{className:"profile-down",children:["posts"==x&&(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("h2",{children:"Posts"}),(0,ot.jsx)(aO,{posts:K}),(0,ot.jsx)("span",{ref:J}),$&&(0,ot.jsx)("h2",{children:"You have reached end of internet."})]}),"friends"==x&&(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("h2",{children:"Friends"}),(0,ot.jsx)(IM,{friends:q})]})]})]}):(0,ot.jsx)(XD,{message:"Loading..."})})}},{path:"/user-friends/:id",component:function(){var e=(0,r.useContext)(Jn).myFriends;return(0,ot.jsxs)("div",{className:"friends",children:[(0,ot.jsx)("h2",{children:"Your friends"}),(0,ot.jsx)("span",{className:"friends-container",children:(0,ot.jsx)(wM,{friends:e})})]})}},{path:"/user-friend-requests/:id",component:function(){var e=(0,r.useContext)(er).myFriendRequests;return(0,ot.jsxs)("div",{className:"friendRequests",children:[(0,ot.jsx)("h2",{children:"Your incoming requests"}),(0,ot.jsx)(bM,{friends:e,sent:!1})]})}},{path:"/user-sent-friend-requests/:id",component:function(){var e=(0,r.useContext)(tr).mySentRequests;return(0,ot.jsxs)("div",{className:"friendRequests",children:[(0,ot.jsx)("h2",{children:"Your Sent Requests"}),(0,ot.jsx)(bM,{friends:e,sent:!0})]})}},{path:"/call/:who/:userId/:friendId/:roomId",component:function(){var e=En(),t=e.who,n=e.userId,i=e.friendId,a=e.roomId,c={audio:!0,video:!0},l=(0,r.useRef)(null),f=(0,r.useRef)(null),h=(0,r.useState)(""),d=(0,u.Z)(h,2),p=d[0],v=d[1],y=(0,r.useState)(!0),m=(0,u.Z)(y,2),g=m[0],k=m[1],b=(0,r.useState)(!0),_=(0,u.Z)(b,2),w=_[0],x=_[1],S=(0,r.useState)("on"),E=(0,u.Z)(S,2),C=E[0],I=E[1],T=(0,r.useState)("on"),N=(0,u.Z)(T,2),A=N[0],D=N[1],O=(0,r.useState)(!1),R=(0,u.Z)(O,2),P=R[0],L=R[1];function j(){return j=(0,s.Z)((0,o.Z)().mark((function e(){var n,r,i,a,u,h;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!l.current||!f.current){e.next=19;break}return e.next=4,navigator.mediaDevices.getUserMedia(c);case 4:n=e.sent,r=Tt(n.getTracks());try{for(r.s();!(i=r.n()).done;)a=i.value,TM.addTrack(a,n)}catch(d){r.e(d)}finally{r.f()}l.current.srcObject=n,TM.ontrack=function(e){var t=e.track,n=e.streams;t.onunmute=function(){f.current.srcObject||(f.current.srcObject=n[0])}},u=!1,"caller"==t&&(TM.onnegotiationneeded=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{u=!0,setTimeout((0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TM.setLocalDescription();case 2:console.log("sending offer"),uB.send({type:"video-offer",description:TM.localDescription,target:p});case 4:case"end":return e.stop()}}),e)}))),1e3)}catch(d){console.error(d)}finally{u=!1}case 1:case"end":return e.stop()}}),e)})))),TM.onconnectionstatechange=function(e){"disconnected"===TM.connectionState&&L(!0)},TM.oniceconnectionstatechange=function(){"failed"===TM.iceConnectionState&&TM.restartIce()},TM.onicecandidate=function(e){var t=e.candidate;setTimeout((function(){uB.send({type:"iceCandidate",candidate:t,target:p})}),1e3)},h=!1,console.log(Date.now()),uB.on("message",function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.description){e.next=15;break}if(n="offer"===t.description.type&&(u||"stable"!==TM.signalingState),!(h=n)){e.next=6;break}return e.abrupt("return");case 6:return console.log("remote description"),e.next=9,TM.setRemoteDescription(t.description);case 9:if("offer"!==t.description.type){e.next=13;break}return e.next=12,TM.setLocalDescription();case 12:uB.send({type:"video-answer",description:TM.localDescription,target:p});case 13:e.next=31;break;case 15:if(!t.answer){e.next=21;break}return e.next=18,TM.setRemoteDescription(t.answer);case 18:console.log(t.answer),e.next=31;break;case 21:if(!t.candidate||!TM.remoteDescription){e.next=31;break}return e.prev=22,e.next=25,TM.addIceCandidate(t.candidate);case 25:e.next=31;break;case 27:if(e.prev=27,e.t0=e.catch(22),h){e.next=31;break}throw e.t0;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(0),console.error(e.t1);case 36:case"end":return e.stop()}}),e,null,[[0,33],[22,27]])})));return function(t){return e.apply(this,arguments)}}()),e.next=20;break;case 19:throw new Error("selfVideo.current is null");case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error(e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,22]])}))),j.apply(this,arguments)}return(0,r.useEffect)((function(){}),[]),(0,r.useEffect)((function(){a&&v("".concat(a))}),[a]),(0,r.useEffect)((function(){n&&i&&t&&p&&(uB.emit("join-call",{who:t,myId:n,friendId:i,roomId:a}),uB.on("start-peering",(function(){!function(){j.apply(this,arguments)}()})))}),[t,n,i,p]),(0,ot.jsx)(JF,{children:(0,ot.jsxs)("div",{className:"call",children:[P?(0,ot.jsx)("div",{className:"flex-column-center full-container",style:{color:"white"},children:(0,ot.jsx)("h1",{children:"User left call"})}):(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("video",{id:"video",className:"video",muted:!0,autoPlay:!0,ref:l}),(0,ot.jsx)("video",{id:"friendVideo",className:"friendVideo",ref:f,autoPlay:!0})]}),(0,ot.jsxs)("div",{className:"call-options",children:[l.current&&(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("img",{className:"call-options-option",src:"".concat(rr,"/micro-").concat(C,".png"),onClick:function(){return function(e,t){e.getSenders().forEach((function(e){var n=e.track;"audio"==(null===n||void 0===n?void 0:n.kind)&&(n.enabled=!t)})),k(!t),I(t?"off":"on")}(TM,g)}}),(0,ot.jsx)("img",{className:"call-options-option",src:"".concat(rr,"/camera-").concat(A,".png"),onClick:function(){return function(e,t){e.getSenders().forEach((function(e){var n=e.track;"video"==(null===n||void 0===n?void 0:n.kind)&&(n.enabled=!t)})),x(!t),D(t?"off":"on")}(TM,w)}}),(0,ot.jsx)("img",{className:"call-options-option",src:"".concat(rr,"/friends.png"),onClick:function(){return function(e){e.getReceivers().forEach((function(e){e.track.enabled=!e.track.enabled}))}(TM)}})]}),(0,ot.jsx)("img",{src:"".concat(rr,"/leave-call.png"),className:"call-options-option",onClick:function(){window.close()}})]})]})})}},{path:"/messaging-only/:id",component:function(){var e=(0,r.useContext)(Jn).myFriends,t=(0,r.useState)(),n=(0,u.Z)(t,2),i=n[0],a=n[1],o=(0,r.useState)(window.innerWidth),s=(0,u.Z)(o,2),c=s[0],l=s[1],f=(0,r.useContext)(Xn).myProfile,h=c<600;return(0,r.useEffect)((function(){e&&(h||a(e[0]))}),[e,h]),(0,r.useEffect)((function(){window.addEventListener("resize",(function(){l(window.innerWidth)}))}),[]),(0,r.useEffect)((function(){l(window.innerWidth)}),[window.innerWidth]),(0,ot.jsx)(JF,{children:(0,ot.jsx)("div",{id:"messager",children:h?(0,ot.jsx)(yM,{setChoosenFriend:a,choosenFriend:i}):(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("nav",{className:"messager-nav",children:(0,ot.jsxs)("span",{children:[(0,ot.jsx)("img",{src:"".concat(rr,"/messaging-only.png")}),(0,ot.jsx)("img",{src:f.ProfileImage})]})}),(0,ot.jsx)("span",{id:"go-to-app",children:(0,ot.jsx)(eM,{appName:"FriendLink"})}),(0,ot.jsxs)("article",{className:"messager-content",children:[(0,ot.jsxs)("section",{className:"messager-friends",children:[(0,ot.jsx)("h2",{children:"Chats"}),(0,ot.jsx)(XF,{setChoosenFriend:a}),(0,ot.jsx)(gM,{friends:e,setChoosenFriend:a})]}),i&&(0,ot.jsx)(dM,{friend:i,fullScreen:!1,setChoosenFriend:a})]})]})})})}},{path:"/",component:GF},{path:"*",component:GF}],AM=[],DM=NM;function OM(){var e=xn(),t=(0,r.useContext)(nt).update;return(0,ot.jsx)("button",{onClick:function(){localStorage.removeItem(rt),localStorage.removeItem("email"),localStorage.removeItem("id"),localStorage.removeItem("profileImage"),localStorage.removeItem("username"),localStorage.removeItem("username"),t([]),e("/"),e(0)},style:{height:"fit-content",marginRight:"2rem"},children:"Logout"})}function RM(e){var t=e.profile,n=xn(),i=(0,r.useContext)(Xn).myProfile;return(0,ot.jsx)(ot.Fragment,{children:i.Email!=t.Email&&(0,ot.jsx)("div",{className:"data-option medium-font",onClick:function(){n("user-profile/".concat(t.Id)),document.getElementById("user-search-typeahead").value=""},children:(0,ot.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,ot.jsx)("img",{className:"data-option-part image",src:t.ProfileImage||"".concat(rr,"/noProfile.jpg")}),(0,ot.jsx)("span",{className:"data-option-part",children:t.Email})]})},t.Id)})}function PM(){function e(){return e=(0,s.Z)((0,o.Z)().mark((function e(t,n){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,lr({name:t},"search-users");case 3:r=e.sent,i=r.users.slice(0,5),n(i),e.next=9;break;case 8:n([]);case 9:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}return(0,ot.jsx)(YF,{listOfData:[],itemChildren:function(e){return(0,ot.jsx)(RM,{profile:e})},handleSearch:function(t,n){return e.apply(this,arguments)},bonusClassName:"navbar-typeahead"})}function LM(){var e=xn(),t=(0,r.useContext)(Xn).myProfile;return(0,ot.jsxs)("nav",{className:"navbar",children:[(0,ot.jsx)(eM,{appName:"FriendLink"}),(0,ot.jsx)(Yn,{isAuthorized:(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)(PM,{}),(0,ot.jsxs)("span",{style:{height:"80%",display:"flex",alignItems:"center",padding:"0 0.5rem",marginRight:"1rem"},children:[(0,ot.jsx)(OM,{}),(0,ot.jsx)("img",{className:"small-profile-image",src:t&&t.ProfileImage,onClick:function(){return e("/user-profile/".concat(t.Id))}})]})]}),notAuthorized:(0,ot.jsxs)("span",{children:[(0,ot.jsx)("button",{onClick:function(){return e("/login")},children:"Login"}),(0,ot.jsx)("button",{onClick:function(){return e("/register")},children:"Register"})]})})]})}function jM(){var e=xn(),t=(0,r.useContext)(Xn).myProfile,n=(0,r.useContext)(nr),i=(n.openedChats,n.updateOpenedChats),a=_n(),o=(0,r.useState)(window.innerWidth),s=(0,u.Z)(o,2),c=s[0],l=s[1];(0,r.useEffect)((function(){window.addEventListener("resize",(function(){l(window.innerWidth)}))}),[]),(0,r.useEffect)((function(){l(window.innerWidth)}),[window.innerWidth]);var f,h,d="/"==a.pathname&&c>600;return d?f={width:"20vw"}:c<600?(f={width:"10vw",backgroundColor:"white",boxShadow:"8px 0px 10px -12px rgba(0, 0, 0, 0.75)"},h={padding:"0.3rem 0.3rem"}):(f={width:"5vw",backgroundColor:"white",boxShadow:"8px 0px 10px -12px rgba(0, 0, 0, 0.75)"},h={padding:"0.3rem 0.3rem"}),(0,ot.jsx)("nav",{className:"bar bar-left",style:f,children:t&&(0,ot.jsxs)("ul",{children:[(0,ot.jsxs)("li",{style:h,onClick:function(){return e("/")},children:[(0,ot.jsx)("img",{src:"".concat(rr,"/homepage.png")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:"Home"})]}),(0,ot.jsxs)("li",{style:h,onClick:function(){return e("user-profile/".concat(t.Id))},children:[(0,ot.jsx)("img",{src:t.ProfileImage||"".concat(rr,"/noProfile.jpg")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:t.Email})]}),(0,ot.jsxs)("li",{style:h,onClick:function(){return e("/user-friends/".concat(t.Id))},children:[(0,ot.jsx)("img",{src:"".concat(rr,"/friends.png")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:"Friends"})]}),(0,ot.jsxs)("li",{style:h,onClick:function(){return e("/user-friend-requests/".concat(t.Id))},children:[(0,ot.jsx)("img",{src:"".concat(rr,"/goBackArrow.png")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:"Friend Requests"})]}),(0,ot.jsxs)("li",{style:h,onClick:function(){return e("/user-sent-friend-requests/".concat(t.Id))},children:[(0,ot.jsx)("img",{style:{rotate:"180deg"},src:"".concat(rr,"/goBackArrow.png")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:"Sent Friend Requests"})]}),(0,ot.jsxs)("li",{style:h,onClick:function(){i([]),e("/messaging-only/".concat(t.Id))},children:[(0,ot.jsx)("img",{src:"".concat(rr,"/messaging-only.png")}),d&&(0,ot.jsx)("span",{className:"medium-font",children:"Messaging only"})]})]})})}function FM(e){var t=e.friend,n=(0,r.useContext)(nr),i=n.openedChats,a=n.updateOpenedChats,c=(0,r.useContext)(Xn).myProfile,l=(0,r.useState)([]),f=(0,u.Z)(l,2),h=f[0],d=f[1],p=(0,r.useState)(""),v=(0,u.Z)(p,2),y=v[0],m=v[1],g=(0,r.useState)(""),k=(0,u.Z)(g,2),b=k[0],_=k[1],w=(0,r.useState)(),x=(0,u.Z)(w,2),S=x[0],E=x[1],C=(0,r.useState)(!1),I=(0,u.Z)(C,2),T=I[0],N=I[1],A=(0,r.useState)(!1),D=(0,u.Z)(A,2),O=D[0],R=D[1],P=(0,r.useState)(!1),L=(0,u.Z)(P,2),j=L[0],F=L[1],M=(0,r.useState)([]),U=(0,u.Z)(M,2),B=U[0],V=U[1],z=t.ProfileImage||"".concat(rr,"/noProfile.jpg"),q=10,Z=(0,r.useRef)(null),W=(0,r.useRef)(null),H=(0,r.useRef)(null),K=(0,r.useRef)(null);(0,r.useEffect)((function(){W.current&&W.current.scrollIntoView()}),[W,O]);var G=oO(Z,"400px");function Q(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.Z)((0,o.Z)().mark((function e(){var n,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=2;break}return e.abrupt("return");case 2:return n=(null===h||void 0===h?void 0:h.length)+q,e.next=5,lr({userId:c.Id,friendId:t.Id,numberOfMessages:n},"get-chat-messages");case 5:(r=e.sent)&&h&&r.length==h.length&&F(!0),R(!0),i=[],r.forEach((function(e,t){(null===h||void 0===h?void 0:h.length)==t+1&&i.push("empty"),i.push(e)})),d(i.reverse());case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return $=(0,s.Z)((0,o.Z)().mark((function e(){var n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={SenderId:c.Id,ReceiverId:t.Id,TextContent:y,MediaFiles:[],VoiceFile:"",Date:Date.now()},r=[],B.length>0&&(r=B.map(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,u.Z)(t,2),r=n[0],n[1],i=ZD.child("/messageImages/".concat(null===r||void 0===r?void 0:r.name,"+").concat(KD())),e.next=4,i.put(r);case 4:return e.next=6,i.getDownloadURL();case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.next=5,Promise.all(r);case 5:if(n.MediaFiles=e.sent,!S){e.next=14;break}return i=ZD.child("/messageVoices/".concat(KD())),e.next=10,i.put(S);case 10:return e.next=12,i.getDownloadURL();case 12:a=e.sent,n.VoiceFile=a;case 14:uB.emit("send-message",n),setTimeout((function(){V([]),E(void 0),_(""),N(!0),m(""),nM(H),W.current&&W.current.scrollIntoView()}),500);case 16:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}(0,r.useEffect)((function(){G&&Q()}),[G]),(0,r.useEffect)((function(){c.Id&&W&&t.Id&&(Q(),uB.on("receive-message/".concat(c.Id,"/").concat(t.Id),(function(e){h.includes(e)||(d((function(t){return[].concat(ft(t),[e])})),setTimeout((function(){W.current&&W.current.scrollIntoView()}),400))})))}),[c,W,t.Id]),(0,r.useEffect)((function(){if(t.Id){var e=document.getElementById("scrollable-span");e&&e.scrollIntoView()}}),[h,t.Id]);var X=""!=y||B.length>0||""!=b?"80%":"30%",J=function(e){var t=new FileReader;t.onload=function(){var n=t.result;V((function(t){return[].concat(ft(t),[[e,n]])}))},e&&t.readAsDataURL(e)};return(0,ot.jsxs)("section",{className:"chat",children:[(0,ot.jsxs)("div",{className:"chat-header",children:[(0,ot.jsxs)("span",{className:"chat-header-userProfile",children:[(0,ot.jsx)("img",{className:"chat-header-userProfile-image",src:z}),t.Email]}),(0,ot.jsx)("img",{className:"chat-header-call",src:"".concat(rr,"/video-call.png"),onClick:function(){var e=KD();uB.emit("create-join-room",{myId:c.Id,friendId:t.Id,roomId:e}),rM(c,t,e,"caller")}}),(0,ot.jsx)("img",{className:"chat-header-close",src:"".concat(rr,"/redX.png"),onClick:function(){var e=i.filter((function(e){return e.Id!=t.Id}));a(e)}})]}),(0,ot.jsxs)("div",{id:"chat-body/".concat(t.Id),className:"chat-body",children:[(0,ot.jsxs)("div",{className:"chat-body-start",children:[(0,ot.jsx)("img",{src:z}),(0,ot.jsx)("h5",{children:t.Email})]}),(0,ot.jsxs)("div",{className:"chat-body-messages",children:[(0,ot.jsx)("span",{ref:Z}),(0,ot.jsx)(sM,{messages:h}),(0,ot.jsx)("span",{ref:W})]})]}),(0,ot.jsxs)("div",{className:"chat-footer",children:[""==y&&!S&&B.length<=0&&(0,ot.jsx)("div",{style:{width:"3rem",height:"3rem",padding:"0.2rem"},children:(0,ot.jsx)(YD,{handleFileChange:J})}),(0,ot.jsx)(hM,{setVoiceMessage:E,setAudioURL:_,voiceMessage:S,removedVoiceMes:T,setRemovedVoiceMes:N}),(0,ot.jsx)("div",{className:"chat-footer-container",style:{width:X},children:(0,ot.jsxs)("div",{ref:K,className:"chat-footer-input",children:[(0,ot.jsx)("div",{ref:H,style:{height:"100%",width:"100%",outline:"none"},contentEditable:!0,onInput:function(e){return m(e.target.innerText)}}),B&&B.length>0&&(0,ot.jsxs)("span",{className:"chat-footer-input-images-container",children:[(0,ot.jsx)("div",{style:{width:"3rem",height:"3rem"},children:(0,ot.jsx)(YD,{handleFileChange:J})}),B.map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return(0,ot.jsxs)("div",{className:"chat-footer-input-image",children:[(0,ot.jsx)("img",{style:{height:"100%",width:"100%",outline:"none"},src:r}),(0,ot.jsx)("img",{className:"erase-image",src:"".concat(rr,"/redX.png"),onClick:function(){return function(e){var t=B.filter((function(t){var n=(0,u.Z)(t,2),r=n[0];return n[1],r.name!=e}));V(t)}(n.name)}})]})}))]}),S&&b&&(0,ot.jsx)("audio",{style:{width:"100%"},src:b,controls:!0})]})}),(0,ot.jsx)("img",{className:"chat-footer-send",src:y||0!=B.length||S?"".concat(rr,"/sendBtn.png"):"".concat(rr,"/like.png"),onClick:function(){return $.apply(this,arguments)}})]})]})}function MM(e){var t=e.openedChats;return(0,ot.jsx)("div",{className:"listOfOpenedChats",children:t&&t.map((function(e){return(0,ot.jsx)(FM,{friend:e},e.Id)}))})}var UM=Object.create(null);UM.open="0",UM.close="1",UM.ping="2",UM.pong="3",UM.message="4",UM.upgrade="5",UM.noop="6";var BM=Object.create(null);Object.keys(UM).forEach((function(e){BM[UM[e]]=e}));for(var VM={type:"error",data:"parser error"},zM="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),qM="function"===typeof ArrayBuffer,ZM=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)},WM=function(e,t,n){var r,i=e.type,a=e.data;return zM&&a instanceof Blob?t?n(a):ZM(a,n):qM&&(a instanceof ArrayBuffer||(r=a,"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?t?n(a):ZM(new Blob([a]),n):n(UM[i]+(a||""))},HM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",KM="undefined"===typeof Uint8Array?[]:new Uint8Array(256),GM=0;GM<64;GM++)KM[HM.charCodeAt(GM)]=GM;var QM="function"===typeof ArrayBuffer,YM=function(e,t){if(QM){var n=function(e){var t,n,r,i,a,o=.75*e.length,s=e.length,u=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var c=new ArrayBuffer(o),l=new Uint8Array(c);for(t=0;t<s;t+=4)n=KM[e.charCodeAt(t)],r=KM[e.charCodeAt(t+1)],i=KM[e.charCodeAt(t+2)],a=KM[e.charCodeAt(t+3)],l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|i>>2,l[u++]=(3&i)<<6|63&a;return c}(e);return $M(n,t)}return{base64:!0,data:e}},$M=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},XM=function(e,t){if("string"!==typeof e)return{type:"message",data:$M(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:YM(e.substring(1),t)}:BM[n]?e.length>1?{type:BM[n],data:e.substring(1)}:{type:BM[n]}:VM},JM=String.fromCharCode(30);function eU(e){if(e)return function(e){for(var t in eU.prototype)e[t]=eU.prototype[t];return e}(e)}eU.prototype.on=eU.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},eU.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},eU.prototype.off=eU.prototype.removeListener=eU.prototype.removeAllListeners=eU.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},eU.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},eU.prototype.emitReserved=eU.prototype.emit,eU.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},eU.prototype.hasListeners=function(e){return!!this.listeners(e).length};var tU="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function nU(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})}var rU=tU.setTimeout,iU=tU.clearTimeout;function aU(e,t){t.useNativeTimers?(e.setTimeoutFn=rU.bind(tU),e.clearTimeoutFn=iU.bind(tU)):(e.setTimeoutFn=tU.setTimeout.bind(tU),e.clearTimeoutFn=tU.clearTimeout.bind(tU))}var oU,sU=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this,e)).description=r,a.context=i,a.type="TransportError",a}return vt(n)}(St(Error)),uU=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).writable=!1,aU(_t(r),e),r.opts=e,r.query=e.query,r.socket=e.socket,r}return vt(n,[{key:"onError",value:function(e,t,r){return sp(gt(n.prototype),"emitReserved",this).call(this,"error",new sU(e,t,r)),this}},{key:"open",value:function(){return this.readyState="opening",this.doOpen(),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,sp(gt(n.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=XM(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){sp(gt(n.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",sp(gt(n.prototype),"emitReserved",this).call(this,"close",e)}},{key:"pause",value:function(e){}}]),n}(eU),cU="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),lU=64,fU={},hU=0,dU=0;function pU(e){var t="";do{t=cU[e%lU]+t,e=Math.floor(e/lU)}while(e>0);return t}function vU(){var e=pU(+new Date);return e!==oU?(hU=0,oU=e):e+"."+pU(hU++)}for(;dU<lU;dU++)fU[cU[dU]]=dU;function yU(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}var mU=!1;try{mU="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(fB){}var gU=mU;function kU(e){var t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||gU))return new XMLHttpRequest}catch(n){}if(!t)try{return new(tU[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function bU(){}var _U=null!=new kU({xdomain:!1}).responseType,wU=function(e){mt(n,e);var t=wt(n);function n(e){var r;if(ht(this,n),(r=t.call(this,e)).polling=!1,"undefined"!==typeof location){var i="https:"===location.protocol,a=location.port;a||(a=i?"443":"80"),r.xd="undefined"!==typeof location&&e.hostname!==location.hostname||a!==e.port,r.xs=e.secure!==i}var o=e&&e.forceBase64;return r.supportsBinary=_U&&!o,r}return vt(n,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",(function(){--r||n()}))),this.writable||(r++,this.once("drain",(function(){--r||n()})))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split(JM),r=[],i=0;i<n.length;i++){var a=XM(n[i],t);if(r.push(a),"error"===a.type)break}return r})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var n=e.length,r=new Array(n),i=0;e.forEach((function(e,a){WM(e,!1,(function(e){r[a]=e,++i===n&&t(r.join(JM))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emitReserved("drain")}))}))}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=vU()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var r=yU(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new xU(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(function(e,t){n.onError("xhr post error",e,t)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,n){e.onError("xhr poll error",t,n)})),this.pollXhr=t}}]),n}(uU),xU=function(e){mt(n,e);var t=wt(n);function n(e,r){var i;return ht(this,n),aU(_t(i=t.call(this)),r),i.opts=r,i.method=r.method||"GET",i.uri=e,i.async=!1!==r.async,i.data=void 0!==r.data?r.data:null,i.create(),i}return vt(n,[{key:"create",value:function(){var e=this,t=nU(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var r=this.xhr=new kU(t);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var i in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}catch(a){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{r.setRequestHeader("Accept","*/*")}catch(a){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?e.onLoad():e.setTimeoutFn((function(){e.onError("number"===typeof r.status?r.status:0)}),0))},r.send(this.data)}catch(a){return void this.setTimeoutFn((function(){e.onError(a)}),0)}"undefined"!==typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=bU,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),n}(eU);if(xU.requestsCount=0,xU.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",SU);else if("function"===typeof addEventListener){addEventListener("onpagehide"in tU?"pagehide":"unload",SU,!1)}function SU(){for(var e in xU.requests)xU.requests.hasOwnProperty(e)&&xU.requests[e].abort()}var EU="function"===typeof Promise&&"function"===typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},CU=tU.WebSocket||tU.MozWebSocket,IU="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),TU=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this,e)).supportsBinary=!e.forceBase64,r}return vt(n,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=IU?{}:nU(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=IU?new CU(e,t,n):t?new CU(e,t):new CU(e)}catch(fB){return this.emitReserved("error",fB)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(){var n=e[r],i=r===e.length-1;WM(n,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(n){}i&&EU((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},r=0;r<e.length;r++)n()}},{key:"doClose",value:function(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=vU()),this.supportsBinary||(e.b64=1);var r=yU(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"check",value:function(){return!!CU}}]),n}(uU),NU={websocket:TU,polling:wU},AU=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,DU=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function OU(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=AU.exec(e||""),a={},o=14;o--;)a[DU[o]]=i[o]||"";return-1!=n&&-1!=r&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,a.path),a.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,a.query),a}var RU=function(e){mt(n,e);var t=wt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ht(this,n),(r=t.call(this)).writeBuffer=[],e&&"object"===typeof e&&(i=e,e=null),e?(e=OU(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=OU(i.host).host),aU(_t(r),i),r.secure=null!=i.secure?i.secure:"undefined"!==typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=r.secure?"443":"80"),r.hostname=i.hostname||("undefined"!==typeof location?location.hostname:"localhost"),r.port=i.port||("undefined"!==typeof location&&location.port?location.port:r.secure?"443":"80"),r.transports=i.transports||["polling","websocket"],r.writeBuffer=[],r.prevBufferLen=0,r.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),r.opts.path=r.opts.path.replace(/\/$/,"")+(r.opts.addTrailingSlash?"/":""),"string"===typeof r.opts.query&&(r.opts.query=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}(r.opts.query)),r.id=null,r.upgrades=null,r.pingInterval=null,r.pingTimeout=null,r.pingTimeoutTimer=null,"function"===typeof addEventListener&&(r.opts.closeOnBeforeunload&&(r.beforeunloadEventListener=function(){r.transport&&(r.transport.removeAllListeners(),r.transport.close())},addEventListener("beforeunload",r.beforeunloadEventListener,!1)),"localhost"!==r.hostname&&(r.offlineEventListener=function(){r.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",r.offlineEventListener,!1))),r.open(),r}return vt(n,[{key:"createTransport",value:function(e){var t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new NU[e](n)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(r){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(e){return t.onClose("transport close",e)}))}},{key:"probe",value:function(e){var t=this,r=this.createTransport(e),i=!1;n.priorWebsocketSuccess=!1;var a=function(){i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!i)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess="websocket"===r.name,t.transport.pause((function(){i||"closed"!==t.readyState&&(f(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emitReserved("upgrade",r),r=null,t.upgrading=!1,t.flush())}))}else{var a=new Error("probe error");a.transport=r.name,t.emitReserved("upgradeError",a)}})))};function o(){i||(i=!0,f(),r.close(),r=null)}var s=function(e){var n=new Error("probe error: "+e);n.transport=r.name,o(),t.emitReserved("upgradeError",n)};function u(){s("transport closed")}function c(){s("socket closed")}function l(e){r&&e.name!==r.name&&o()}var f=function(){r.removeListener("open",a),r.removeListener("error",s),r.removeListener("close",u),t.off("close",c),t.off("upgrading",l)};r.once("open",a),r.once("error",s),r.once("close",u),this.once("close",c),this.once("upgrading",l),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(t+="string"===typeof(e=r)?function(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},n=function n(){e.off("upgrade",n),e.off("upgradeError",n),t()},r=function(){e.once("upgrade",n),e.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?r():t()})):this.upgrading?r():t()),this}},{key:"onError",value:function(e){n.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}]),n}(eU);RU.protocol=4;RU.protocol;var PU="function"===typeof ArrayBuffer,LU=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer},jU=Object.prototype.toString,FU="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===jU.call(Blob),MU="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===jU.call(File);function UU(e){return PU&&(e instanceof ArrayBuffer||LU(e))||FU&&e instanceof Blob||MU&&e instanceof File}function BU(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(BU(e[n]))return!0;return!1}if(UU(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return BU(e.toJSON(),!0);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&BU(e[i]))return!0;return!1}function VU(e){var t=[],n=e.data,r=e;return r.data=zU(n,t),r.attachments=t.length,{packet:r,buffers:t}}function zU(e,t){if(!e)return e;if(UU(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=zU(e[i],t);return r}if("object"===typeof e&&!(e instanceof Date)){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(a[o]=zU(e[o],t));return a}return e}function qU(e,t){return e.data=ZU(e.data,t),delete e.attachments,e}function ZU(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=ZU(e[n],t);else if("object"===typeof e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=ZU(e[r],t));return e}var WU,HU=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],KU=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(WU||(WU={}));var GU=function(){function e(t){ht(this,e),this.replacer=t}return vt(e,[{key:"encode",value:function(e){return e.type!==WU.EVENT&&e.type!==WU.ACK||!BU(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===WU.EVENT?WU.BINARY_EVENT:WU.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==WU.BINARY_EVENT&&e.type!==WU.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=VU(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),e}();function QU(e){return"[object Object]"===Object.prototype.toString.call(e)}var YU=function(e){mt(n,e);var t=wt(n);function n(e){var r;return ht(this,n),(r=t.call(this)).reviver=e,r}return vt(n,[{key:"add",value:function(e){var t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var r=(t=this.decodeString(e)).type===WU.BINARY_EVENT;r||t.type===WU.BINARY_ACK?(t.type=r?WU.EVENT:WU.ACK,this.reconstructor=new $U(t),0===t.attachments&&sp(gt(n.prototype),"emitReserved",this).call(this,"decoded",t)):sp(gt(n.prototype),"emitReserved",this).call(this,"decoded",t)}else{if(!UU(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,sp(gt(n.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===WU[r.type])throw new Error("unknown packet type "+r.type);if(r.type===WU.BINARY_EVENT||r.type===WU.BINARY_ACK){for(var i=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var a=e.substring(i,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(a)}if("/"===e.charAt(t+1)){for(var o=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(o,t)}else r.nsp="/";var s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(var u=t+1;++t;){var c=e.charAt(t);if(null==c||Number(c)!=c){--t;break}if(t===e.length)break}r.id=Number(e.substring(u,t+1))}if(e.charAt(++t)){var l=this.tryParse(e.substr(t));if(!n.isPayloadValid(r.type,l))throw new Error("invalid payload");r.data=l}return r}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}},{key:"destroy",value:function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case WU.CONNECT:return QU(t);case WU.DISCONNECT:return void 0===t;case WU.CONNECT_ERROR:return"string"===typeof t||QU(t);case WU.EVENT:case WU.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===HU.indexOf(t[0]));case WU.ACK:case WU.BINARY_ACK:return Array.isArray(t)}}}]),n}(eU),$U=function(){function e(t){ht(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return vt(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=qU(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}();function XU(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var JU=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),eB=function(e){mt(n,e);var t=wt(n);function n(e,r,i){var a;return ht(this,n),(a=t.call(this)).connected=!1,a.recovered=!1,a.receiveBuffer=[],a.sendBuffer=[],a._queue=[],a._queueSeq=0,a.ids=0,a.acks={},a.flags={},a.io=e,a.nsp=r,i&&i.auth&&(a.auth=i.auth),a._opts=Object.assign({},i),a.io._autoConnect&&a.open(),a}return vt(n,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[XU(e,"open",this.onopen.bind(this)),XU(e,"packet",this.onpacket.bind(this)),XU(e,"error",this.onerror.bind(this)),XU(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(JU.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;var i={type:WU.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof n[n.length-1]){var a=this.ids++,o=n.pop();this._registerAckCallback(a,o),i.id=a}var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var n,r=this,i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0!==i){var a=this.io.setTimeoutFn((function(){delete r.acks[e];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===e&&r.sendBuffer.splice(n,1);t.call(r,new Error("operation has timed out"))}),i);this.acks[e]=function(){r.io.clearTimeoutFn(a);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(r,[null].concat(n))}}else this.acks[e]=t}},{key:"emitWithAck",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((function(n,i){r.push((function(e,t){return a?e?i(e):n(t):n(e)})),t.emit.apply(t,[e].concat(r))}))}},{key:"_addToQueue",value:function(e){var t,n=this;"function"===typeof e[e.length-1]&&(t=e.pop());var r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(r===n._queue[0]){if(null!==e)r.tryCount>n._opts.retries&&(n._queue.shift(),t&&t(e));else if(n._queue.shift(),t){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];t.apply(void 0,[null].concat(a))}return r.pending=!1,n._drainQueue()}})),this._queue.push(r),this._drainQueue()}},{key:"_drainQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this._queue.length){var t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}},{key:"_sendConnectPacket",value:function(e){this.packet({type:WU.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case WU.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case WU.EVENT:case WU.BINARY_EVENT:this.onevent(e);break;case WU.ACK:case WU.BINARY_ACK:this.onack(e);break;case WU.DISCONNECT:this.ondisconnect();break;case WU.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,r=Tt(this._anyListeners.slice());try{for(r.s();!(t=r.n()).done;){t.value.apply(this,e)}}catch(fB){r.e(fB)}finally{r.f()}}sp(gt(n.prototype),"emit",this).apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t.packet({type:WU.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:WU.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=Tt(this._anyOutgoingListeners.slice());try{for(n.s();!(t=n.n()).done;){t.value.apply(this,e.data)}}catch(fB){n.e(fB)}finally{n.f()}}}}]),n}(eU);function tB(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}tB.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},tB.prototype.reset=function(){this.attempts=0},tB.prototype.setMin=function(e){this.ms=e},tB.prototype.setMax=function(e){this.max=e},tB.prototype.setJitter=function(e){this.jitter=e};var nB,rB=function(e){mt(r,e);var n=wt(r);function r(e,i){var a,o;ht(this,r),(a=n.call(this)).nsps={},a.subs=[],e&&"object"===typeof e&&(i=e,e=void 0),(i=i||{}).path=i.path||"/socket.io",a.opts=i,aU(_t(a),i),a.reconnection(!1!==i.reconnection),a.reconnectionAttempts(i.reconnectionAttempts||1/0),a.reconnectionDelay(i.reconnectionDelay||1e3),a.reconnectionDelayMax(i.reconnectionDelayMax||5e3),a.randomizationFactor(null!==(o=i.randomizationFactor)&&void 0!==o?o:.5),a.backoff=new tB({min:a.reconnectionDelay(),max:a.reconnectionDelayMax(),jitter:a.randomizationFactor()}),a.timeout(null==i.timeout?2e4:i.timeout),a._readyState="closed",a.uri=e;var s=i.parser||t;return a.encoder=new s.Encoder,a.decoder=new s.Decoder,a._autoConnect=!1!==i.autoConnect,a._autoConnect&&a.open(),a}return vt(r,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new RU(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=XU(n,"open",(function(){r.onopen(),e&&e()})),a=XU(n,"error",(function(n){r.cleanup(),r._readyState="closed",t.emitReserved("error",n),e?e(n):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var o=this._timeout;0===o&&i();var s=this.setTimeoutFn((function(){i(),n.close(),n.emit("error",new Error("timeout"))}),o);this.opts.autoUnref&&s.unref(),this.subs.push((function(){clearTimeout(s)}))}return this.subs.push(i),this.subs.push(a),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(XU(e,"ping",this.onping.bind(this)),XU(e,"data",this.ondata.bind(this)),XU(e,"error",this.onerror.bind(this)),XU(e,"close",this.onclose.bind(this)),XU(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}},{key:"ondecoded",value:function(e){var t=this;EU((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new eB(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",n)):t.onreconnect()})))}),n);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),r}(eU),iB={};function aB(e,t){"object"===typeof e&&(t=e,e=void 0);var n,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=OU(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),i=r.source,a=r.id,o=r.path,s=iB[a]&&o in iB[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?n=new rB(i,t):(iB[a]||(iB[a]=new rB(i,t)),n=iB[a]),r.query&&!t.query&&(t.query=r.queryKey),n.socket(r.path,t)}Object.assign(aB,{Manager:rB,Socket:eB,io:aB,connect:aB});var oB=tt.styled(nB||(nB=or(["\n  width: 20rem;\n  display: flex;\n  align-items: center;\n  background-color: #ffffff;\n  flex-direction: column;\n  padding:1rem;\n  text-align:center;\n  gap:1rem;\n"])));function sB(e){var t=e.friend,n=e.onSubmit,i=e.setCall,a=e.onClose,o=(0,r.useState)(!0),s=(0,u.Z)(o,2),c=s[0],l=s[1];function f(){l(!c),i((0,ot.jsx)(ot.Fragment,{}))}return(0,ot.jsxs)(oB,{isOpen:c,onBackgroundClick:f,onEscapeKeydown:f,children:[t.Email," is calling...",(0,ot.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,ot.jsx)("img",{className:"call-image",src:"".concat(rr,"/accept-call.png"),onClick:function(){f(),n()}}),(0,ot.jsx)("img",{className:"call-image",src:"".concat(rr,"/leave-call.png"),onClick:function(){a(),f()}})]})]})}var uB=aB("https://cacarrot-server.herokuapp.com/");var cB=function(){var e=(0,r.useState)([]),t=(0,u.Z)(e,2),n=t[0],i=t[1],a=(0,r.useState)(),c=(0,u.Z)(a,2),l=c[0],f=c[1],h=(0,r.useState)(),d=(0,u.Z)(h,2),p=d[0],v=d[1],y=(0,r.useState)(),m=(0,u.Z)(y,2),g=m[0],k=m[1],b=(0,r.useState)(),_=(0,u.Z)(b,2),w=_[0],x=_[1],S=(0,r.useState)([]),E=(0,u.Z)(S,2),C=E[0],I=E[1],T=(0,r.useState)((0,ot.jsx)(ot.Fragment,{})),N=(0,u.Z)(T,2),A=N[0],D=N[1],O=(0,r.useState)(!1),R=(0,u.Z)(O,2),P=R[0],L=R[1],j=(0,r.useState)(!1),F=(0,u.Z)(j,2),M=F[0],U=F[1];function B(){return(B=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:l.Id},"get-friends");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:v(t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:l.Id},"get-friend-requests");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:k(t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({userId:l.Id},"get-sent-friend-requests");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:x(t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.useEffect)((function(){f(WF()),i(at())}),[]),(0,r.useEffect)((function(){f(WF()),i(at()),U(!0),L(navigator.onLine)}),[localStorage]),(0,r.useEffect)((function(){l&&l.Id&&(uB.on("calling/".concat(l.Id),function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr({name:t.userId},"get-user");case 2:n=e.sent,D((0,ot.jsx)(sB,{onSubmit:function(){return rM(l,n,t.roomId,"receiver")},friend:n,setCall:D,onClose:function(){uB.emit("leave-call",{friendId:n.Id})}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){B.apply(this,arguments)}(),function(){V.apply(this,arguments)}(),function(){z.apply(this,arguments)}())}),[l]),(0,ot.jsx)(Hn,{children:(0,ot.jsx)(nt.Provider,{value:{claims:n,update:i},children:(0,ot.jsx)(Xn.Provider,{value:{myProfile:l,updateProfile:f},children:(0,ot.jsx)(Jn.Provider,{value:{myFriends:p,updateFriends:v},children:(0,ot.jsx)(er.Provider,{value:{myFriendRequests:g,updateFriendRequests:k},children:(0,ot.jsx)(tr.Provider,{value:{mySentRequests:w,updateSentFriendRequests:x},children:(0,ot.jsx)(nr.Provider,{value:{openedChats:C,updateOpenedChats:I},children:(0,ot.jsx)(Xe,{children:(0,ot.jsx)("div",{className:"App",children:P?(0,ot.jsxs)(ot.Fragment,{children:[(0,ot.jsx)("div",{className:"navbar-placeholder"}),(0,ot.jsx)(LM,{}),(0,ot.jsx)(Yn,{isAuthorized:(0,ot.jsx)(jM,{})}),(0,ot.jsx)(MM,{openedChats:C}),A,(0,ot.jsx)("section",{className:"landing-page",children:(0,ot.jsxs)(zn,{children:[DM.map((function(e){return(0,ot.jsx)(Bn,{path:e.path,Component:e.component},e.path)})),M&&AM.map((function(e){return(0,ot.jsx)(Bn,{element:(0,ot.jsx)(Qn,{isAuthenticated:n.length>0}),children:(0,ot.jsx)(Bn,{Component:e.component,path:e.path})},e.path)}))]})})]}):(0,ot.jsx)(st,{})})})})})})})})})})},lB=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))};a.createRoot(document.getElementById("root")).render((0,ot.jsx)(cB,{})),lB()}()}();
//# sourceMappingURL=main.b51c800d.js.map